<odoo>
  <data>

<!--      CRM tasks Tree view-->

    <record id="crm_tasks_tree_view" model="ir.ui.view">
       <field name="name">CRM Tasks Tree</field>
       <field name="model">mail.activity</field>
       <field name="arch" type="xml">
           <tree string="Activity">
               <field name="date_deadline" string="Date"/>
               <field name="activity_type_id"/>
               <field name="res_name" string="Name"/>
               <field name="summary" string="Subject"/>
<!--               <field name="names" string="Account"/>-->
               <field name="note"/>
               <field name="feedback"/>
               <field name="user_id" string="Business Development"/>
               <field name="recommended_activity_type_id"/>
               <field name="previous_activity_type_id"/>
               <field name="calendar_event_id"/>
               <field name="state"/>
           </tree>
       </field>
    </record>

<!--      CRM Tasks Form view-->

    <record id="mail_activity_view_form_popup" model="ir.ui.view">
       <field name="name">mail.activity.view.form.popup</field>
       <field name="model">mail.activity</field>
       <field name="inherit_id" ref="mail.mail_activity_view_form_popup"/>
       <field name="priority">20</field>
       <field name="arch" type="xml">
            <xpath expr="//form" position="replace">
                <form string="Log an Activity" create="false">
                    <sheet string="Activity">
                        <group>
                            <field name="activity_category" />
                            <field name="res_model"/>
                            <field name="res_model_id"/>
                            <field name="res_id" invisible="1"/>
                            <field name="force_next" invisible="1"/>
                            <field name="previous_activity_type_id"/>
                            <field name="has_recommended_activities"/>
                        </group>
                        <group attrs="{'invisible': [('has_recommended_activities','=',False)]}">
                            <div class="o_row">
                                <strong>Recommended Activities</strong>
                                    <field name="recommended_activity_type_id" widget="selection_badge"
                                        domain="[('previous_type_ids', '=', previous_activity_type_id)]"
                                        nolabel="1"/>
                            </div>
                        </group>
                        <group>
                            <field name="names" widget="selection"/>
                            <group>
                                <field name="activity_type_id" required="1" options="{'no_create': True, 'no_open': True}"/>
                                <field name="summary" placeholder="e.g. Discuss proposal"/>
                            </group>
                            <group>
                                <field name="date_deadline"/>
                                <field name="user_id"/>
                            </group>
                        </group>
                        <field name="note" placeholder="Log a note..."/>
                        <footer>
                            <button string="Open Calendar" name="action_create_calendar_event"
                                type="object" class="btn-primary"/>
                            <button string="Schedule" name="action_close_dialog"
                                type="object" class="btn-secondary"/>
                            <button attrs="{'invisible': [('force_next', '=', True)]}" string="Mark as Done" name="action_done"
                                type="object" class="btn-secondary"
                                context="{'mail_activity_quick_update': True}"/>
                            <button attrs="{'invisible': [('force_next', '=', True)]}" string="Done &amp; Schedule Next" name="action_done_schedule_next"
                                type="object" class="btn-secondary"
                                context="{'mail_activity_quick_update': True}"/>
                            <button attrs="{'invisible': [('force_next', '=', False)]}" string="Done &amp; Launch Next" name="action_done_schedule_next"
                                type="object" class="btn-secondary"
                                context="{'mail_activity_quick_update': True}"/>
                            <button string="Discard" class="btn-secondary" special="cancel" />
                        </footer>
                    </sheet>
                </form>
            </xpath>
       </field>
    </record>

    <!-- actions opening views on models -->

    <record id="crm_tasks.action_window" model="ir.actions.act_window">
        	<field name="name">My Tasks</field>
        	<field name="res_model">mail.activity</field>
        	<field name="view_type">form</field>
        	<field name="view_mode">tree,form</field>
            <field name="context"> {'search_default_activities_my':1,'group_by': 'date_deadline'}</field>
            <field name="domain">[('res_model','in',['crm.lead'])]</field>
    </record>

    <!--Sub-menu -->

    <menuitem id="sale_order_menu_crm_tasks"
        name="My Tasks"
        action="crm_tasks.action_window"
        parent="crm.crm_menu_sales"
        sequence="5"/>

  </data>
</odoo>