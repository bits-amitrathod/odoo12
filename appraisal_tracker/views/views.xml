<odoo>
    <data>

        <record model="ir.ui.view" id="appraisal_tracker.list">
            <field name="name">purchase.order.appraisal.tracker.tree.view</field>
            <field name="model">purchase.order</field>
            <field name="priority">21</field>
            <field name="arch" type="xml">

                <tree create="false" delete="false">
                    <field name="appraisal_no" attrs="{'invisible':[('state', 'not in', ('done','purchase','cancel','ven_draft','ven_sent'))]}"/>
                    <field name="status" invisible="1"/>
                    <field name="state" invisible="1"/>
                    <field name="acq_user_id" string='Acq Manager'
                           attrs="{'invisible':[('status', 'not in', ('done','purchase','cancel','ven_draft','ven_sent'))]}"/>
                    <field name="partner_id" attrs="{'invisible':[('status', 'not in', ('done','purchase','cancel' ,'ven_draft','ven_sent'))]}"
                           string="Facility"/>
                    <field name="vendor_cust_id_app" attrs="{'invisible':[('status', 'not in', ('done','purchase','cancel' ,'ven_draft','ven_sent'))]}"
                          />

                    <field name="cust_type_appraisal" attrs="{'invisible':[('status', 'not in', ('done','purchase','cancel','ven_draft','ven_sent'))]}"/>
                    <field name="name" attrs="{'invisible':[('status', 'not in', ('done','purchase','cancel','ven_draft','ven_sent'))]}"
                           string="PO#"/>
                    <field name="payment_term_id" attrs="{'invisible':[('status', 'not in', ('done','purchase','cancel','ven_draft','ven_sent'))]}"
                          />
                       <field name="amount_total" attrs="{'invisible':[('state', 'not in', ('done','purchase','cancel','ven_draft','ven_sent'))]}"
                           widget="monetary" string="Total Offer"/>
                    <field name="rt_price_total_amt" attrs="{'invisible':[('state', 'not in', ('done','purchase','cancel','ven_draft','ven_sent'))]}"
                           widget="monetary" string="Total Retail"/>
                    <field name="billed_offer_total" attrs="{'invisible':[('state', 'not in', ('done','purchase','cancel','ven_draft','ven_sent'))]}" string="Billed Total Offer" />
                    <field name="final_billed_offer_total" attrs="{'invisible':[('state', 'not in', ('done','purchase','cancel','ven_draft','ven_sent'))]}" string="Final Billed Total Offer" />
                    <field name="billed_retail_total" attrs="{'invisible':[('state', 'not in', ('done','purchase','cancel','ven_draft','ven_sent'))]}"  string="Billed Total Retail"/>
                    <field name="final_billed_retail_total" attrs="{'invisible':[('state', 'not in', ('done','purchase','cancel','ven_draft','ven_sent'))]}"  string="Final Billed Total Retail"/>

                    <field name="create_date" attrs="{'invisible':[('status', 'not in', ('done','purchase','cancel','ven_draft','ven_sent'))]}"/>
                    <field name="shipping_label_issued"
                           attrs="{'invisible':[('status', 'not in', ('done','purchase','cancel','ven_draft','ven_sent'))]}"/>
                    <field name="shipping_date" attrs="{'invisible':[('status', 'not in', ('done','purchase','cancel','ven_draft','ven_sent'))]}"/>
                    <field name="delivered_date" attrs="{'invisible':[('status', 'not in', ('done','purchase','cancel','ven_draft','ven_sent'))]}"/>
                     <field name="arrival_date_grp" attrs="{'invisible':[('status', 'not in', ('done','purchase','cancel','ven_draft','ven_sent'))]}"/>
                    <field name="tier1_retail" attrs="{'invisible':[('status', 'not in', ('done','purchase','cancel','ven_draft','ven_sent'))]}"   widget="monetary" />
                    <field name="tier2_retail" attrs="{'invisible':[('status', 'not in', ('done','purchase','cancel','ven_draft','ven_sent'))]}"   widget="monetary" />
                    <field name="less_than_40_retail" attrs="{'invisible':[('status', 'not in', ('done','purchase','cancel','ven_draft','ven_sent'))]}"   widget="monetary" />
                    <field name="new_customer" attrs="{'invisible':[('status', 'not in', ('done','purchase','cancel','ven_draft','ven_sent'))]}"/>

                    <field name="status_ven_app" attrs="{'invisible':[('status', 'not in', ('done','purchase','cancel','ven_draft','ven_sent'))]}"/>

                    <field name="currency_id" invisible="1"/>
<!--                    <field name="message_unread" invisible="1"/>-->
                </tree>

            </field>
        </record>


        <record id="appraisal_tracker_offer_form" model="ir.ui.view">
            <field name="name">purchase.order.appraisal.tracker.form.view</field>
            <field name="model">purchase.order</field>
            <!--<field name="context">[status: 'purchase']</field>-->
            <field name="arch" type="xml">


                <form string="Appraisal Tracker" class="o_sale_order vendor_offer_class" create="false" delete="false"
                      menu="false" print="false">
                    <header>
                        <button name="%(vendor_offer.action_purchase_order_edit_note)d" type="action" context="{'isFooterInvisible':False}"
                                string="Add Note"/>
                        <!--<button name="action_duplicate_vendor_offer" type="object" string="Duplicate Offer"/>-->
                    </header>
                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <button type="object"  name="action_view_invoice"
                            class="oe_stat_button"
                            icon="fa-pencil-square-o" attrs="{'invisible':['|', ('invoice_count', '=', 0), ('state', 'in', ('ven_draft','draft','sent','to approve'))]}">
                            <field name="invoice_count" widget="statinfo" string="Vendor Bills"/>
                            <field name='invoice_ids' invisible="1"/>
                        </button>
                            <button type="object"
                                    name="action_view_picking"
                                    class="oe_stat_button"
                                    icon="fa-truck"
                                    attrs="{'invisible':[('state', 'in', ('draft','sent','to approve')),('picking_ids','=',[])]}">
                                <field name="incoming_picking_count" widget="statinfo" string="Receipt"
                                       help="Incoming Shipments"/>
                                <field name="picking_ids" invisible="1"/>
                            </button>

                        </div>
                        <div class="oe_title">

                            <label string="Appraisal Tracker" for="name"/>
                            <h1>
                                <field name="name" readonly="1"/>
                            </h1>
                        </div>
                        <group>
                            <group>
                                <field name="vendor_cust_id_app" readonly="1"/>
                                <field name="partner_id" string='Facility Name' readonly="1"/>
                                <field name="acq_user_id" />
                                <field name="possible_competition" readonly="1"/>
                                <field name="accelerator" readonly="1"/>
                                <field name="priority" readonly="1"/>
                                <field name="offer_type" readonly="1"/>
                                <field name="potential_profit_margin" readonly="1"/>
                                <field name="state" invisible="1"/>
                                <field name="final_billed_offer_total"/>
                                <field name="final_billed_retail_total"/>
                            </group>
                            <group>
                                <field name="date_offered" string="Offer Date" readonly="1"/>
                                <field name="appraisal_no" />
                                <field name="accepted_date" readonly="1"/>
                                <field name="declined_date" readonly="1"/>
                                <field name="arrival_date_grp"/>
                                <field name="max" readonly="1"/>
                                <field name="new_customer" />
                                <field name="carrier_id" readonly="1"/>
                                <field name="shipping_number" readonly="1"/>
                                <field name="tier1_extra_retail"/>
                                <field name="tier2_extra_retail"/>
                                <field name="less_than_40_extra_retail"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Product">
                                <field name="order_line" mode="tree,kanban" attrs="{'readonly': True}">
                                    <form>
                                        <group>
                                            <group>
                                                <field name="product_id"/>
                                                <field name="sku_code" readonly="1"/>
                                                <field name="product_brand_id" readonly="1"/>
                                                <field name="name" invisible="1"/>
                                                <field name="product_tier" readonly="1"/>
                                                <field name="product_qty"/>
                                                <field name="expiration_date"/>
                                                <field name="qty_in_stock"/>
                                                <field name="product_sales_count"/>
                                                <field name="product_sales_count_month"/>
                                            </group>
                                            <group>
                                                <field name="product_sales_count_90"/>
                                                <field name="product_sales_count_yrs"/>
                                                <field name="expired_inventory"/>
                                                <!--<field name="list_price" invisible="1"/>-->
                                                <field name="product_unit_price"/>
                                                <field name="product_offer_price"/>
                                                <field name="product_retail"/>
                                                <field name="price_subtotal" string="Total Offer Price"/>
                                                <field name="margin"/>
                                                <field name="multiplier"/>
                                                <field name="product_note" readonly="1"/>
                                                <!--<field name="date_planned" invisible="1"/>-->
                                                <!--<field name="product_uom" invisible="1"/>-->
                                            </group>
                                        </group>
                                    </form>
                                    <tree editable="bottom">
                                        <field name="currency_id" invisible="1"/>
                                        <field name="product_id"/>
                                        <field name="sku_code" readonly="1"/>
                                        <field name="product_brand_id" readonly="1"/>
                                        <field name="name" invisible="1"/>
                                        <field name="product_tier" readonly="1"/>
                                        <field name="product_qty"/>
                                        <field name="qty_received" />
                                        <field name="qty_invoiced" />
                                        <field name="expiration_date" widget="date"/>
                                        <field name="qty_in_stock"/>
                                        <field name="product_sales_count"/>
                                        <field name="product_sales_count_month"/>
                                        <field name="product_sales_count_90"/>
                                        <field name="product_sales_count_yrs"/>
                                        <!--<field name="list_price" invisible="1"/>-->
                                        <field name="expired_inventory"/>
                                           <field name="vendor_offer_data" invisible="1"/>
                                        <field name="product_unit_price"/>
                                        <field name="product_offer_price"/>
                                          <field name="delivered_product_offer_price" attrs="{'invisible':[('vendor_offer_data', '=',  False)]}" />
                                        <field name="delivered_product_retail_price" attrs="{'invisible':[('vendor_offer_data', '=',  False)]}" />
                                          <field name="billed_product_offer_price" attrs="{'invisible':[('vendor_offer_data', '=',  False)]}" />
                                          <field name="billed_product_retail_price" attrs="{'invisible':[('vendor_offer_data', '=',  False)]}" />
                                        <field name="product_retail"/>
                                        <field name="price_subtotal" string="Total Offer Price"/>
                                        <field name="taxes_id" widget="many2many_tags"
                                               domain="[('type_tax_use','=','purchase')]"
                                               context="{'default_type_tax_use': 'purchase'}"
                                               options="{'no_create': True}"/>
                                        <!--    <field name="price_tax"  />
                                          <field name="price_total"   widget="monetary" />
                                          <field name="price_subtotal"   widget="monetary" />
                                       <field name="rt_price_tax"  />
                                          <field name="rt_price_total"   widget="monetary" />
                                          <field name="rt_price_subtotal"   widget="monetary" />-->
                                        <field name="margin"/>
                                        <field name="multiplier"/>
                                        <!--<field name="date_planned" invisible="1"/>-->
                                        <!--<field name="product_uom" invisible="1"/>-->
                                        <field name="order_id" invisible="1"/>

                                    </tree>

                                </field>
                                <group>
                                       <field name="vendor_offer_data" invisible="1"/>
                                    <group class="oe_subtotal_footer oe_right">

                                        <field name="amount_untaxed" widget="monetary" string="Untaxed Offer Price"/>
                                        <field name="amount_tax" string="Taxes"/>
                                         <div class="oe_subtotal_footer_separator oe_inline">
                                            <!--<label for="amount_total"/>-->
                                        </div>
                                        <field name="amount_total" widget="monetary" string="Total Offer Price" class="oe_subtotal_footer_separator"/>

                                    </group>
                                    <group class="oe_subtotal_footer oe_right">
                                        <field name="rt_price_subtotal_amt" widget="monetary"
                                               string="Untaxed Retail Price"/>
                                        <field name="rt_price_tax_amt" string="Taxes"/>
                                         <div class="oe_subtotal_footer_separator oe_inline">
                                            <!--<label for="rt_price_total_amt"/>-->
                                        </div>
                                        <field name="rt_price_total_amt"  widget="monetary" string="Total Retail Price" class="oe_subtotal_footer_separator"/>
                                    </group>

                            <group class="oe_subtotal_footer " attrs="{'invisible':[('vendor_offer_data', '=',  False)]}" style="margin-right: 15px;">
                                        <field name="billed_offer_untaxed" widget="monetary" options="{'currency_field': 'currency_id'}" string="Billed Untaxed Offer Price"/>
                                        <field name="rt_price_tax_amt" widget="monetary" options="{'currency_field': 'currency_id'}" string="Taxes"/>
                                        <div class="oe_subtotal_footer_separator oe_inline">
                                            <label for="billed_offer_total"/>
                                        </div>
                                        <field name="billed_offer_total" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"  string="Billed Total Retail Price"/>
                                        <div class="oe_subtotal_footer_separator oe_inline">
                                            <label for="final_billed_offer_total"/>
                                        </div>
                                        <field name="final_billed_offer_total" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"  string="Final Billed Total Retail Price"/>

                            </group>

                            <group class="oe_subtotal_footer " attrs="{'invisible':[('vendor_offer_data', '=',  False)]}" style="margin-right: 15px;">
                                        <field name="billed_retail_untaxed" widget="monetary" options="{'currency_field': 'currency_id'}" string="Billed Untaxed Retail Price"/>
                                        <field name="rt_price_tax_amt" widget="monetary" options="{'currency_field': 'currency_id'}" string="Taxes"/>
                                        <div class="oe_subtotal_footer_separator oe_inline">
                                            <label for="billed_retail_total"/>
                                        </div>
                                        <field name="billed_retail_total" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"  string="Billed Total Retail Price"/>
                                        <div class="oe_subtotal_footer_separator oe_inline">
                                            <label for="final_billed_retail_total"/>
                                        </div>
                                        <field name="final_billed_retail_total" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"  string="Final Billed Total Retail Price"/>
                            </group>
                                </group>
                                <field name="notes" class="oe_inline"
                                       placeholder="Define your terms and conditions ..."/>
                                <div class="oe_clear"/>
                            </page>
                            <page string="Deliveries">
                                <group>
                                    <group>
                                        <field name="date_planned" string="Receipt Date" readonly="1"/>
                                        <field name="shipping_label_issued" readonly="1"/>
                                    </group>
                                    <group>
                                        <field name="shipping_date" readonly="1"/>
                                        <field name="delivered_date" readonly="1"/>
                                        <field name="expected_date" readonly="1"/>
                                    </group>
                                </group>
                            </page>
                            <page string="Notes">
                                <field name="notes_activity"
                                       attrs="{'readonly': True}"/>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="activity_ids" widget="mail_activity"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

       <record id="appraisal_tracker.action_window" model="ir.actions.act_window">

            <field name="name">Appraisal Tracker</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">purchase.order</field>
            <field name="domain">[('state','in',('purchase','cancel','ven_draft','ven_sent','done')),('status','in',('purchase','cancel','ven_draft','ven_sent','done'))]</field>
            <field name="context">{'vendor_offer_data': True}</field>
            <field name="view_mode">form,tree</field>
            <field name="view_ids" eval="[(5, 0, 0),
        (0, 0, {'view_mode': 'tree', 'view_id': ref('appraisal_tracker.list')},),
        (0, 0, {'view_mode': 'form', 'view_id': ref('appraisal_tracker_offer_form')})
        ]"/>
           <!-- TODO:UPG_ODOO16_NOTE       (0, 0, {'view_mode': 'form', 'view_id': ref('appraisal_tracker_offer_form')})-->
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a request for quotation.
                </p>
                <p>
                    The quotation contains the history of the discussion/negotiation
                    you had with your vendor. Once confirmed, a request for
                    quotation is converted into a purchase order.
                </p>
                <p>
                    Most propositions of purchase orders are created automatically
                    by Odoo based on inventory needs.
                </p>
            </field>
        </record>

        <record id="action_report_appraisal_tracker" model="ir.actions.report">
            <field name="name">Appraisal Tracker</field>
            <field name="model">purchase.order</field>
            <field name="report_type">qweb-html</field>
            <field name="report_name">appraisal_tracker.appraisal_tracker_report</field>
            <field name="report_file">appraisal_tracker.appraisal_tracker_report</field>
        </record>



        <record id="appraisal_tracker_view_purchase_order_filter" model="ir.ui.view">
            <field name="name">request.quotation.select</field>
            <field name="model">purchase.order</field>
            <field name="inherit_id" ref="purchase.view_purchase_order_filter"></field>
            <field name="arch" type="xml">
                <!--<xpath expr="//group[@name='order_line']" >-->
                <group expand="0" string="Group By">
                    <filter string="Status" domain="[]" name="status_ven_app" context="{'group_by':'status_ven'}"/>
                    <filter string="Arrival Date" name="arrival_date_grp"  domain="[]" context="{'group_by':'arrival_date_grp','vendor_offer_data': True}"/>
                </group>
                <!--</xpath>-->
            </field>
        </record>

        <record id="click_to_dial_field_partner" model="ir.ui.view">
            <field name="name">res.partner.form.wholesaler</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="base.view_partner_form"/>
            <field name="priority" eval="22"/>
            <field name="arch" type="xml">
                  <field name="on_hold" position="after">
                      <field name="is_wholesaler" />
                  </field>
            </field>
        </record>

          <record id="appraisal_tracker_popup" model="ir.ui.view">
            <field name="name">purchase.order.popup</field>
            <field name="model">appraisaltracker.export</field>
            <field name="arch" type="xml">
                <form string="Export Appraisal Tracker">
                    <sheet>
                        <div>Click On ' Export To File ' button to export Appraisal Tracker file</div>
                        <footer>
                            <button name="download_excel_appraisal_tracker" string="Export To File" type="object"
                                    class="btn-primary"/>
                            <button string="Cancel" class="btn-default" special="cancel"/>
                        </footer>
                    </sheet>
                </form>
            </field>
        </record>


        <record id="appraisal_tracker_act_window" model="ir.actions.act_window">
                <field name="name">Export Appraisal Tracker</field>
                <field name="res_model" >appraisaltracker.export</field>
                <field name="binding_model_id" ref="purchase.model_purchase_order"/>
                <field name="view_mode">form</field>
                <field name="target">new</field>
            </record>

        <menuitem id="menu_procurement_management_appraisal_tracker" name="Appraisal Tracker"
                  parent="purchase.menu_procurement_management" action="appraisal_tracker.action_window" sequence="15"
        />

    </data>
</odoo>
