<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <template id="cart" inherit_id="website_sale.cart" customize_show="True">
        <xpath expr="//div[@id='wrap']" position="before">
            <t t-set="redirect_to_sign_in" t-value="website.account_on_checkout == 'mandatory' and website.is_public_user()"/>
            <t t-set="signup_allowed" t-value="user_id._get_signup_invitation_scope() == 'b2c'"/>
            <t t-set="suggest_create_account" t-value="redirect_to_sign_in and signup_allowed"/>
        </xpath>
        <!-- Show normal "Checkout" button if user is logged in or external login
             is disabled -->
        <a class="btn btn-primary float-end" role="button" t-attf-href="{{redirect_url}}" position="replace">
            <t t-set="redirect_url" t-value="'/web/signup?redirect=/shop/checkout' if suggest_create_account else redirect_url"/>
            <a class="btn btn-primary float-end" role="button" t-attf-href="{{redirect_url}}">
                <t t-if="redirect_to_sign_in">
                    <span t-if="suggest_create_account" >Sign up and Checkout</span>
                    <span t-else="" >Log in and Checkout</span>
                    <span class="fa fa-sign-in"/>
                </t>
                <t t-else="">
                    <span>Proceed to Checkout</span>
                    <span class="fa fa-chevron-right"/>
                </t>
            </a>
        </a>
    </template>
    <!-- Cart summary -->
    <template id="short_cart_summary" inherit_id="website_sale.short_cart_summary" customize_show="True">
        <a role="button" t-if="website_sale_order and website_sale_order.website_order_line" class="btn btn-secondary float-end d-none d-xl-inline-block" t-attf-href="{{redirect_url}}" position="replace">
            <t t-set="signup_allowed" t-value="user_id._get_signup_invitation_scope() == 'b2c'"/>
            <t t-set="suggest_create_account" t-value="redirect_to_sign_in and signup_allowed"/>
            <t t-set="redirect_url" t-value="'/web/signup?redirect=/shop/checkout' if suggest_create_account else redirect_url"/>
            <a role="button" t-if="website_sale_order and website_sale_order.website_order_line" class="btn btn-secondary float-end d-none d-xl-inline-block" t-attf-href="{{redirect_url}}">
                 <t t-if="redirect_to_sign_in">
                    <span t-if="suggest_create_account" >Sign up and Checkout</span>
                    <span t-else="" >Log in and Checkout</span>
                    <span class="fa fa-sign-in"/>
                </t>
                <t t-else="">
                    <span>Proceed to Checkout</span>
                    <span class="fa fa-chevron-right"/>
                </t>
            </a>
        </a>
    </template>
</odoo>
