<templates>

    <t t-name="ImportTemplateViewInner">
        <t t-set="_id" t-value="_.uniqueId('export')"/>
        <form action="" method="post" enctype="multipart/form-data" class="oe_import">
            <input type="hidden" name="csrf_token" t-att-value="csrf_token"/>
            <input type="hidden" name="import_id"/>
            <div class="oe_import_box col-sm-9" id="template_type_container">
                <div class="col-sm-12">
                    <p id="template_type_label">Template Type</p>
                </div>
                <div class="col-sm-10">
                    <div class="input-group" style="width:100%">
                        <select class="form-control template-type" name="template_type" id="template_type_list">
                            <option value="Inventory">Inventory</option>
                            <option value="Requirement">Requirement</option>
                        </select>
                    </div>
                </div>
            </div>
             <div class="oe_import_box col-sm-9">
                 <div class="col-sm-12" id ="customers_list_id">
                    <p id="template_type_label">Customer</p>
                </div>
                <div class="col-sm-12">
                    <p id="user_type_label"></p>
                    <img src="/customer-requests/static/src/img/loader.gif" alt="animated" id="loadingimg" />
                </div>

                <div class="col-sm-10">
                    <div class="input-group" style="width:100%">
                        <select class="form-control customer-select" name="customer" id="customers_list"/>
                    </div>
                </div>
            </div>
            <div class="oe_import_box col-lg-12 "  style="display:none;">
                <input accept=".csv, .xls, .xlsx, .xlsm, .ods" t-attf-id="file_#{_id}"
                      name="file" class="oe_import_file" type="file" style="display:none;"/>
                <div class="oe_import_with_file row">
                    <a href="#" class="oe_import_toggle col-sm-12" style="display:none;">
                        Formatting Options…</a>
                        <div class="row col-sm-12">
                            <div class="oe_import_toggled oe_import_options js_import_options col-md-6 col-lg-4">
                                <p t-foreach="widget.opts" t-as="option">
                                    <!-- no @name, avoid submission when file_update called -->
                                    <label t-attf-for="#{option.name}_#{_id}">
                                        <t t-esc="option.label"/></label>
                                    <input t-attf-id="#{option.name}_#{_id}"
                                           t-attf-class="oe_import_#{option.name}"
                                           style="width: 50%;"
                                           t-att-value="option.value"/>
                                </p>
                            </div>
                            <div t-foreach="[widget.parse_opts_formats, widget.parse_opts_separators]" t-as="options" class="oe_import_toggled oe_import_options col-md-6 col-lg-4">
                                <p t-foreach="options" t-as="option">
                                    <!-- no @name, avoid submission when file_update called -->
                                    <label t-attf-for="#{option.name}_#{_id}">
                                        <t t-esc="option.label"/></label>
                                    <input t-attf-id="#{option.name}_#{_id}"
                                           t-attf-class="oe_import_#{option.name}"
                                           style="width: 50%;"
                                           t-att-value="option.value"/>
                                </p>
                            </div>
                        </div>
                </div>
            </div>
            <div class="o_import_batch_alert alert alert-warning d-none">
                Due to its large size, the file will be imported by batches.
            </div>
            <div class="o_import_partial_alert alert alert-warning d-none">
                Click 'Resume' to proceed with the import, resuming at line
                <span class="o_import_partial_count">0</span>.<br/>
                You can test or reload your file before resuming the import.
            </div>

            <div class="oe_import_with_file d-none">
                <h2>Map your columns to import</h2>
                <div class="oe_import_debug_options">
                    <div title="If the model uses openchatter, history tracking will set up subscriptions and send notifications during the import, but lead to a slower import." class="oe_import_debug_option">
                        <input type="checkbox" id="oe_import_tracking" style="display:none"/>
                        <label for="oe_import_tracking" style="display:none">
                            Track history during import
                        </label>
                    </div>

                    <div class="oe_import_has_multiple_sheets js_import_options">
                        <label for="oe_import_sheet">Selected Sheet:</label>
                        <input class="oe_import_sheet" id="oe_import_sheet"/>
                    </div>

                    <div>
                        <input type="checkbox" class="oe_import_has_header"
                               id="oe_import_has_header" checked="checked" style="display:none"/>
                        <label for="oe_import_has_header" style="display:none">The first row
                         contains the label of the column</label>
                    </div>
                    <div class="js_import_options oe_import_debug_option oe_import_batch_limit">
                        <label for="oe_import_batch_limit">Batch limit</label>
                        <input id="oe_import_batch_limit" value="2000"/>
                    </div>
                    <div class="js_import_options oe_import_debug_option" title="Warning: ignores the labels line, empty lines and
                            lines composed only of empty cells">
                        <label for="oe_import_row_start">Start at line</label>
                        <input id="oe_import_row_start" value="1"/>
                    </div>
                    <div class="oe_import_debug_option">
                        <input type="checkbox" class="oe_import_advanced_mode" checked="checked"
                               id="oe_import_advanced_mode" style="display:none"/>
                        <label for="oe_import_advanced_mode" style="display:none">Show fields of relation fields (advanced)</label>
                    </div>
                </div>
                <p class="oe_import_noheaders text-muted">If the file contains
                the column names, Odoo can try auto-detecting the
                field corresponding to the column. This makes imports
                simpler especially when the file has many columns.</p>

                <div class="oe_import_error_report"></div>
                <div class="table-responsive-sm">
                    <table class="table-striped table-bordered oe_import_grid bg-white" />
                </div>
                <h6 class="oe_padding">This is a preview of the first 10 rows of your file</h6>
            </div>
            <!--<div class="o_view_nocontent">
                <div class="o_nocontent_help">
                    <p class="o_view_nocontent_smiling_face">
                        Select a CSV or Excel file to import.
                    </p>
                    <p>
                        Excel files are recommended as fields formatting is automatic.
                    </p>
                    <div class="mt16 mb4">Need Help?</div>
                    <div t-foreach="widget.importTemplates" t-as="template">
                        <a t-att-href="template.template" aria-label="Download" title="Download">
                            <i class="fa fa-download"/> <span><t t-esc="template.label"/></span>
                        </a>
                    </div>
                    <a href="https://www.odoo.com/documentation/user/14.0/general/base_import/import_faq.html" target="new">Import FAQ</a>
                </div>
            </div>-->
        </form>
    </t>

    <t t-name="ImportTemplateViewInner.buttons">
        <button type="button" class="btn btn-primary o_import_import o_import_import_full d-none">Import</button>
        <button type="button" class="btn btn-primary o_import_import o_import_import_partial d-none">Resume</button>
        <button type="button" class="btn btn-secondary o_import_validate d-none">Test</button>
        <button type="button" class="btn btn-secondary o_import_file_reload d-none">Reload File</button>
        <button type="button" class="btn btn-primary oe_import_file">Load File</button>
        <button type="button" class="btn btn-secondary o_import_cancel">Cancel</button>
    </t>

    <t t-name="ImportTemplateViewInner.create_record_option">
        <div class="mt4">
            <label title="Creates new records if they can't be found (instead of failing to import). Note that the value in the column will be used as the new record's 'name', and assumes this is sufficient to create the record.">
                <input type="checkbox" class="o_import_create_option"/>
                Create if doesn't exist
            </label>
        </div>
    </t>

    <t t-name="ImportTemplateViewInner.preview">
        <thead>
            <tr t-if="headers" class="oe_import_grid-header">
                <td t-foreach="headers" t-as="header" class="oe_import_grid-cell"
                    ><span class="o_import_header_name o_single_line_text" t-att-title="header"><t t-esc="header"/></span></td>
            </tr>
            <tr class="oe_import_fields">
                <!-- Iterate on first row to ensure we have all columns -->
                <td t-foreach="preview[0]" t-as="column">
                    <input class="oe_import_match_field"/>
                </td>
            </tr>
        </thead>
        <tbody>
            <tr t-foreach="preview" t-as="row" class="oe_import_grid-row">
                <td t-foreach="row" t-as="cell" class="oe_import_grid-cell">
                    <!-- content can be displayed on several lines if it contains whitespaces -->
                    <!-- in that case, we only display the 120 first characters -->
                    <!-- otherwise, we let the text-overflow: ellipsis do the job -->
                    <t t-set="multiline" t-value="cell.includes(' ')"/>
                    <t t-set="content" t-value="(multiline &amp;&amp; cell.length &gt; 120) ? (cell.substring(0, 120) + '...') : cell"/>
                    <span t-attf-class="#{multiline ? 'o_multi_line_text' : 'o_single_line_text'}">
                        <t t-esc="content"/>
                    </span>
                </td>
            </tr>
        </tbody>
    </t>
    <t t-name="ImportTemplateViewInner.preview.error">
        <div class="oe_import_report alert alert-danger">
            <p>Import preview failed due to: <t t-esc="error"/>.</p>
            <p>For CSV files, you may need to select the correct separator.</p>
            <p t-if="preview">Here is the start of the file we could not import:</p>
        </div>
        <pre t-if="preview"><t t-esc="preview"/></pre>
    </t>
    <ul t-name="ImportTemplateViewInner.error">
        <li t-foreach="errors" t-as="error"
            t-attf-class="oe_import_report alert alert-#{error_value[0].type}">
            <t t-if="error_value.length gt 1">
                <t t-call="ImportTemplateViewInner.error.multi.header">
                    <t t-set="error" t-value="error_value[0]"/>
                    <t t-set="error_length" t-value="error_value.length"/>
                </t>
                <ul>
                    <t t-foreach="error_value.length" t-as="index">
                        <li t-att-class="index gt 4 ? 'oe_import_report_more':''">
                            <t t-call="ImportTemplateViewInner.error.multi.body">
                                <t t-set="error" t-value="error_value[index]"/>
                                <t t-set="index" t-value="index"/>
                            </t>
                        </li>
                        <li t-if="error_value.length gt 5 and index == 4" style="display: block;">
                            <a href="#" class="oe_import_report_count">
                                <t t-esc="more(error_value.length - 5)"/>
                            </a>
                        </li>
                    </t>
                </ul>
                <t t-if="error_value[0].moreinfo" t-raw="info(error_value[0].moreinfo)"/>

            </t>
            <t t-else="">
                <t t-call="ImportTemplateViewInner.error.single">
                    <t t-set="error" t-value="error_value[0]"/>
                </t>
            </t>
        </li>
    </ul>
    <t t-name="ImportTemplateViewInner.error.multi.header">
        <span class="oe_import_report_message">
            <t t-esc="error.message"/>
            <t t-esc="at_multi_header(error_length)"/>
        </span>
    </t>
    <t t-name="ImportTemplateViewInner.error.multi.body">
        <span class="oe_import_report_message">
            <t t-esc="at_multi(error.rows)"/>
        </span>
    </t>
    <t t-name="ImportTemplateViewInner.error.single">
        <span class="oe_import_report_message">
            <t t-esc="error.message"/>
        </span>
        <t t-if="error.rows"  t-esc="at(error.rows)"/>
        <t t-if="error.moreinfo" t-raw="info(error.moreinfo)"/>
    </t>


    <!--old start-->
    <!--<t t-name="ImportTemplateViewInner">
        <t t-set="_id" t-value="_.uniqueId('export')"/>
        <form action="" method="post" enctype="multipart/form-data" class="oe_import">
            <input type="hidden" name="csrf_token" t-att-value="csrf_token"/>
            <input type="hidden" name="session_id"
               t-att-value="widget.session.session_id"/>
            <input type="hidden" name="import_id"/>
            <div class="oe_import_box col-sm-9" id="template_type_container">
                <div class="col-sm-12">
                    <p id="template_type_label">Template Type</p>
                </div>
                <div class="col-sm-10">
                    <div class="input-group" style="width:100%">
                        <select class="form-control template-type" name="template_type" id="template_type_list">
                            <option value="Inventory">Inventory</option>
                            <option value="Requirement">Requirement</option>
                        </select>
                    </div>
                </div>
            </div>
             <div class="oe_import_box col-sm-9">
                 <div class="col-sm-12" id ="customers_list_id">
                    <p id="template_type_label">Customer</p>
                </div>
                <div class="col-sm-12">
                    <p id="user_type_label"></p>
                    <img src="/customer-requests/static/src/img/loader.gif" alt="animated" id="loadingimg" />
                </div>

                <div class="col-sm-10">
                    <div class="input-group" style="width:100%">
                        <select class="form-control customer-select" name="customer" id="customers_list"/>
                    </div>
                </div>
            </div>
            <div class="oe_import_box col-lg-12 "  style="display:none;">
                <input accept=".csv, .xls, .xlsx, .xlsm, .ods" t-attf-id="file_#{_id}"
                      name="file" class="oe_import_file" type="file" style="display:none;"/>
                <div class="oe_import_with_file row">
                    <a href="#" class="oe_import_toggle col-sm-12" style="display:none;">
                        Formatting Options…</a>
                        <div class="row">
                            <div class="oe_import_toggled oe_import_options js_import_options col-sm">
                                <p t-foreach="widget.opts" t-as="option">
                                    &lt;!&ndash; no @name, avoid submission when file_update called &ndash;&gt;
                                    <label t-attf-for="#{option.name}_#{_id}">
                                        <t t-esc="option.label"/></label>
                                    <input t-attf-id="#{option.name}_#{_id}"
                                           t-attf-class="oe_import_#{option.name}"
                                           t-att-value="option.value"/>
                                </p>
                            </div>
                            <div t-foreach="[widget.parse_opts_formats, widget.parse_opts_separators]" t-as="options" class="oe_import_toggled oe_import_options col-sm">
                                <p t-foreach="options" t-as="option">
                                    &lt;!&ndash; no @name, avoid submission when file_update called &ndash;&gt;
                                    <label t-attf-for="#{option.name}_#{_id}">
                                        <t t-esc="option.label"/></label>
                                    <input t-attf-id="#{option.name}_#{_id}"
                                           t-attf-class="oe_import_#{option.name}"
                                           t-att-value="option.value"/>
                                </p>
                            </div>
                        </div>
                </div>
            </div>

            <div class="oe_import_with_file oe_padding col-md-12 d-none">
                <h2>Map your columns to import</h2>
                <div title="If the model uses openchatter, history tracking
                            will set up subscriptions and send notifications
                            during the import, but lead to a slower import."
                    class="oe_import_tracking">
                    <input type="checkbox" id="oe_import_tracking"  style="display:none"/>
                    <label for="oe_import_tracking"  style="display:none">
                        Track history during import
                    </label>
                </div>
                <div title="If the model uses parent/child relations, computing the
                    parent / child relation occurs on every line, and lead to a slower import.
                    Defering it can speed up import."
                    class="oe_import_deferparentstore">
                    <input type="checkbox" id="oe_import_deferparentstore" checked="checked"  style="display:none"/>
                    <label for="oe_import_deferparentstore"  style="display:none">
                        Defer parent/child computation
                    </label>
                </div>
                <input type="checkbox" class="oe_import_has_header"
                       id="oe_import_has_header" checked="checked" style="display:none" />
                <label for="oe_import_has_header" style="display:none">The first row
                 contains the label of the column</label>
                <input type="checkbox" class="oe_import_advanced_mode" checked="checked"
                       id="oe_import_advanced_mode" style="display:none" />
                <label for="oe_import_advanced_mode" style="display:none">Show fields of relation fields (advanced)</label>
                <p class="oe_import_noheaders text-muted">If the file contains
                the column names, Odoo can try auto-detecting the
                field corresponding to the column. This makes imports
                simpler especially when the file has many columns.</p>

                <div class="oe_import_error_report"></div>
                <div class="table-responsive-sm">
                    <table class="table-striped table-bordered oe_import_grid bg-white" />
                </div>
            </div>
            &lt;!&ndash;<div class="o_view_nocontent">&ndash;&gt;
                &lt;!&ndash;<div class="o_nocontent_help">&ndash;&gt;
                    &lt;!&ndash;<p class="o_view_nocontent_smiling_face">&ndash;&gt;
                        &lt;!&ndash;Select a Excel file to import.&ndash;&gt;
                    &lt;!&ndash;</p>&ndash;&gt;
                    &lt;!&ndash;<p>&ndash;&gt;
                        &lt;!&ndash;Excel files are recommended as fields formatting is automatic.&ndash;&gt;
                    &lt;!&ndash;</p>&ndash;&gt;
                    &lt;!&ndash;<div class="mt16 mb4">Need Help?</div>&ndash;&gt;
                    &lt;!&ndash;<div t-foreach="widget.importTemplates" t-as="template">&ndash;&gt;
                        &lt;!&ndash;<a t-att-href="template.template" aria-label="Download" title="Download">&ndash;&gt;
                            &lt;!&ndash;<i class="fa fa-download"/> <span><t t-esc="template.label"/></span>&ndash;&gt;
                        &lt;!&ndash;</a>&ndash;&gt;
                    &lt;!&ndash;</div>&ndash;&gt;
                    &lt;!&ndash;&lt;!&ndash;<a href="https://www.odoo.com/documentation/user/12.0/general/base_import/import_faq.html" target="new">Import FAQ</a>&ndash;&gt;&ndash;&gt;
                &lt;!&ndash;</div>&ndash;&gt;
            &lt;!&ndash;</div>&ndash;&gt;
        </form>
    </t>

    <t t-name="ImportTemplateViewInner.buttons">
        <button type="button" class="btn btn-primary o_import_import d-none">Import</button>
        <button type="button" class="btn btn-secondary o_import_validate d-none">Test Import</button>
        <button type="button" class="btn btn-secondary o_import_file_reload d-none">Reload File</button>
        <button type="button" class="btn btn-primary oe_import_file">Load File</button>
        <button type="button" class="btn btn-secondary o_import_cancel">Cancel</button>
    </t>

    <t t-name="ImportTemplateViewInner.create_record_option">
        <div class="mt4">
            <label title="Creates new records if they can't be found (instead of failing to import). Note that the value in the column will be used as the new record's 'name', and assumes this is sufficient to create the record.">
                <input type="checkbox" class="o_import_create_option"/>
                Create if doesn't exist
            </label>
        </div>
    </t>

    <t t-name="ImportTemplateViewInner.preview">
        <thead>
            <tr t-if="headers" class="oe_import_grid-header">
                <td t-foreach="headers" t-as="header" class="oe_import_grid-cell"
                    ><span class="o_import_header_name"><t t-esc="header"/></span></td>
            </tr>
            <tr class="oe_import_fields">
                &lt;!&ndash; Iterate on first row to ensure we have all columns &ndash;&gt;
                <td t-foreach="preview[0]" t-as="column">
                    <input class="oe_import_match_field"/>
                </td>
            </tr>
        </thead>
        <tbody>
            <tr t-foreach="preview" t-as="row" class="oe_import_grid-row">
                <td t-foreach="row" t-as="cell" class="oe_import_grid-cell"
                    ><t t-esc="cell"/></td>
            </tr>
        </tbody>
    </t>
    <t t-name="ImportTemplateViewInner.preview.error">
        <div class="oe_import_report bg-danger">
            <p>Import preview failed due to: <t t-esc="error"/>.</p>
            <p>For CSV files, you may need to select the correct separator.</p>
            <p t-if="preview">Here is the start of the file we could not import:</p>
        </div>
        <pre t-if="preview"><t t-esc="preview"/></pre>
    </t>
    <ul t-name="ImportTemplateViewInner.error">
        <li t-foreach="errors" t-as="error"
            t-attf-class="oe_import_report bg-#{error_value[0].type}">
            <t t-call="ImportTemplateViewInner.error.each">
                <t t-set="error" t-value="error_value[0]"/>
            </t>

            <a href="#" class="oe_import_report_count" t-if="error_value.length gt 1">
                <t t-esc="more(error_value.length - 1)"/>
            </a>
            <ul class="oe_import_report_more" t-if="error_value.length gt 1">
                <li t-foreach="error_value.length - 1" t-as="index">
                    <t t-call="ImportOfferTemplateViewInner.error.each">
                        <t t-set="error" t-value="error_value[index + 1]"/>
                    </t>
                </li>
            </ul>
        </li>
    </ul>
    <t t-name="ImportTemplateViewInner.error.each">
        <span class="oe_import_report_message">
            <t t-esc="error.message"/>
        </span>
        <t t-if="error.rows"  t-esc="at(error.rows)"/>
        <t t-if="error.moreinfo" t-raw="info(error.moreinfo)"/>
    </t>-->

    <!--old end-->

     <t t-name="ImportTemplateView">
        <t t-extend="ImportView">
            <t t-call="ImportTemplateViewInner"/>
        </t>
    </t>
</templates>
