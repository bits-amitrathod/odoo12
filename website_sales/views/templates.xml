<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ Product Expiration Lot~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

    <template id="products_item" name="Products item" inherit_id="website_sale.products_item">
                <xpath expr="//div[@class='product_price']" position="before">
                <!--   <t t-call="website_sales.productExpirationDate"/>-->
                </xpath>
    </template>

    <template id="productExpirationDate" name="Product Expiration Date">
        <t t-if="isVisibleWebsiteExpirationDate and product.actual_quantity &gt; 0">
            <div class="expiration-section">
                <p class="expiration-title">Expiration :</p>
                <p>
                    <span>Min -</span>
                    <t t-if="product.product_variant_id.id in productExpiration and productExpiration[product.product_variant_id.id]['str_min'] is not None">
                        <span t-esc="productExpiration[product.product_variant_id.id]['str_min']" />
                    </t>

                    <t t-else="">
                       <span> N/A</span>
                    </t>
                 </p>
                <p>
                    <span>Max -</span>
                    <t t-if="product.product_variant_id.id in productExpiration and productExpiration[product.product_variant_id.id]['str_max'] is not None">
                        <span t-esc="productExpiration[product.product_variant_id.id]['str_max']" />
                    </t>

                    <t t-else="">
                        <span>N/A</span>
                    </t>
                </p>
<!--                <p>-->
<!--                    <span>Min - Max : </span>-->
<!--                    <t t-if="product.product_variant_id.id in productExpiration and productExpiration[product.product_variant_id.id]['max'] is not None">-->
<!--                        <span t-esc="productExpiration[product.product_variant_id.id]['str_min_max']" />-->
<!--                    </t>-->

<!--                    <t t-else="">-->
<!--                        <span>N/A</span>-->
<!--                    </t>-->
<!--                </p>-->
                <!--<span t-esc="productExpiration"/>-->
                <!--product-->
                <!--<span t-esc="product.id"/> <span t-esc="product.product_variant_id.id"/>-->
            </div>
        </t>
    </template>

    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ products categories Filter ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <template id="products_categories" name="eCommerce Categories" inherit_id="website_sale.products_categories" active="False" customize_show="True">
        <xpath expr="//div[@id='products_grid_before']//div[@id='wsale_products_categories_collapse']/ul" position="replace">
            <!-- products categories Filter -->
            <div class="sidebar-accordion pt-5" id="categories">
                <div class="card">
                    <div class="card-header" id="allcategories">
                        <h2 class="mb-0">
                            <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse" data-target="#all_categories" aria-expanded="false" aria-controls="all_categories">
                              PRODUCT CATEGORY <i class="fa fa-plus"></i>
                            </button>
                        </h2>
                    </div>

                    <div id="all_categories" class="collapse" aria-labelledby="headingOne" data-parent="#categories">
                  <div class="card-body">
                      <ul class="sub-category">
                        <t t-foreach="categories" t-as="c">
                            <t t-call="website_sale.categories_recursive"/>
                        </t>
                      </ul>
                  </div>
                </div>
                </div>

                <!-- products Brand Filter -->
                <!--<div class="card">
                    <div class="card-header" id="brand">
                      <h2 class="mb-0">
                        <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                          BRANDS <i class="fa fa-plus"></i>
                        </button>
                      </h2>
                    </div>

                    <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#categories">
                      <div class="card-body">
                     <ul class="sub-category">
                        <t t-foreach="brands" t-as="c">
                            <li t-att-class="'active' if c.id == int(brand_id or 0) else None">
                                <a t-att-href="keep('/shop/category/'+slug(category)+'/brand/' + slug(c), category=0)" t-field="c.name" class="linkCstm"></a>
                            </li>
                            &lt;!&ndash;<h5><t t-esc="c.name"/></h5>&ndash;&gt;
                            &lt;!&ndash;<t t-call="website_sales.brand_recursive"/>&ndash;&gt;
                        </t>
                     </ul>
                      </div>
                    </div>
                  </div>-->
            </div>
        </xpath>
        <xpath expr="//div[@id='products_grid_before']" position="attributes">
            <attribute name="class">col-md-3 col-sm-4</attribute>
        </xpath>
        <xpath expr="//div[@id='products_grid']" position="attributes">
            <attribute name="class">col-md-9 col-sm-8</attribute>
        </xpath>
    </template>

    <record id="res_config_settings_view_form" model="ir.ui.view">
        <field name="name">res.config.settings.view.form.inherit.website.sale</field>
        <field name="model">res.config.settings</field>
        <field name="inherit_id" ref="website.res_config_settings_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//div[@id='sale_product_catalog_settings']" position="inside">

                <div class="col-xs-12 col-md-6 o_setting_box" id="product_lot_expiration_date_setting">
                    <div class="o_setting_left_pane">
                        <field name="website_expiration_date"/>
                    </div>
                    <div class="o_setting_right_pane">
                        <label for="website_expiration_date"/>
                        <div class="text-muted">
                            Display an product lot expiration minimum &amp; maximum dates
                        </div>
                    </div>
                </div>

            </xpath>
        </field>
    </record>

    <!--  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ Customer Reference As sales Order ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

    <template id="category_vender" name="category Vender">
        <div class="row category-wrapper">
            <div class="col-md">
                <div class="category-detail">
                    <span class="pull-left" style="padding-right: 5px;">Category:</span>
                    <ul class="list-inline mb-0">
                        <t t-set="commas" t-value="len(product.public_categ_ids)"/>
                        <t t-set="commaCount" t-value="1"/>
                            <li  style="padding: 0px;">
                        <t t-foreach="product.public_categ_ids" t-as="c">
                            <span t-att-class="'active' if c.id == int(category or 0) else None">
                                <a t-att-href="keep('/shop/category/' + slug(c), category=0)" class="linkCstm">
                                    <span t-field="c.name"/>
                                    <t t-if="commas &gt; commaCount">,</t>
                                </a>
                            </span>
                            <t t-set="commaCount" t-value="commaCount+1"/>
                        </t>
                            </li>
                    </ul>
                </div>
            </div>
            <div class="col-md">
                 <div class="category-detail  mb-3">
                    <span>Vendor:</span>
                    <a t-att-href="keep('/shop/brands', brand=product.product_brand_id.id)"
                       t-field="product.product_brand_id.name" class="linkCstm"></a>
                 </div>
            </div>
        </div>
    </template>

    <template id="categories_recursive" name="Category list">
        <li t-att-class="'active' if c.id == int(category or 0) else None">
            <a t-att-href="keep('/shop/category/' + slug(c), category=0)" t-field="c.name" class="linkCstm"></a>
            <ul t-if="c.child_id" class="nav nav-pills nav-stacked nav-hierarchy">
                <t t-foreach="c.child_id" t-as="c">
                    <t t-call="website_sales.categories_recursive"/>
                </t>
            </ul>
        </li>
    </template>

    <template id="brand_recursive" name="brand list">
        <li>
            <a t-att-href="keep('/shop/brand/')" t-field="c.name" class="linkCstm"></a>
            <ul t-if="c.child_id" class="nav nav-pills nav-stacked nav-hierarchy">

            </ul>
        </li>
    </template>

    <template id="checkout_cstm" name="Invoice Address updated" inherit_id="website_sale.checkout">
        <xpath expr="//div[@id='wrap']/div[@class='container oe_website_sale py-2']/
            div[@class='row']/div[@class='col-12 col-xl order-xl-1 oe_cart']/
            div[@class='row']/div[@class='col-lg-6 one_kanban']" position="replace">
            <t t-call="website_sale.address_kanban">
                <t t-set='contact' t-value="order.partner_invoice_id"/>
                <t t-set='selected' t-value="1"/>
                <t t-set='readonly' t-value="1"/>
            </t>
        </xpath>
    </template>


    <!--
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ Email Notification Template ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    -->
    <record id="website_order_placed" model="mail.template">
        <field name="name">Email Notification: Product Purchase Details</field>
        <field name="model_id" ref="website_sale.model_sale_order"/>
        <field name="email_to">${object.user_id.login}</field>
        <field name="email_cc">${('info@surgicalproductsolutions.com' | safe)}</field>
        <field name="subject">Please find the sales order that was placed online at shopsps.com from ${object.partner_id.name}.</field>
        <field name="body_html">
            <![CDATA[
                <link href="css/bootstrap.min.css" rel="stylesheet">
                 <div style="margin:auto;width:100%;padding-left: 60px;" class="container"/>
                     <div margin-top: 50px;>
                        <div>
                           <p>Hello <span>Team</span>,</p>
                           <p>A new sales order is placed online. Please see details below:</p>
                           <p><b>Customer :    </b> ${object.partner_id.name}</p>
                           <p><b>Sale Order# : </b> ${object.name} </p>
                           <p><b>SF A/C No# : </b> ${object.partner_id.saleforce_ac} </p>
                        </div>
                     </div>
                     <div>
                        <table style="border: 1px solid #efecec;width:100%">
                                <thead style='border: 1px solid black;background-color:#D6DBDF;line-height: 30px'>
                                    <tr style="border: 1px solid black;">
                                         <!--<th style="text-align: center;">Sales No</th>-->
                                         <th style="text-align: center;width:10%">SKU</th>
                                         <th style="text-align: center;width:50%">Product Name</th>
                                         <th style="text-align: center;width:10%">Quantity</th>
                                         <th style="text-align: center;width:10%">UOM</th>
                                         <th style="text-align: center;width:10%">Unit Price</th>
                                         <th style="text-align: center;width:10%">Subtotal</th>
                                    </tr>
                                </thead>
                                <tbody>
                                     % for product in object.order_line:
                                          <tr style='border: 1px solid black;background-color: ${product.background_color};line-height:25px'>
                                                 <!--<td align="center">${product.order_id.name}</td>-->
                                                 % if product.product_id.product_tmpl_id.default_code == False:
                                                 <td><span></span></td>
                                                 % else:
                                                 <td style="text-align: center;width:10%"><span>${product.product_id.product_tmpl_id.default_code}</span></td>
                                                 %endif
                                                 <td style="text-align: center;width:50%"><span>${product.name}</span></td>
                                                 <td style="text-align: center;width:10%"><span>${"%.0f"% product.product_uom_qty}</span></td>
                                                 <td style="text-align: center;width:10%"><span>${product.product_uom.name}</span></td>
                                                 <td style="text-align: center;width:10%"><span>${product.price_unit}</span></td>
                                                 <td style="text-align: center;width:10%"><span>${product.price_subtotal}</span></td>
                                          </tr>
                                     %endfor
                                </tbody>
                        </table>
                     <div>
                 % if object.carrier_id:
                    <div style="margin: 0px; padding: 0px;">
                        <table style="border: 1px solid #efecec;width:100%" width="100%"  align="right">
                            <tr>
                                <td style="width: 60%"/>
                                <td style="width: 30%; border-top: 1px solid #dee2e6;" align="right"><strong>Delivery:</strong></td>
                                <td style="width: 10%; border-top: 1px solid #dee2e6;" align="right">${format_amount(object.amount_delivery, object.currency_id)}</td>
                            </tr>
                            <tr>
                                <td style="width: 60%"/>
                                <td style="width: 30%;" align="right"><strong>SubTotal:</strong></td>
                                <td style="width: 10%;" align="right">${format_amount(object.amount_untaxed, object.currency_id)}</td>
                            </tr>
                        </table>
                    </div>
                % else:
                <div style="margin: 0px; padding: 0px;">
                    <table width="100%" style="color: #454748; border-spacing: 0px 4px;" align="right">
                        <tr>
                            <td style="width: 60%"/>
                            <td style="width: 30%; border-top: 1px solid #dee2e6;" align="right"><strong>SubTotal:</strong></td>
                            <td style="width: 10%; border-top: 1px solid #dee2e6;" align="right">${format_amount(object.amount_untaxed, object.currency_id)}</td>
                        </tr>
                    </table>
                </div>
                % endif
                <div style="margin: 0px; padding: 0px;">
                    <table width="100%" style="color: #454748; border-spacing: 0px 4px;" align="right">
                        <tr>
                            <td style="width: 60%"/>
                            <td style="width: 30%;" align="right"><strong>Taxes:</strong></td>
                            <td style="width: 10%;" align="right">${format_amount(object.amount_tax, object.currency_id)}</td>
                        </tr>
                        <tr>
                            <td style="width: 60%"/>
                            <td style="width: 30%; border-top: 1px solid #dee2e6;" align="right"><strong>Total:</strong></td>
                            <td style="width: 10%; border-top: 1px solid #dee2e6;" align="right">${format_amount(object.amount_total, object.currency_id)}</td>
                        </tr>
                    </table>
                </div>
                % set transaction = object.get_portal_last_transaction()
                % if object.partner_invoice_id:
                <div style="margin: 0px; padding: 0px;">
                    <table width="100%" style="color: #454748;">
                        <tr>
                            <td style="padding-top: 10px;">
                                <strong>Bill to:</strong>
                                ${object.partner_invoice_id.street or ''}
                                ${object.partner_invoice_id.city or ''}
                                ${object.partner_invoice_id.state_id.name or ''}
                                ${object.partner_invoice_id.zip or ''}
                                ${object.partner_invoice_id.country_id.name or ''}
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <strong>Payment Method:</strong>
                                % if transaction.payment_token_id:
                                    ${transaction.payment_token_id.name}
                                % else:
                                    ${transaction.acquirer_id.name}
                                % endif
                                 (${format_amount(transaction.amount, object.currency_id)})
                            </td>
                        </tr>
                    </table>
                </div>
                % endif
                % if object.partner_shipping_id and not object.only_services:
                <div style="margin: 0px; padding: 0px;">
                    <table width="100%" style="color: #454748;">
                        <tr>
                            <td>
                                <br/>
                                <strong>Ship to:</strong>
                                ${object.partner_shipping_id.street or ''}
                                ${object.partner_shipping_id.city or ''}
                                ${object.partner_shipping_id.state_id.name or ''}
                                ${object.partner_shipping_id.zip or ''}
                                ${object.partner_shipping_id.country_id.name or ''}
                            </td>
                        </tr>
                    </table>
                    % if object.carrier_id:
                    <table width="100%" style="color: #454748;">
                        <tr>
                            <td>
                                <strong>Shipping Method:</strong>
                                ${object.carrier_id.name}
                                % if object.carrier_id.fixed_price > 0.0:
                                    (${format_amount(object.carrier_id.fixed_price, object.currency_id)})
                                % endif
                            </td>
                        </tr>
                    </table>
                    % endif
                </div>
                % endif
                <div style="margin-top:20px">
                    <p>Thanks & Regards,</p>
                    <p> SPS Team </p>
                </div>
            </div>
        ]]>
        </field>
<!--        <field name="user_signature" eval="False"/>-->
    </record>

</odoo>