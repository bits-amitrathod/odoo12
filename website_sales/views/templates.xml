<?xml version="1.0" encoding="utf-8"?>
<odoo>
     <template id="modalCSTM" name="Optional Products cstm">
        <div id="modal_optional_products" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
                        <h4 class="modal-title" id="myModalLabel">Add to Cart</h4>
                    </div>
                    <div class="modal-body">
                        <table class="table table-striped table-condensed">
                            <thead>
                                <tr>
                                    <th class="td-img">Product</th>
                                    <th></th>
                                    <th class="text-center td-qty">Quantity</th>
                                    <th class="text-center td-price">Price</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr id="product_confirmation" class="js_product">
                                    <td class='td-img'>
                                        <span t-field="product.image_medium" t-options='{"widget": "image" }'/>
                                    </td>
                                    <td class='td-product_name'>
                                        <strong t-field="product.display_name"/>
                                        <div class="text-muted small">
                                            <div t-field="product.description_sale"/>
                                            <div class="js_attributes"/>
                                        </div>
                                    </td>
                                    <td class="text-center td-qty">
                                        <div class="css_quantity input-group oe_website_spinner">
                                            <a t-attf-href="#" class="mb8 input-group-addon js_add_cart_json hidden-xs">
                                                <i class="fa fa-minus"></i>
                                            </a>
                                            <input type="text" class="js_quantity form-control quantity" data-min="1"
                                                   name="add_qty" value="1"
                                                   t-att-data-max="product.actual_quantity"/>
                                            <a t-attf-href="#"
                                               class="mb8 input-group-addon float_left js_add_cart_json hidden-xs">
                                                <i class="fa fa-plus"></i>
                                            </a>
                                        </div>
                                        <!--                                        <div class='availability_messages'/>-->
                                    </td>
                                    <td class="text-center td-price" name="price">
                                        <ul class="hidden js_add_cart_variants"
                                            t-att-data-attribute_value_ids="json.dumps(main_product_attr_ids)"></ul>
                                        <div class="hidden oe_unchanged_value_ids"
                                             t-att-data-unchanged_value_ids="main_product_attr_ids[0][1]"></div>
                                        <t t-if="website.get_current_pricelist().discount_policy=='without_discount'">
                                            <span t-attf-class="text-danger oe_default_price oe_striked_price {{ (compute_currency(product.list_price) - product.website_price) &lt; 0.01 and 'hidden' }}"
                                                  t-field="product.list_price"
                                                  t-options='{
                                                "widget": "monetary",
                                                "from_currency": product.currency_id,
                                                "display_currency": website.currency_id
                                            }'/>
                                        </t>
                                        <span class="oe_price product_id" style="white-space: nowrap;"
                                              t-att-data-product-id="product.id"
                                              t-esc="product.website_price / quantity"
                                              t-options='{
                                                                           "widget": "monetary",
                                                                           "display_currency": website.currency_id
                                           }'/>
                                    </td>
                                </tr>

                                <tr t-if="product.optional_product_ids">
                                    <td colspan="2">
                                        <h4>Select Your Options:</h4>
                                    </td>
                                </tr>
                                <tr class="js_product" t-foreach="product.optional_product_ids" t-as="product">
                                    <td class="td-img">
                                        <input type="hidden" class="product_id"
                                               t-attf-name="optional-product-#{product_index}"
                                               t-att-value="product.product_variant_id.id if len(product.product_variant_ids) == 1 else '0'"/>
                                        <span t-field="product.image_small" t-options='{"widget": "image"}'/>
                                    </td>
                                    <td class='td-product_name' colspan="2">
                                        <div class="pull-left">
                                            <strong class="media-heading" t-field="product.name"/>
                                            <div class="text-muted small" t-field="product.description_sale"/>
                                        </div>
                                        <div class="pull-right">
                                            <t t-call="sale.variants"/>
                                        </div>
                                    </td>

                                    <td class="td-price">
                                        <span class="text-danger oe_default_price oe_optional"
                                              t-field="product.list_price"
                                              t-options='{
                                              "widget": "monetary",
                                              "from_currency": product.currency_id,
                                              "display_currency": website.currency_id
                                           }'/>
                                        <span class="oe_price" style="white-space: nowrap;"
                                              t-field="product.website_price"
                                              t-options='{
                                               "widget": "monetary",
                                               "display_currency": website.currency_id
                                           }'/>
                                        <p class="css_not_available_msg bg-danger" style="padding: 5px;">Product not
                                            available
                                        </p>

                                        <div class='mt8'>
                                            <input type="hidden" class="js_optional_same_quantity"
                                                   t-attf-name="optional-add-#{product_index}" value="0"/>
                                            <a href="#" class="js_add btn btn-sm btn-info">
                                                <strong>Add
                                                    <span class='hidden-xs'>to Cart</span>
                                                </strong>
                                            </a>
                                            <span class="js_remove hidden">
                                                <span class="js_item">1</span>
                                                <span class="js_items hidden">5</span>
                                                <span t-field="product.uom_id.sudo().name"/>
                                                <br/>
                                                <a href="#" class="js_remove btn btn-xs btn-info">
                                                    <small>Remove
                                                        <span class='hidden-xs'>from Cart</span>
                                                    </small>
                                                </a>
                                            </span>
                                        </div>
                                    </td>
                                </tr>

                            </tbody>
                        </table>
                    </div>
                    <div class="modal-footer">
                        <a class="btn btn-default a-submit js_goto_shop">
                            <i class="fa fa-chevron-left"></i>
                            <span class="hidden-xs">Continue Shopping</span>
                            <span class="visible-xs-inline">Continue</span>
                        </a>
                        <a class="btn btn-primary pull-right a-submit">
                            <i class="fa fa-shopping-cart fa-fw"></i>
                            <span class="hidden-xs">Proceed to Checkout</span>
                            <span class="visible-xs-inline">Checkout</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </template>

<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~SHOP PAGE Product Expiration Lot~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

    <template id="loader_in_stock" name="Loader In Stock">
        <div id="loader_in_stock" style="width: 100%; height: 100%; position: absolute; background-color: #b3b6b9;  z-index: 1000; opacity: 50%;top: 0%;">
             <img src="/website_sales/static/src/images/loader1.gif" class="img-fluid" style="
             width: 120px;height: 120px; display: block;
             position: absolute;top: 50%;left: 50%; transform: translate(-50%, -50%); z-index: 1;"></img>
        </div>
    </template>


    <template id="productExpirationDate" name="Product Expiration Date">
        <t t-if="isVisibleWebsiteExpirationDate and product.actual_quantity &gt; 0">
            <div class="expiration-section">
                <b><p class="expiration-title m-0">Expiration :</p></b>
                <p class="m-0">
                    <span>Min -</span>

                    <t t-if="product.product_variant_id.id in productExpiration and productExpiration[product.product_variant_id.id]['str_min'] is not None">
                        <span t-esc="productExpiration[product.product_variant_id.id]['str_min']" />
                    </t>
                    <t t-else="">
                       <span> N/A</span>
                    </t>
                </p>
                <p class="m-0">
                    <span>Max -</span>
                    <t t-if="product.product_variant_id.id in productExpiration and productExpiration[product.product_variant_id.id]['str_max'] is not None">
                        <span t-esc="productExpiration[product.product_variant_id.id]['str_max']" />
                    </t>
                    <t t-else="">
                        <span>N/A</span>
                    </t>
                </p>

<!--                <p>-->
<!--                    <span>Min - Max : </span>-->
<!--                    <t t-if="product.product_variant_id.id in productExpiration and productExpiration[product.product_variant_id.id]['max'] is not None">-->
<!--                        <span t-esc="productExpiration[product.product_variant_id.id]['str_min_max']" />-->
<!--                    </t>-->

<!--                    <t t-else="">-->
<!--                        <span>N/A</span>-->
<!--                    </t>-->
<!--                </p>-->
                <!--<span t-esc="productExpiration"/>-->
                <!--product-->
                <!--<span t-esc="product.id"/> <span t-esc="product.product_variant_id.id"/>-->
            </div>
        </t>
    </template>

<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~SHOP PAGE products categories Filter ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <template id="products_categories_list_inherit" name="eCommerce Categories list inherit" inherit_id="website_sale.products_categories_list">
         <h6 t-attf-class="o_categories_collapse_title mb-3 {{_titleClasses}}" position="replace">
             <b> PRODUCT CATEGORY</b>
         </h6>
<!--        UPG_ODOO16_NOTE -->
<!--        <xpath expr="//div[@id='products_grid_before']" position="attributes">-->
<!--            <attribute name="class">col-md-3 col-sm-4</attribute>-->
<!--        </xpath>-->
<!--        <xpath expr="//div[@id='products_grid']" position="attributes">-->
<!--            <attribute name="class">col-md-9 col-sm-8</attribute>-->
<!--        </xpath>-->
<!--        UPG_ODOO16_NOTE-->
    </template>

    <template id="category_vender" name="Category Vender">
        <div class="row category-wrapper">
            <div class="col-md">
                <div class="category-detail">
                    <span class="pull-left" style="padding-right: 5px;">Category:</span>
                    <ul class="list-inline mb-0">
                        <t t-set="commas" t-value="len(product.public_categ_ids)"/>
                        <t t-set="commaCount" t-value="1"/>
                        <li  style="padding: 0px;">
                            <t t-foreach="product.public_categ_ids" t-as="c">
                                <span t-att-class="'active' if c.id == int(category or 0) else None">
                                    <a t-att-href="keep('/shop/category/' + slug(c), category=0)" class="linkCstm">
                                        <span t-field="c.name"/>
                                        <t t-if="commas &gt; commaCount">,</t>
                                    </a>
                                </span>
                                <t t-set="commaCount" t-value="commaCount+1"/>
                            </t>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-md">
                 <div class="category-detail  mb-3">
                    <span>Vendor:</span>
                    <a t-att-href="keep('/shop/brands', brand=product.product_brand_id.id)"
                       t-field="product.product_brand_id.name" class="linkCstm"></a>
                 </div>
            </div>
        </div>
    </template>

<!--    <template id="categories_recursive" name="Category list">-->
<!--        <li t-att-class="'active' if c.id == int(category or 0) else None">-->
<!--            <a t-att-href="keep('/shop/category/' + slug(c), category=0)" t-field="c.name" class="linkCstm"></a>-->
<!--            <ul t-if="c.child_id" class="nav nav-pills nav-stacked nav-hierarchy">-->
<!--                <t t-foreach="c.child_id" t-as="c">-->
<!--                    <t t-call="website_sales.categories_recursive"/>-->
<!--                </t>-->
<!--            </ul>-->
<!--        </li>-->
<!--    </template>-->

    <template id="brand_recursive" name="brand list">
        <li>
            <a t-att-href="keep('/shop/brand/')" t-field="c.name" class="linkCstm"></a>
            <ul t-if="c.child_id" class="nav nav-pills nav-stacked nav-hierarchy"></ul>
        </li>
    </template>

    <!--  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ Customer Reference As sales Order ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

    <template id="website_sale_stock_cart_lines_cstm" inherit_id="website_sale.cart_lines" name="Shopping Cart Lines CSTM">
        <xpath expr="//input[@type='text'][hasclass('quantity')]" position="attributes">
            <attribute name='t-att-data-max'>line.product_id.actual_quantity
            </attribute>
        </xpath>
<!--    UPG_ODOO16_NOTE-->
<!--        <xpath expr="//input[hasclass('js_quantity')]" position="replace">-->
<!--            <input type="text" class="js_quantity form-control quantity" t-att-data-line-id="line.id" t-att-data-product-id="line.product_id.id" t-att-value="int(line.product_uom_qty) == line.product_uom_qty and int(line.product_uom_qty) or line.product_uom_qty" t-att-readonly="False"/>-->
<!--        </xpath>-->
<!--    UPG_ODOO16_NOTE-->
    </template>
    
<!--    UPG_ODOO16_NOTE-->
    <template id="checkout_cstm_address" name="Invoice Address updated" inherit_id="website_sale.checkout" priority="5">
        <xpath expr="//div[@id='wrap']//div[hasclass('oe_cart')]/div[@class='row']/div[@class='col-lg-6 one_kanban']" position="replace">
            <div class="col-lg-6 one_kanban">
                <t t-call="website_sale.address_kanban">
                    <t t-set='contact' t-value="order.partner_id"/>
                    <t t-set='selected' t-value="1"/>
                    <t t-set='readonly' t-value="1"/>
                    <t t-set='allow_edit' t-value="1"/>
                </t>
                <t t-call="website_sale.address_kanban">
                    <t t-set='contact' t-value="order.partner_invoice_id"/>
                    <t t-set='selected' t-value="1"/>
                    <t t-set='readonly' t-value="1"/>
                </t>
            </div>
        </xpath>
    </template>

     <template id="add_new_column" inherit_id="website_sale.cart_lines">
        <xpath expr="//th[@class='text-center td-qty']" position="before">
            <th class="text-center td-available-qty">Available Quantity</th>
        </xpath>
        <xpath expr="//td[@class='text-center td-qty']" position="before">
            <td t-if="line.product_id.actual_quantity" class="text-center td-available-qty">
                <div>
                    <strong t-field="line.product_id.actual_quantity" t-options='{"widget": "integer"}'/>
                </div>
            </td>
            <td t-else="1" class="text-center td-available-qty">
                <div>
                    <span>-</span>
                </div>
            </td>
        </xpath>
    </template>

    <!--    UPG_ODOO16_NOTE need to check this inherit again -->
<!--    <template id="sps_continue_shopping_button_custom" inherit_id="website_sale.cart" priority="5">-->
<!--        <a class="btn btn-secondary mb32" position="replace">-->
<!--            <a t-if="request.params.get('flag')" role="button" t-att-href="'/shop/quote_my_report/%s' % request.params.get('partner')" class="btn btn-secondary mb32">-->
<!--                <span class="fa fa-chevron-left" />-->
<!--                <span>Continue<span class="d-none d-md-inline"> Shopping</span></span>-->
<!--            </a>-->
<!--            <a t-else="" role="button" href="/shop" class="btn btn-secondary mb32">-->
<!--                <span class="fa fa-chevron-left" />-->
<!--                <span>Continue<span class="d-none d-md-inline"> Shopping</span></span>-->
<!--            </a>-->
<!--        </a>-->
<!--         <xpath expr="//div[@id='wrap']" position="inside">-->
<!--             <t t-call="website_sales.loader_in_stock"/>-->
<!--         </xpath>-->
<!--    </template>-->

</odoo>