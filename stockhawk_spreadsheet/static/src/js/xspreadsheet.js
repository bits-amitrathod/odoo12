!function(n){var r={};function i(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}i.m=n,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t,e){},function(t,e,n){},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.r(e);var i=(r(o.prototype,[{key:"data",value:function(t,e){return void 0!==e?(this.data[t]=e,this):this.data[t]}},{key:"on",value:function(t,r){var e,t=function(t){if(Array.isArray(t))return t}(e=t.split("."))||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}(),e=t[0],i=t.slice(1),e=e;return"mousewheel"===e&&/Firefox/i.test(window.navigator.userAgent)&&(e="DOMMouseScroll"),this.el.addEventListener(e,function(t){r(t);for(var e=0;e<i.length;e+=1){var n=i[e];if("left"===n&&0!==t.button)return;if("right"===n&&2!==t.button)return;"stop"===n&&t.stopPropagation()}}),this}},{key:"offset",value:function(e){var n=this;if(void 0!==e)return Object.keys(e).forEach(function(t){n.css(t,"".concat(e[t],"px"))}),this;var t=this.el;return{top:t.offsetTop,left:t.offsetLeft,height:t.offsetHeight,width:t.offsetWidth}}},{key:"scroll",value:function(t){var e=this.el;return void 0!==t&&(void 0!==t.left&&(e.scrollLeft=t.left),void 0!==t.top&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new o(this.el.parentNode)}},{key:"children",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return 0===arguments.length?this.el.childNodes:(n.forEach(function(t){return e.child(t)}),this)}},{key:"removeChild",value:function(t){this.el.removeChild(t)}},{key:"child",value:function(t){var e=t;return"string"==typeof t?e=document.createTextNode(t):t instanceof o&&(e=t.el),this.el.appendChild(e),this}},{key:"contains",value:function(t){return this.el.contains(t)}},{key:"className",value:function(t){return void 0!==t?(this.el.className=t,this):this.el.className}},{key:"addClass",value:function(t){return this.el.classList.add(t),this}},{key:"hasClass",value:function(t){return this.el.classList.contains(t)}},{key:"removeClass",value:function(t){return this.el.classList.remove(t),this}},{key:"toggle",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(t)}},{key:"toggleClass",value:function(t){return this.el.classList.toggle(t)}},{key:"active",value:function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"active";return t?this.addClass(e):this.removeClass(e),this}},{key:"checked",value:function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];return this.active(t,"checked"),this}},{key:"disabled",value:function(){return!(0<arguments.length&&void 0!==arguments[0])||arguments[0]?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(e,t){var n=this;if(void 0!==t)this.el.setAttribute(e,t);else{if("string"==typeof e)return this.el.getAttribute(e);Object.keys(e).forEach(function(t){n.el.setAttribute(t,e[t])})}return this}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"html",value:function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}},{key:"val",value:function(t){return void 0!==t?(this.el.value=t,this):this.el.value}},{key:"focus",value:function(){this.el.focus()}},{key:"cssRemoveKeys",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach(function(t){return e.el.style.removeProperty(t)}),this}},{key:"css",value:function(e,t){var n=this;return void 0===t&&"string"!=typeof e?(Object.keys(e).forEach(function(t){n.el.style[t]=e[t]}),this):void 0!==t?(this.el.style[e]=t,this):this.el.style[e]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){return this.css("display","block"),this}},{key:"hide",value:function(){return this.css("display","none"),this}}]),o),w=function(t){return new i(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:"")};function o(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";!function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),"string"==typeof t?(this.el=document.createElement(t),this.el.className=e):this.el=t,this.data={}}n(0);var a=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function b(t){for(var e="",n=t;n>=a.length;)n/=a.length,--n,e+=a[parseInt(n,10)%a.length];t%=a.length;return e+a[t]}function k(t){for(var e="",n="",r=0;r<t.length;r+=1)"0"<=t.charAt(r)&&t.charAt(r)<="9"?n+=t.charAt(r):e+=t.charAt(r);return[function(t){for(var e=0,n=0;n<t.length-1;n+=1){var r=t.charCodeAt(n)-65,i=t.length-1-n;e+=Math.pow(a.length,i)+a.length*r}return e+(t.charCodeAt(t.length-1)-65)}(e),parseInt(n,10)-1]}function O(t,e){return"".concat(b(t)).concat(e+1)}function x(t,e,n,r){var i=3<arguments.length&&void 0!==r?r:function(){return!0};if(0===e&&0===n)return t;var o,o=(o=k(t),r=2,function(t){if(Array.isArray(t))return t}(o)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(o,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()),r=o[0],o=o[1];return i(r,o)?O(r+e,o+n):t}function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var d=(fr=[{key:"valueOf",value:function(t){var e=t.split(":"),n=s(k(e[0]),2),r=n[0],i=n[1],t=i,n=r;return 1<e.length&&(n=(e=s(k(e[1]),2))[0],t=e[1]),new f(i,r,t,n)}}],l((Wn=f).prototype,[{key:"set",value:function(t,e,n,r){this.sri=t,this.sci=e,this.eri=n,this.eci=r}},{key:"multiple",value:function(){return 0<this.eri-this.sri||0<this.eci-this.sci}},{key:"includes",value:function(){for(var t=0,e=0,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];1===r.length?(e=(c=s(k(r[0]),2))[0],t=c[1]):2===r.length&&(t=r[0],e=r[1]);var o=this.sri,a=this.sci,l=this.eri,c=this.eci;return o<=t&&t<=l&&a<=e&&e<=c}},{key:"each",value:function(t){for(var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=this.sri,r=this.sci,i=this.eri,o=this.eci,a=n;a<=i;a+=1)if(e(a))for(var l=r;l<=o;l+=1)t(a,l)}},{key:"contains",value:function(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}},{key:"within",value:function(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}},{key:"disjoint",value:function(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}},{key:"intersects",value:function(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}},{key:"union",value:function(t){var e=this.sri,n=this.sci,r=this.eri,i=this.eci;return new f(t.sri<e?t.sri:e,t.sci<n?t.sci:n,t.eri>r?t.eri:r,t.eci>i?t.eci:i)}},{key:"difference",value:function(t){function e(t,e,n,r){i.push(new f(t,e,n,r))}var i=[],n=this.sri,r=this.sci,o=this.eri,a=this.eci,l=t.sri-n,c=t.sci-r,s=o-t.eri,u=a-t.eci;return 0<l?(e(n,r,t.sri-1,a),0<s?(e(t.eri+1,r,o,a),0<c&&e(t.sri,r,t.eri,t.sci-1),0<u&&e(t.sri,t.eci+1,t.eri,a)):(0<c&&e(t.sri,r,o,t.sci-1),0<u&&e(t.sri,t.eci+1,o,a))):0<s&&(e(t.eri+1,r,o,a),0<c&&e(n,r,t.eri,t.sci-1),0<u&&e(n,t.eci+1,t.eri,a)),0<c?(e(n,r,o,t.sci-1),0<u?(e(n,t.eri+1,o,a),0<l&&e(n,t.sci,t.sri-1,t.eci),0<s&&e(t.sri+1,t.sci,o,t.eci)):(0<l&&e(n,t.sci,t.sri-1,a),0<s&&e(t.sri+1,t.sci,o,a))):0<u&&(e(o,t.eci+1,o,a),0<l&&e(n,r,t.sri-1,t.eci),0<s&&e(t.eri+1,r,o,t.eci)),i}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"toString",value:function(){var t=this.sri,e=this.sci,n=this.eri,r=this.eci,t=O(e,t);return this.multiple()&&(t="".concat(t,":").concat(O(r,n))),t}},{key:"clone",value:function(){return new f(this.sri,this.sci,this.eri,this.eci,this.w,this.h)}},{key:"equals",value:function(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}}]),l(Wn,fr),f);function f(t,e,n,r){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;!function(t){if(!(t instanceof f))throw new TypeError("Cannot call a class as a function")}(this),this.sri=t,this.sci=e,this.eri=n,this.eci=r,this.w=i,this.h=o}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var u=(c(h.prototype,[{key:"multiple",value:function(){return this.range.multiple()}},{key:"setIndexes",value:function(t,e){this.ri=t,this.ci=e}},{key:"size",value:function(){return this.range.size()}}]),h);function h(){!function(t){if(!(t instanceof h))throw new TypeError("Cannot call a class as a function")}(this),this.range=new d(0,0,0,0),this.ri=0,this.ci=0}var p=function e(){!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.x=0,this.y=0,this.ri=0,this.ci=0};function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var v=(y(g.prototype,[{key:"add",value:function(t){this.undoItems.push(JSON.stringify(t)),this.redoItems=[]}},{key:"canUndo",value:function(){return 0<this.undoItems.length}},{key:"canRedo",value:function(){return 0<this.redoItems.length}},{key:"undo",value:function(t,e){var n=this.undoItems,r=this.redoItems;this.canUndo()&&(r.push(JSON.stringify(t)),e(JSON.parse(n.pop())))}},{key:"redo",value:function(t,e){var n=this.undoItems,r=this.redoItems;this.canRedo()&&(n.push(JSON.stringify(t)),e(JSON.parse(r.pop())))}}]),g);function g(){!function(t){if(!(t instanceof g))throw new TypeError("Cannot call a class as a function")}(this),this.undoItems=[],this.redoItems=[]}function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var S=(m(E.prototype,[{key:"copy",value:function(t){return this.range=t,this.state="copy",this}},{key:"cut",value:function(t){return this.range=t,this.state="cut",this}},{key:"isCopy",value:function(){return"copy"===this.state}},{key:"isCut",value:function(){return"cut"===this.state}},{key:"isClear",value:function(){return"clear"===this.state}},{key:"clear",value:function(){this.range=null,this.state="clear"}}]),E);function E(){!function(t){if(!(t instanceof E))throw new TypeError("Cannot call a class as a function")}(this),this.range=null,this.state="clear"}function j(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function C(t,e,n){return e&&_(t.prototype,e),n&&_(t,n),t}var T=(C(I,[{key:"set",value:function(t,e){this.operator=t,this.value=e}},{key:"includes",value:function(t){var e=this.operator,n=this.value;return"all"===e||"in"===e&&n.includes(t)}},{key:"vlength",value:function(){var t=this.operator,e=this.value;return"in"===t?e.length:0}},{key:"getData",value:function(){return{ci:this.ci,operator:this.operator,value:this.value}}}]),I),P=(C(D,[{key:"asc",value:function(){return"asc"===this.order}},{key:"desc",value:function(){return"desc"===this.order}}]),D),A=(C(R,[{key:"setData",value:function(t){var e=t.ref,n=t.filters,t=t.sort;null!=e&&(this.ref=e,this.filters=n.map(function(t){return new T(t.ci,t.operator,t.value)}),t&&(this.sort=new P(t.ci,t.order)))}},{key:"getData",value:function(){if(this.active()){var t=this.ref,e=this.filters,n=this.sort;return{ref:t,filters:e.map(function(t){return t.getData()}),sort:n}}return{}}},{key:"addFilter",value:function(t,e,n){var r=this.getFilter(t);null==r?this.filters.push(new T(t,e,n)):r.set(e,n)}},{key:"setSort",value:function(t,e){this.sort=e?new P(t,e):null}},{key:"includes",value:function(t,e){return!!this.active()&&this.hrange().includes(t,e)}},{key:"getSort",value:function(t){var e=this.sort;return e&&e.ci===t?e:null}},{key:"getFilter",value:function(t){for(var e=this.filters,n=0;n<e.length;n+=1)if(e[n].ci===t)return e[n];return null}},{key:"filteredRows",value:function(t){var e=new Set,n=new Set;if(this.active())for(var r=this.range(),i=r.sri,o=r.eri,a=this.filters,l=i+1;l<=o;l+=1)for(var c=0;c<a.length;c+=1){var s=a[c],u=t(l,s.ci),u=u?u.text:"";if(!s.includes(u)){e.add(l);break}n.add(l)}return{rset:e,fset:n}}},{key:"items",value:function(t,e){var n={};if(this.active())for(var r=this.range(),i=r.sri,o=r.eri,a=i+1;a<=o;a+=1){var l,c=e(a,t);null===c||/^\s*$/.test(c.text)?n[""]=(n[""]||0)+1:(c=(n[l=c.text]||0)+1,n[l]=c)}return n}},{key:"range",value:function(){return d.valueOf(this.ref)}},{key:"hrange",value:function(){var t=this.range();return t.eri=t.sri,t}},{key:"clear",value:function(){this.ref=null,this.filters=[],this.sort=null}},{key:"active",value:function(){return null!==this.ref}}]),R);function R(){j(this,R),this.ref=null,this.filters=[],this.sort=null}function D(t,e){j(this,D),this.ci=t,this.order=e}function I(t,e,n){j(this,I),this.ci=t,this.operator=e,this.value=n}function z(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var H=(z(M.prototype,[{key:"forEach",value:function(t){this._.forEach(t)}},{key:"deleteWithin",value:function(e){this._=this._.filter(function(t){return!t.within(e)})}},{key:"getFirstIncludes",value:function(t,e){for(var n=0;n<this._.length;n+=1){var r=this._[n];if(r.includes(t,e))return r}return null}},{key:"filterIntersects",value:function(e){return new M(this._.filter(function(t){return t.intersects(e)}))}},{key:"intersects",value:function(t){for(var e=0;e<this._.length;e+=1)if(this._[e].intersects(t))return!0;return!1}},{key:"union",value:function(t){var e=t;return this._.forEach(function(t){t.intersects(e)&&(e=t.union(e))}),e}},{key:"add",value:function(t){this.deleteWithin(t),this._.push(t)}},{key:"shift",value:function(o,a,l,c){this._.forEach(function(t){var e=t.sri,n=t.sci,r=t.eri,i=t.eci,t=t;"row"===o?a<=e?(t.sri+=l,t.eri+=l):e<a&&a<=r&&(t.eri+=l,c(e,n,l,0)):"column"===o&&(a<=n?(t.sci+=l,t.eci+=l):n<a&&a<=i&&(t.eci+=l,c(e,n,0,l)))})}},{key:"move",value:function(e,n,r){this._.forEach(function(t){t.within(e)&&(t.eri+=n,t.sri+=n,t.sci+=r,t.eci+=r)})}},{key:"setData",value:function(t){return this._=t.map(function(t){return d.valueOf(t)}),this}},{key:"getData",value:function(){return this._.map(function(t){return t.toString()})}}]),M);function M(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];!function(t){if(!(t instanceof M))throw new TypeError("Cannot call a class as a function")}(this),this._=t}function N(){for(var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length,e=new Array(1<t?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];return e.forEach(function(n){Object.keys(n).forEach(function(t){var e=n[t];"string"!=typeof e&&"number"!=typeof e&&"boolean"!=typeof e&&"function"!=typeof e&&!Array.isArray(e)&&e instanceof Object?(r[t]=r[t]||{},N(r[t],e)):r[t]=e})}),r}function F(t){for(var e="".concat(t),n=0,r=!1,i=0;i<e.length;i+=1)!0===r&&(n+=1),"."===e.charAt(i)&&(r=!0);return n}function W(t,e,n){if(Number.isNaN(e)||Number.isNaN(n))return e+t+n;var r=F(e),i=F(n),o=Number(e),e=Number(n),n=0;if("-"===t)n=o-e;else if("+"===t)n=o+e;else if("*"===t)n=o*e;else if("/"===t)return 5<F(n=o/e)?n.toFixed(2):n;return n.toFixed(Math.max(r,i))}var V={cloneDeep:function(t){return JSON.parse(JSON.stringify(t))},merge:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return N.apply(void 0,[{}].concat(e))},equals:function t(e,n){var r=Object.keys(e);if(r.length!==Object.keys(n).length)return!1;for(var i=0;i<r.length;i+=1){var o=r[i],a=e[o],l=n[o];if(void 0===l)return!1;if("string"==typeof a||"number"==typeof a||"boolean"==typeof a){if(a!==l)return!1}else if(Array.isArray(a)){if(a.length!==l.length)return!1;for(var c=0;c<a.length;c+=1)if(!t(a[c],l[c]))return!1}else if("function"!=typeof a&&!Array.isArray(a)&&a instanceof Object&&!t(a,l))return!1}return!0},arrayEquals:function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n+=1)if(t[n]!==e[n])return!1;return!0},sum:function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(t){return t},r=0,i=0;return Object.keys(e).forEach(function(t){r+=n(e[t],t),i+=1}),[r,i]},rangeEach:function(t,e,n){for(var r=t;r<e;r+=1)n(r)},rangeSum:function(t,e,n){for(var r=0,i=t;i<e;i+=1)r+=n(i);return r},rangeReduceIf:function(t,e,n,r,i,o){for(var a=n,l=r,c=t;c<e&&!(i<a);c+=1)a+=l=o(c);return[c,a-l,l]},deleteProperty:function(t,e){var n=t["".concat(e)];return delete t["".concat(e)],n},numberCalc:W};function q(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function B(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var L=(B(U.prototype,[{key:"getHeight",value:function(t){if(this.isHide(t))return 0;t=this.get(t);return(t&&t.height?t:this).height}},{key:"setHeight",value:function(t,e){this.getOrNew(t).height=e}},{key:"unhide",value:function(t){for(var e=t;0<e&&(--e,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){t=this.get(t);return t&&t.hide}},{key:"setHide",value:function(t,e){t=this.getOrNew(t);!0===e?t.hide=!0:delete t.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumHeight",value:function(t,e,n){var r=this;return V.rangeSum(t,e,function(t){return n&&n.has(t)?0:r.getHeight(t)})}},{key:"totalHeight",value:function(){return this.sumHeight(0,this.len)}},{key:"get",value:function(t){return this._[t]}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{cells:{}},this._[t]}},{key:"getCell",value:function(t,e){t=this.get(t);return void 0!==t&&void 0!==t.cells&&void 0!==t.cells[e]?t.cells[e]:null}},{key:"getCellMerge",value:function(t,e){e=this.getCell(t,e);return e&&e.merge?e.merge:[0,0]}},{key:"getCellOrNew",value:function(t,e){t=this.getOrNew(t);return t.cells[e]=t.cells[e]||{},t.cells[e]}},{key:"setCell",value:function(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"all",t=this.getOrNew(t);"all"===r?t.cells[e]=n:"text"===r?(t.cells[e]=t.cells[e]||{},t.cells[e].text=n.text):"format"===r&&(t.cells[e]=t.cells[e]||{},t.cells[e].style=n.style,n.merge&&(t.cells[e].merge=n.merge))}},{key:"setCellText",value:function(t,e,n){e=this.getCellOrNew(t,e);!1!==e.editable&&(e.text=n)}},{key:"copyPaste",value:function(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]&&arguments[3],i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:function(){},o=t.sri,a=t.sci,l=t.eri,c=t.eci,s=e.sri,u=e.sci,f=e.eri,h=e.eci,t=q(t.size(),2),p=t[0],d=t[1],t=q(e.size(),2),e=t[0],t=t[1],y=!0,v=0;(f<o||h<a)&&(y=!1,v=f<o?e:t);for(var b=o;b<=l;b+=1)if(this._[b])for(var g=a;g<=c;g+=1)if(this._[b].cells&&this._[b].cells[g])for(var m=s;m<=f;m+=p)for(var w=u;w<=h;w+=d){var k=m+(b-o),O=w+(g-a),S=V.cloneDeep(this._[b].cells[g]);r&&S&&S.text&&0<S.text.length&&function(){var t,e,n=S.text,r=w-u+(m-s)+2;y||(r-=v+1),"="===n[0]?S.text=n.replace(/[a-zA-Z]{1,3}\d+/g,function(t){var e=0,n=0;return o===s?e=r-1:n=r-1,/^\d+$/.test(t)?t:x(t,e,n)}):!(p<=1&&1<d&&(l<s||f<o)||d<=1&&1<p&&(c<u||h<a)||p<=1&&d<=1)||null!==(t=/[\\.\d]+$/.exec(n))&&(e=Number(t[0])+r-1,S.text=n.substring(0,t.index)+e)}(),this.setCell(k,O,S,n),i(k,O,S)}}},{key:"cutPaste",value:function(i,o){var a=this,l={};this.each(function(r){a.eachCells(r,function(t){var e=parseInt(r,10),n=parseInt(t,10);i.includes(r,t)&&(e=o.sri+(e-i.sri),n=o.sci+(n-i.sci)),l[e]=l[e]||{cells:{}},l[e].cells[n]=a._[r].cells[t]})}),this._=l}},{key:"paste",value:function(t,e){var r,i,o=this;t.length<=0||(r=e.sri,i=e.sci,t.forEach(function(t,e){var n=r+e;t.forEach(function(t,e){e=i+e;o.setCellText(n,e,t)})}))}},{key:"insert",value:function(r){var i=this,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,a={};this.each(function(t,e){var n=parseInt(t,10);r<=n&&(n+=o,i.eachCells(t,function(t,e){e.text&&"="===e.text[0]&&(e.text=e.text.replace(/[a-zA-Z]{1,3}\d+/g,function(t){return x(t,0,o,function(t,e){return r<=e})}))})),a[n]=e}),this._=a,this.len+=o}},{key:"delete",value:function(r,i){var o=this,a=i-r+1,l={};this.each(function(t,e){var n=parseInt(t,10);n<r?l[n]=e:i<t&&(l[n-a]=e,o.eachCells(t,function(t,e){e.text&&"="===e.text[0]&&(e.text=e.text.replace(/[a-zA-Z]{1,3}\d+/g,function(t){return x(t,0,-a,function(t,e){return i<e})}))}))}),this._=l,this.len-=a}},{key:"insertColumn",value:function(r){var i=this,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;this.each(function(t,e){var n={};i.eachCells(t,function(t,e){t=parseInt(t,10);r<=t&&(t+=o,e.text&&"="===e.text[0]&&(e.text=e.text.replace(/[a-zA-Z]{1,3}\d+/g,function(t){return x(t,o,0,function(t){return r<=t})}))),n[t]=e}),e.cells=n})}},{key:"deleteColumn",value:function(r,i){var o=this,a=i-r+1;this.each(function(t,e){var n={};o.eachCells(t,function(t,e){t=parseInt(t,10);t<r?n[t]=e:i<t&&((n[t-a]=e).text&&"="===e.text[0]&&(e.text=e.text.replace(/[a-zA-Z]{1,3}\d+/g,function(t){return x(t,-a,0,function(t){return i<t})})))}),e.cells=n})}},{key:"deleteCells",value:function(t){var n=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"all";t.each(function(t,e){n.deleteCell(t,e,r)})}},{key:"deleteCell",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"all",r=this.get(t);null===r||null!==(t=this.getCell(t,e))&&!1!==t.editable&&("all"===n?delete r.cells[e]:"text"===n?(t.text&&delete t.text,t.value&&delete t.value):"format"===n?(void 0!==t.style&&delete t.style,t.merge&&delete t.merge):"merge"===n&&t.merge&&delete t.merge)}},{key:"maxCell",value:function(){var t=Object.keys(this._),e=t[t.length-1],t=this._[e];if(t){t=t.cells,t=Object.keys(t),t=t[t.length-1];return[parseInt(e,10),parseInt(t,10)]}return[0,0]}},{key:"each",value:function(n){Object.entries(this._).forEach(function(t){var e=q(t,2),t=e[0],e=e[1];n(t,e)})}},{key:"eachCells",value:function(t,n){this._[t]&&this._[t].cells&&Object.entries(this._[t].cells).forEach(function(t){var e=q(t,2),t=e[0],e=e[1];n(t,e)})}},{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}}]),U);function U(t){var e=t.len,t=t.height;!function(t){if(!(t instanceof U))throw new TypeError("Cannot call a class as a function")}(this),this._={},this.len=e,this.height=t}function Y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var $=(Y(K.prototype,[{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}},{key:"getWidth",value:function(t){if(this.isHide(t))return 0;t=this._[t];return(t&&t.width?t:this).width}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{},this._[t]}},{key:"setWidth",value:function(t,e){this.getOrNew(t).width=e}},{key:"unhide",value:function(t){for(var e=t;0<e&&(--e,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){t=this._[t];return t&&t.hide}},{key:"setHide",value:function(t,e){t=this.getOrNew(t);!0===e?t.hide=!0:delete t.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumWidth",value:function(t,e){var n=this;return V.rangeSum(t,e,function(t){return n.getWidth(t)})}},{key:"totalWidth",value:function(){return this.sumWidth(0,this.len)}}]),K),X=["en"],Z={en:{toolbar:{undo:"Undo",redo:"Redo",print:"Print",paintformat:"Paint format",clearformat:"Clear format",format:"Format",fontName:"Font",fontSize:"Font size",fontBold:"Font bold",fontItalic:"Font italic",underline:"Underline",strike:"Strike",color:"Text color",bgcolor:"Fill color",border:"Borders",merge:"Merge cells",align:"Horizontal align",valign:"Vertical align",textwrap:"Text wrapping",freeze:"Freeze cell",autofilter:"Filter",formula:"Functions",more:"More"},contextmenu:{copy:"Copy",cut:"Cut",paste:"Paste",pasteValue:"Paste values only",pasteFormat:"Paste format only",hide:"Hide",insertRow:"Insert row",insertColumn:"Insert column",deleteSheet:"Delete",deleteRow:"Delete row",deleteColumn:"Delete column",deleteCell:"Delete cell",deleteCellText:"Delete cell text",validation:"Data validations",cellprintable:"Enable export",cellnonprintable:"Disable export",celleditable:"Enable editing",cellnoneditable:"Disable editing"},print:{size:"Paper size",orientation:"Page orientation",orientations:["Landscape","Portrait"]},format:{normal:"Normal",text:"Plain Text",number:"Number",percent:"Percent",rmb:"RMB",usd:"USD",eur:"EUR",date:"Date",time:"Time",datetime:"Date time",duration:"Duration"},formula:{sum:"Sum",average:"Average",max:"Max",min:"Min",_if:"IF",and:"AND",or:"OR",concat:"Concat"},validation:{required:"it must be required",notMatch:"it not match its validation rule",between:"it is between {} and {}",notBetween:"it is not between {} and {}",notIn:"it is not in list",equal:"it equal to {}",notEqual:"it not equal to {}",lessThan:"it less than {}",lessThanEqual:"it less than or equal to {}",greaterThan:"it greater than {}",greaterThanEqual:"it greater than or equal to {}"},error:{pasteForMergedCell:"Unable to do this for merged cells"},calendar:{weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},button:{next:"Next",cancel:"Cancel",remove:"Remove",save:"Save",ok:"OK"},sort:{desc:"Sort Z -> A",asc:"Sort A -> Z"},filter:{empty:"empty"},dataValidation:{mode:"Mode",range:"Cell Range",criteria:"Criteria",modeType:{cell:"Cell",column:"Colun",row:"Row"},type:{list:"List",number:"Number",date:"Date",phone:"Phone",email:"Email"},operator:{be:"between",nbe:"not betwwen",lt:"less than",lte:"less than or equal to",gt:"greater than",gte:"greater than or equal to",eq:"equal to",neq:"not equal to"}}}};function K(t){var e=t.len,n=t.width,r=t.indexWidth,t=t.minWidth;!function(t){if(!(t instanceof K))throw new TypeError("Cannot call a class as a function")}(this),this._={},this.len=e,this.width=n,this.indexWidth=r,this.minWidth=t}function J(t,e){if(e)for(var n=0,r=X;n<r.length;n++){var i=r[n];if(!e[i])break;for(var o=e[i],a=t.match(/(?:\\.|[^.])+/g),l=0;l<a.length;l+=1){var c=o[a[l]];if(!c)break;if(l===a.length-1)return c;o=c}}}function G(t){var e=J(t,Z);return!e&&window&&window.x_spreadsheet&&window.x_spreadsheet.$messages&&(e=J(t,window.x_spreadsheet.$messages)),e||""}function Q(t){return function(){return G(t)}}function tt(t,e,n){2<arguments.length&&void 0!==n&&n?X=[t]:X.unshift(t),e&&(Z[t]=e)}function et(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function nt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var rt={phone:/^[1-9]\d{10}$/,email:/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/};function it(t,e){var n="";if(!t){for(var r=arguments.length,i=new Array(2<r?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];n=G.apply(void 0,["validation.".concat(e)].concat(i))}return[t,n]}var ot=(nt(at.prototype,[{key:"parseValue",value:function(t){var e=this.type;return"date"===e?new Date(t):"number"===e?Number(t):t}},{key:"equals",value:function(t){return this.type===t.type&&this.required===t.required&&this.operator===t.operator&&(Array.isArray(this.value)?V.arrayEquals(this.value,t.value):this.value===t.value)}},{key:"values",value:function(){return this.value.split(",")}},{key:"validate",value:function(t){var e=this.required,n=this.operator,r=this.value,i=this.type;if(e&&/^\s*$/.test(t))return it(!1,"required");if(/^\s*$/.test(t))return[!0];if(rt[i]&&!rt[i].test(t))return it(!1,"notMatch");if("list"===i)return it(this.values().includes(t),"notIn");if(n){t=this.parseValue(t);if("be"===n){var o=et(r,2),a=o[0],o=o[1];return it(t>=this.parseValue(a)&&t<=this.parseValue(o),"between",a,o)}if("nbe"===n){a=et(r,2),o=a[0],a=a[1];return it(t<this.parseValue(o)||t>this.parseValue(a),"notBetween",o,a)}if("eq"===n)return it(t===this.parseValue(r),"equal",r);if("neq"===n)return it(t!==this.parseValue(r),"notEqual",r);if("lt"===n)return it(t<this.parseValue(r),"lessThan",r);if("lte"===n)return it(t<=this.parseValue(r),"lessThanEqual",r);if("gt"===n)return it(t>this.parseValue(r),"greaterThan",r);if("gte"===n)return it(t>=this.parseValue(r),"greaterThanEqual",r)}return[!0]}}]),at);function at(t,e,n,r){!function(t){if(!(t instanceof at))throw new TypeError("Cannot call a class as a function")}(this),this.required=e,this.value=n,this.type=t,this.operator=r,this.message=""}function lt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ct(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function st(t,e,n){return e&&ct(t.prototype,e),n&&ct(t,n),t}var ut=(st(pt,[{key:"includes",value:function(t,e){for(var n=this.refs,r=0;r<n.length;r+=1)if(d.valueOf(n[r]).includes(t,e))return!0;return!1}},{key:"addRef",value:function(t){this.remove(d.valueOf(t)),this.refs.push(t)}},{key:"remove",value:function(n){var r=[];this.refs.forEach(function(t){var e=d.valueOf(t);e.intersects(n)?e.difference(n).forEach(function(t){return r.push(t.toString())}):r.push(t)}),this.refs=r}},{key:"getData",value:function(){var t=this.refs,e=this.mode,n=this.validator;return{refs:t,mode:e,type:n.type,required:n.required,operator:n.operator,value:n.value}}}],[{key:"valueOf",value:function(t){var e=t.refs,n=t.mode,r=t.type,i=t.required,o=t.operator,t=t.value;return new pt(n,e,new ot(r,i,t,o))}}]),pt),ft=(st(ht,[{key:"getError",value:function(t,e){return this.errors.get("".concat(t,"_").concat(e))}},{key:"validate",value:function(t,e,n){var r=this.get(t,e),t="".concat(t,"_").concat(e),e=this.errors;return null!==r?(n=(r=(r=r.validator.validate(n),n=2,function(t){if(Array.isArray(t))return t}(r)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()))[0],r=r[1],n?e.delete(t):e.set(t,r)):e.delete(t),!0}},{key:"add",value:function(t,e,n){var r=n.type,i=n.required,o=n.value,n=n.operator,o=new ot(r,i,o,n),n=this.getByValidator(o);null!==n?n.addRef(e):this._.push(new ut(t,[e],o))}},{key:"getByValidator",value:function(t){for(var e=0;e<this._.length;e+=1){var n=this._[e];if(n.validator.equals(t))return n}return null}},{key:"get",value:function(t,e){for(var n=0;n<this._.length;n+=1){var r=this._[n];if(r.includes(t,e))return r}return null}},{key:"remove",value:function(e){this.each(function(t){t.remove(e)})}},{key:"each",value:function(e){this._.forEach(function(t){return e(t)})}},{key:"getData",value:function(){return this._.filter(function(t){return 0<t.refs.length}).map(function(t){return t.getData()})}},{key:"setData",value:function(t){this._=t.map(function(t){return ut.valueOf(t)})}}]),ht);function ht(){lt(this,ht),this._=[],this.errors=new Map}function pt(t,e,n){lt(this,pt),this.refs=e,this.mode=t,this.validator=n}function dt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function yt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var vt={mode:"edit",view:{height:function(){return document.documentElement.clientHeight},width:function(){return document.documentElement.clientWidth}},showGrid:!0,showToolbar:!0,showContextmenu:!0,showBottomBar:!0,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:60},style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,underline:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1},format:"normal"}};function bt(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},r=this.merges,i=e.clone(),o=yt(t.size(),2),a=o[0],l=o[1],t=yt(e.size(),2),o=t[0],t=t[1];return o<a&&(i.eri=e.sri+a-1),t<l&&(i.eci=e.sci+l-1),!r.intersects(i)||(n(G("error.pasteForMergedCell")),!1)}function gt(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]&&arguments[3],i=this.rows,o=this.merges;"all"!==n&&"format"!==n||(i.deleteCells(e,n),o.deleteWithin(e)),i.copyPaste(t,e,n,r,function(t,e,n){var r;n&&n.merge&&(n=(r=yt(n.merge,2))[0],r=r[1],n<=0&&r<=0||o.add(new d(t,e,t+n,e+r)))})}function mt(t,e,n){var r=this.styles,t=this.rows.getCellOrNew(t,e),e={};void 0!==t.style&&(e=V.cloneDeep(r[t.style])),e=V.merge(e,{border:n}),t.style=this.addStyle(e)}var wt=(dt(kt.prototype,[{key:"addValidation",value:function(t,e,n){var r=this;this.changeData(function(){r.validations.add(t,e,n)})}},{key:"removeValidation",value:function(){var t=this,e=this.selector.range;this.changeData(function(){t.validations.remove(e)})}},{key:"getSelectedValidator",value:function(){var t=this.selector,e=t.ri,t=t.ci,t=this.validations.get(e,t);return t?t.validator:null}},{key:"getSelectedValidation",value:function(){var t=this.selector,e=t.ri,n=t.ci,t=t.range,n=this.validations.get(e,n),t={ref:t.toString()};return null!==n&&(t.mode=n.mode,t.validator=n.validator),t}},{key:"canUndo",value:function(){return this.history.canUndo()}},{key:"canRedo",value:function(){return this.history.canRedo()}},{key:"undo",value:function(){var e=this;this.history.undo(this.getData(),function(t){e.setData(t)})}},{key:"redo",value:function(){var e=this;this.history.redo(this.getData(),function(t){e.setData(t)})}},{key:"copy",value:function(){this.clipboard.copy(this.selector.range)}},{key:"copyToSystemClipboard",value:function(){if(null!=navigator.clipboard){for(var e="",t=this.rows.getData(),n=this.selector.range.sri;n<=this.selector.range.eri;n++){if(t.hasOwnProperty(n))for(var r,i=this.selector.range.sci;i<=this.selector.range.eci;i++)i>this.selector.range.sci&&(e+="\t"),t[n].cells.hasOwnProperty(i)&&(-1==(r=String(t[n].cells[i].text)).indexOf("\n")&&-1==r.indexOf("\t")&&-1==r.indexOf('"')?e+=r:e+='"'+r+'"');else for(i=this.selector.range.sci;i<=this.selector.range.eci;i++)e+="\t";e+="\n"}navigator.clipboard.writeText(e).then(function(){},function(t){console.log("text copy to the system clipboard error  ",e,t)})}}},{key:"cut",value:function(){this.clipboard.cut(this.selector.range)}},{key:"paste",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"all",n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},r=this.clipboard,i=this.selector;return!r.isClear()&&!!bt.call(this,r.range,i.range,n)&&(this.changeData(function(){r.isCopy()?gt.call(t,r.range,i.range,e):r.isCut()&&function(t,e){var n=this.clipboard,r=this.rows,i=this.merges;r.cutPaste(t,e),i.move(t,e.sri-t.sri,e.sci-t.sci),n.clear()}.call(t,r.range,i.range)}),!0)}},{key:"pasteFromText",value:function(t){var e=t.split("\r\n").map(function(t){return t.replace(/"/g,"").split("\t")});0<e.length&&--e.length;var n=this.rows,r=this.selector;this.changeData(function(){n.paste(e,r.range)})}},{key:"autofill",value:function(t,e){var n=this,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},i=this.selector.range;return!!bt.call(this,i,t,r)&&(this.changeData(function(){gt.call(n,i,t,e,!0)}),!0)}},{key:"clearClipboard",value:function(){this.clipboard.clear()}},{key:"calSelectedRangeByEnd",value:function(t,e){var n=this.selector,r=this.rows,i=this.cols,o=this.merges,a=n.range,l=a.sri,c=a.sci,s=a.eri,u=a.eci,f=n.ri,h=n.ci,p=t,a=e;return t<0&&(p=r.len-1),e<0&&(a=i.len-1),s=f<p?(l=f,p):(l=p,f),u=h<a?(c=h,a):(c=a,h),n.range=o.union(new d(l,c,s,u)),n.range=o.union(n.range),n.range}},{key:"calSelectedRangeByStart",value:function(t,e){var n=this.selector,r=this.rows,i=this.cols,o=this.merges.getFirstIncludes(t,e);return null===o&&(o=new d(t,e,t,e),-1===t&&(o.sri=0,o.eri=r.len-1),-1===e&&(o.sci=0,o.eci=i.len-1)),n.range=o}},{key:"setSelectedCellAttr",value:function(p,d){var y=this;this.changeData(function(){var t=y.selector,r=y.styles,i=y.rows;if("merge"===p)d?y.merge():y.unmerge();else if("border"===p)(function(t){var p=this,d=t.mode,y=t.style,v=t.color,n=this.styles,e=this.selector,b=this.rows,t=e.range,g=t.sri,m=t.sci,w=t.eri,k=t.eci,O=!this.isSignleSelected();if(O||"inside"!==d&&"horizontal"!==d&&"vertical"!==d)if("outside"!==d||O){if("none"===d)e.range.each(function(t,e){t=b.getCell(t,e);t&&void 0!==t.style&&(delete(e=V.cloneDeep(n[t.style])).border,t.style=p.addStyle(e))});else if("all"===d||"inside"===d||"outside"===d||"horizontal"===d||"vertical"===d)!function(){for(var e=[],t=g;t<=w;t+=1)for(var n=m;n<=k;n+=1){for(var r=[],i=0;i<e.length;i+=1){var o=yt(e[i],4),a=o[0],l=o[1],c=o[2],o=o[3];if(t===a+c+1&&r.push(i),a<=t&&t<=a+c&&n===l){n+=o+1;break}}if(r.forEach(function(t){return e.splice(t,1)}),k<n)break;var s=b.getCell(t,n),u=0,f=0;s&&s.merge&&(u=(h=yt(s.merge,2))[0],f=h[1],e.push([t,n,u,f]));var s=0<u&&t+u===w,h=0<f&&n+f===k,u={};"all"===d?u={bottom:[y,v],top:[y,v],left:[y,v],right:[y,v]}:"inside"===d?(!h&&n<k&&(u.right=[y,v]),!s&&t<w&&(u.bottom=[y,v])):"horizontal"===d?!s&&t<w&&(u.bottom=[y,v]):"vertical"===d?!h&&n<k&&(u.right=[y,v]):"outside"===d&&O&&(g===t&&(u.top=[y,v]),!s&&w!==t||(u.bottom=[y,v]),m===n&&(u.left=[y,v]),!h&&k!==n||(u.right=[y,v])),0<Object.keys(u).length&&mt.call(p,t,n,u),n+=f}}();else if("top"===d||"bottom"===d)for(var r=m;r<=k;r+=1)"top"===d&&(mt.call(this,g,r,{top:[y,v]}),r+=b.getCellMerge(g,r)[1]),"bottom"===d&&(mt.call(this,w,r,{bottom:[y,v]}),r+=b.getCellMerge(w,r)[1]);else if("left"===d||"right"===d)for(var i=g;i<=w;i+=1)"left"===d&&(mt.call(this,i,m,{left:[y,v]}),i+=b.getCellMerge(i,m)[0]),"right"===d&&(mt.call(this,i,k,{right:[y,v]}),i+=b.getCellMerge(i,k)[0])}else mt.call(this,g,m,{top:[y,v],bottom:[y,v],left:[y,v],right:[y,v]})}).call(y,d);else if("formula"===p){var e=t.ri,n=t.ci,o=t.range;if(t.multiple()){var a=yt(t.size(),2),l=a[0],c=a[1],s=o.sri,a=o.sci,u=o.eri,f=o.eci;if(1<l)for(var h=a;h<=f;h+=1)i.getCellOrNew(u+1,h).text="=".concat(d,"(").concat(O(h,s),":").concat(O(h,u),")");else 1<c&&(i.getCellOrNew(e,f+1).text="=".concat(d,"(").concat(O(a,e),":").concat(O(f,e),")"))}else i.getCellOrNew(e,n).text="=".concat(d,"()")}else t.range.each(function(t,e){var n=i.getCellOrNew(t,e),t={};void 0!==n.style&&(t=V.cloneDeep(r[n.style])),"format"===p?(t.format=d,n.style=y.addStyle(t)):"font-bold"===p||"font-italic"===p||"font-name"===p||"font-size"===p?((e={})[p.split("-")[1]]=d,t.font=Object.assign(t.font||{},e),n.style=y.addStyle(t)):"strike"===p||"textwrap"===p||"underline"===p||"align"===p||"valign"===p||"color"===p||"bgcolor"===p?(t[p]=d,n.style=y.addStyle(t)):n[p]=d})})}},{key:"setSelectedCellText",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"input",n=this.autoFilter,r=this.selector,i=this.rows,o=r.ri,a=r.ci,r=o;this.unsortedRowMap.has(o)&&(r=this.unsortedRowMap.get(o));var i=i.getCell(r,a),l=i?i.text:"";this.setCellText(r,a,t,e),n.active()&&(!(n=n.getFilter(a))||0<=(a=n.value.findIndex(function(t){return t===l}))&&n.value.splice(a,1,t))}},{key:"getSelectedCell",value:function(){var t=this.selector,e=t.ri,n=t.ci,t=e;return this.unsortedRowMap.has(e)&&(t=this.unsortedRowMap.get(e)),this.rows.getCell(t,n)}},{key:"xyInSelectedRect",value:function(t,e){var n=this.getSelectedRect(),r=n.left,i=n.top,o=n.width,n=n.height,t=t-this.cols.indexWidth,e=e-this.rows.height;return r<t&&t<r+o&&i<e&&e<i+n}},{key:"getSelectedRect",value:function(){return this.getRect(this.selector.range)}},{key:"getClipboardRect",value:function(){var t=this.clipboard;return t.isClear()?{left:-100,top:-100}:this.getRect(t.range)}},{key:"getRect",value:function(t){var e=this.scroll,n=this.rows,r=this.cols,i=this.exceptRowSet,o=t.sri,a=t.sci,l=t.eri,c=t.eci;if(o<0&&a<0)return{left:0,l:0,top:0,t:0,scroll:e};var s=r.sumWidth(0,a),t=n.sumHeight(0,o,i),o=n.sumHeight(o,l+1,i),l=r.sumWidth(a,c+1),i=s-e.x,r=t-e.y,a=this.freezeTotalHeight(),c=this.freezeTotalWidth();return 0<c&&s<c&&(i=s),0<a&&t<a&&(r=t),{l:s,t:t,left:i,top:r,height:o,width:l,scroll:e}}},{key:"getCellRectByXY",value:function(t,e){var n,r=this.scroll,i=this.merges,o=this.rows,a=this.cols,l=function(t,e){var n=this.rows,r=this.freezeTotalHeight(),i=n.height;r+n.height<t&&(i-=e);for(var o=this.exceptRowSet,a=0,l=i,c=n.height;a<n.len&&!(t<l);a+=1)o.has(a)||(l+=c=n.getHeight(a));return(l-=c)<=0?{ri:-1,top:0,height:c}:{ri:a-1,top:l,height:c}}.call(this,e,r.y),c=l.ri,s=l.top,e=l.height,l=function(t,e){var n=this.cols,r=this.freezeTotalWidth(),i=n.indexWidth;r+n.indexWidth<t&&(i-=e);e=yt(V.rangeReduceIf(0,n.len,i,n.indexWidth,t,function(t){return n.getWidth(t)}),3),i=e[0],t=e[1],e=e[2];return t<=0?{ci:-1,left:0,width:n.indexWidth}:{ci:i-1,left:t,width:e}}.call(this,t,r.x),t=l.ci,r=l.left,l=l.width;return-1===t&&(l=a.totalWidth()),-1===c&&(e=o.totalHeight()),(0<=c||0<=t)&&(n=i.getFirstIncludes(c,t))&&(c=n.sri,t=n.sci,r=(n=this.cellRect(c,t)).left,s=n.top,l=n.width,e=n.height),{ri:c,ci:t,left:r,top:s,width:l,height:e}}},{key:"isSignleSelected",value:function(){var t=this.selector.range,e=t.sri,n=t.sci,r=t.eri,i=t.eci,o=this.getCell(e,n);if(o&&o.merge){t=yt(o.merge,2),o=t[0],t=t[1];if(e+o===r&&n+t===i)return!0}return!this.selector.multiple()}},{key:"canUnmerge",value:function(){var t=this.selector.range,e=t.sri,n=t.sci,r=t.eri,i=t.eci,o=this.getCell(e,n);if(o&&o.merge){t=yt(o.merge,2),o=t[0],t=t[1];if(e+o===r&&n+t===i)return!0}return!1}},{key:"merge",value:function(){var e,n,t,r,i,o=this,a=this.selector,l=this.rows;this.isSignleSelected()||(t=yt(a.size(),2),e=t[0],n=t[1],(1<e||1<n)&&(t=a.range,r=t.sri,i=t.sci,this.changeData(function(){var t=l.getCellOrNew(r,i);t.merge=[e-1,n-1],o.merges.add(a.range),o.rows.deleteCells(a.range),o.rows.setCell(r,i,t)})))}},{key:"unmerge",value:function(){var t,e,n,r=this,i=this.selector;this.isSignleSelected()&&(t=i.range,e=t.sri,n=t.sci,this.changeData(function(){r.rows.deleteCell(e,n,"merge"),r.merges.deleteWithin(i.range)}))}},{key:"canAutofilter",value:function(){return!this.autoFilter.active()}},{key:"autofilter",value:function(){var t=this,e=this.autoFilter,n=this.selector;this.changeData(function(){e.active()?(e.clear(),t.exceptRowSet=new Set,t.sortedRowMap=new Map,t.unsortedRowMap=new Map):e.ref=n.range.toString()})}},{key:"setAutoFilter",value:function(t,e,n,r){var i=this.autoFilter;i.addFilter(t,n,r),i.setSort(t,e),this.resetAutoFilter()}},{key:"resetAutoFilter",value:function(){var n,t,e,r,i=this,o=this.autoFilter,a=this.rows;o.active()&&(n=o.sort,t=(e=o.filteredRows(function(t,e){return a.getCell(t,e)})).rset,o=e.fset,e=Array.from(o),r=Array.from(o),n&&e.sort(function(t,e){return"asc"===n.order?t-e:"desc"===n.order?e-t:0}),this.exceptRowSet=t,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,e.forEach(function(t,e){i.sortedRowMap.set(r[e],t),i.unsortedRowMap.set(t,r[e])}))}},{key:"deleteCell",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"all",n=this.selector;this.changeData(function(){t.rows.deleteCells(n.range,e),"all"!==e&&"format"!==e||t.merges.deleteWithin(n.range)})}},{key:"insert",value:function(a){var l=this,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;this.changeData(function(){var t=l.selector.range,e=t.sri,n=t.sci,i=l.rows,r=l.merges,o=l.cols,t=e;"row"===a?i.insert(e,c):"column"===a&&(i.insertColumn(n,c),t=n,o.len+=1),r.shift(a,t,c,function(t,e,n,r){e=i.getCell(t,e);e.merge[0]+=n,e.merge[1]+=r})})}},{key:"delete",value:function(f){var h=this;this.changeData(function(){var i=h.rows,t=h.merges,e=h.selector,n=h.cols,r=e.range,o=e.range,a=o.sri,l=o.sci,c=o.eri,s=o.eci,u=yt(e.range.size(),2),o=u[0],e=u[1],u=a,o=o;"row"===f?i.delete(a,c):"column"===f&&(i.deleteColumn(l,s),u=r.sci,o=e,--n.len),t.shift(f,u,-o,function(t,e,n,r){e=i.getCell(t,e);e.merge[0]+=n,e.merge[1]+=r,0===e.merge[0]&&0===e.merge[1]&&delete e.merge})})}},{key:"scrollx",value:function(t,e){var n=this.scroll,r=this.freeze,i=this.cols,o=yt(r,2)[1],a=yt(V.rangeReduceIf(o,i.len,0,0,t,function(t){return i.getWidth(t)}),3),r=a[0],o=a[1],a=a[2],o=o;0<t&&(o+=a),n.x!==o&&(n.ci=0<t?r:0,n.x=o,e())}},{key:"scrolly",value:function(t,e){var n=this.scroll,r=this.freeze,i=this.rows,o=yt(r,1)[0],a=yt(V.rangeReduceIf(o,i.len,0,0,t,function(t){return i.getHeight(t)}),3),r=a[0],o=a[1],a=a[2],o=o;0<t&&(o+=a),n.y!==o&&(n.ri=0<t?r:0,n.y=o,e())}},{key:"cellRect",value:function(t,e){var n=this.rows,r=this.cols,i=r.sumWidth(0,e),o=n.sumHeight(0,t),a=n.getCell(t,e),l=r.getWidth(e),c=n.getHeight(t);if(null!==a&&a.merge){var s=yt(a.merge,2),u=s[0],f=s[1];if(0<u)for(var h=1;h<=u;h+=1)c+=n.getHeight(t+h);if(0<f)for(var p=1;p<=f;p+=1)l+=r.getWidth(e+p)}return{left:i,top:o,width:l,height:c,cell:a}}},{key:"getCell",value:function(t,e){return this.rows.getCell(t,e)}},{key:"getCellTextOrDefault",value:function(t,e){e=this.getCell(t,e);return e&&e.text?e.text:""}},{key:"getCellStyle",value:function(t,e){e=this.getCell(t,e);return e&&void 0!==e.style?this.styles[e.style]:null}},{key:"getCellStyleOrDefault",value:function(t,e){var n=this.styles,e=this.rows.getCell(t,e),e=e&&void 0!==e.style?n[e.style]:{};return V.merge(this.defaultStyle(),e)}},{key:"getSelectedCellStyle",value:function(){var t=this.selector,e=t.ri,t=t.ci;return this.getCellStyleOrDefault(e,t)}},{key:"setCellText",value:function(t,e,n,r){var i=this.rows,o=this.history,a=this.validations;"finished"===r?(i.setCellText(t,e,""),o.add(this.getData()),i.setCellText(t,e,n)):(i.setCellText(t,e,n),this.change(this.getData())),a.validate(t,e,n)}},{key:"freezeIsActive",value:function(){var t=yt(this.freeze,2),e=t[0],t=t[1];return 0<e||0<t}},{key:"setFreeze",value:function(t,e){var n=this;this.changeData(function(){n.freeze=[t,e]})}},{key:"freezeTotalWidth",value:function(){return this.cols.sumWidth(0,this.freeze[1])}},{key:"freezeTotalHeight",value:function(){return this.rows.sumHeight(0,this.freeze[0])}},{key:"setRowHeight",value:function(t,e){var n=this;this.changeData(function(){n.rows.setHeight(t,e)})}},{key:"setColWidth",value:function(t,e){var n=this;this.changeData(function(){n.cols.setWidth(t,e)})}},{key:"viewHeight",value:function(){var t=this.settings,e=t.view,n=t.showToolbar,t=t.showBottomBar,e=e.height();return t&&(e-=41),n&&(e-=41),e}},{key:"viewWidth",value:function(){return this.settings.view.width()}},{key:"freezeViewRange",value:function(){var t=yt(this.freeze,2),e=t[0],t=t[1];return new d(0,0,e-1,t-1,this.freezeTotalWidth(),this.freezeTotalHeight())}},{key:"contentRange",value:function(){var t=this.rows,e=this.cols,n=yt(t.maxCell(),2),r=n[0],n=n[1],t=t.sumHeight(0,r+1),e=e.sumWidth(0,n+1);return new d(0,0,r,n,e,t)}},{key:"exceptRowTotalHeight",value:function(e,n){var t=this.exceptRowSet,r=this.rows,t=Array.from(t),i=0;return t.forEach(function(t){(t<e||n<t)&&(t=r.getHeight(t),i+=t)}),i}},{key:"viewRange",value:function(){var t=this.scroll,e=this.rows,n=this.cols,r=this.freeze,i=this.exceptRowSet,o=t.ri,t=t.ci;o<=0&&(o=yt(r,1)[0]),t<=0&&(t=yt(r,2)[1]);for(var a=0,l=0,r=[e.len,n.len],c=r[0],s=r[1],u=o;u<e.len&&(i.has(u)||(l+=e.getHeight(u),c=u),!(l>this.viewHeight()));u+=1);for(var f=t;f<n.len&&(s=f,!((a+=n.getWidth(f))>this.viewWidth()));f+=1);return new d(o,t,c,s,a,l)}},{key:"eachMergesInView",value:function(t,e){this.merges.filterIntersects(t).forEach(function(t){return e(t)})}},{key:"hideRowsOrCols",value:function(){var t=this.rows,e=this.cols,n=this.selector,r=yt(n.size(),2),i=r[0],o=r[1],a=n.range,r=a.sri,n=a.sci,l=a.eri,c=a.eci;if(i===t.len)for(var s=n;s<=c;s+=1)e.setHide(s,!0);else if(o===e.len)for(var u=r;u<=l;u+=1)t.setHide(u,!0)}},{key:"unhideRowsOrCols",value:function(t,e){this["".concat(t,"s")].unhide(e)}},{key:"rowEach",value:function(t,e,n){for(var r,i=0,o=this.rows,a=this.exceptRowSet,l=function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(r=a)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}(),c=0,s=0;s<l.length;s+=1)l[s]<t&&(c+=1);for(var u=t+c;u<=e+c;u+=1)if(a.has(u))c+=1;else{var f=o.getHeight(u);if(0<f&&(n(u,i,f),(i+=f)>this.viewHeight()))break}}},{key:"colEach",value:function(t,e,n){for(var r=0,i=this.cols,o=t;o<=e;o+=1){var a=i.getWidth(o);if(0<a&&(n(o,r,a),(r+=a)>this.viewWidth()))break}}},{key:"defaultStyle",value:function(){return this.settings.style}},{key:"addStyle",value:function(t){for(var e=this.styles,n=0;n<e.length;n+=1){var r=e[n];if(V.equals(r,t))return n}return e.push(t),e.length-1}},{key:"changeData",value:function(t){this.history.add(this.getData()),t(),this.change(this.getData())}},{key:"setData",value:function(r){var i=this;return Object.keys(r).forEach(function(t){var e,n;"merges"===t||"rows"===t||"cols"===t||"validations"===t?i[t].setData(r[t]):"freeze"===t?(e=(n=yt(k(r[t]),2))[0],n=n[1],i.freeze=[n,e]):"autofilter"===t?i.autoFilter.setData(r[t]):void 0!==r[t]&&(i[t]=r[t])}),this}},{key:"getData",value:function(){var t=this.name,e=this.freeze,n=this.styles,r=this.merges,i=this.rows,o=this.cols,a=this.validations,l=this.autoFilter;return{name:t,freeze:O(e[1],e[0]),styles:n,merges:r.getData(),rows:i.getData(),cols:o.getData(),validations:a.getData(),autofilter:l.getData()}}}]),kt);function kt(t,e){!function(t){if(!(t instanceof kt))throw new TypeError("Cannot call a class as a function")}(this),this.settings=V.merge(vt,e||{}),this.name=t||"sheet",this.freeze=[0,0],this.styles=[],this.merges=new H,this.rows=new L(this.settings.row),this.cols=new $(this.settings.col),this.validations=new ft,this.hyperlinks={},this.comments={},this.selector=new u,this.scroll=new p,this.history=new v,this.clipboard=new S,this.autoFilter=new A,this.change=function(){},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map}function Ot(t,e,n){t.addEventListener(e,n)}function St(t,e,n){t.removeEventListener(e,n)}function xt(t){t.xclickoutside&&(St(window.document.body,"click",t.xclickoutside),delete t.xclickoutside)}function Et(e,n){e.xclickoutside=function(t){2===t.detail||e.contains(t.target)||(n?n(e):(e.hide(),xt(e)))},Ot(window.document.body,"click",e.xclickoutside)}function jt(e,n,r){Ot(e,"mousemove",n),e.xEvtUp=function(t){St(e,"mousemove",n),St(e,"mouseup",e.xEvtUp),r(t)},Ot(e,"mouseup",e.xEvtUp)}function _t(t,e,n,r){Math.abs(t)>Math.abs(e)?r(0<t?"right":"left",t,n):r(0<e?"down":"up",e,n)}var Ct="x-spreadsheet";function Tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}window.devicePixelRatio;var Pt=(Tt(At.prototype,[{key:"showUnhide",value:function(t){this.unhideIndex=t,this.unhideHoverEl.show()}},{key:"hideUnhide",value:function(){this.unhideHoverEl.hide()}},{key:"show",value:function(t,e){var n,r,i=this.moving,o=this.vertical,a=this.hoverEl,l=this.lineEl,c=this.el,s=this.unhideHoverEl;i||(n=(this.cRect=t).left,r=t.top,i=t.width,t=t.height,c.offset({left:o?n+i-5:n,top:o?r:r+t-5}).show(),a.offset({width:o?5:i,height:o?t:5}),l.offset({width:o?0:e.width,height:o?e.height:0}),s.offset({left:o?5-i:n,top:o?r:5-t,width:o?5:i,height:o?t:5}))}},{key:"hide",value:function(){this.el.offset({left:0,top:0}).hide(),this.hideUnhide()}},{key:"mousedblclickHandler",value:function(){this.unhideIndex&&this.unhideFn(this.unhideIndex)}},{key:"mousedownHandler",value:function(t){var e=this,n=t,r=this.el,i=this.lineEl,o=this.cRect,a=this.vertical,l=this.minDistance,c=a?o.width:o.height;i.show(),jt(window,function(t){e.moving=!0,null!==n&&1===t.buttons&&(a?(c+=t.movementX)>l&&r.css("left","".concat(o.left+c,"px")):(c+=t.movementY)>l&&r.css("top","".concat(o.top+c,"px")),n=t)},function(){n=null,i.hide(),e.moving=!1,e.hide(),e.finishedFn&&(c<l&&(c=l),e.finishedFn(o,c))})}}]),At);function At(){var e=this,t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=1<arguments.length?arguments[1]:void 0;!function(t){if(!(t instanceof At))throw new TypeError("Cannot call a class as a function")}(this),this.moving=!1,this.vertical=t,this.el=w("div","".concat(Ct,"-resizer ").concat(t?"vertical":"horizontal")).children(this.unhideHoverEl=w("div","".concat(Ct,"-resizer-hover")).on("dblclick.stop",function(t){return e.mousedblclickHandler(t)}).css("position","absolute").hide(),this.hoverEl=w("div","".concat(Ct,"-resizer-hover")).on("mousedown.stop",function(t){return e.mousedownHandler(t)}),this.lineEl=w("div","".concat(Ct,"-resizer-line")).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=n,this.unhideFn=function(){}}function Rt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Dt=(Rt(It.prototype,[{key:"move",value:function(t){return this.el.scroll(t),this}},{key:"scroll",value:function(){return this.el.scroll()}},{key:"set",value:function(t,e){var n=t-1;return n<e?(t=this.vertical?"height":"width",this.el.css(t,"".concat(n-15,"px")).show(),this.contentEl.css(this.vertical?"width":"height","1px").css(t,"".concat(e,"px"))):this.el.hide(),this}}]),It);function It(t){var r=this;!function(t){if(!(t instanceof It))throw new TypeError("Cannot call a class as a function")}(this),this.vertical=t,this.moveFn=null,this.el=w("div","".concat(Ct,"-scrollbar ").concat(t?"vertical":"horizontal")).child(this.contentEl=w("div","")).on("mousemove.stop",function(){}).on("scroll.stop",function(t){var e=t.target,n=e.scrollTop,e=e.scrollLeft;r.moveFn&&r.moveFn(r.vertical?n:e,t)})}function zt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Mt(t,e,n){return e&&Ht(t.prototype,e),n&&Ht(t,n),t}var Nt=10,Ft=(Mt(Wt,[{key:"setOffset",value:function(t){return this.el.offset(t).show(),this}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(t){var e=t.left,n=t.top,n={width:t.width-3+.8,height:t.height-3+.8,left:e-.8,top:n-.8};this.areaEl.offset(n).show(),this.useHideInput&&(this.hideInputDiv.offset(n),this.hideInput.val("").focus())}},{key:"setClipboardOffset",value:function(t){var e=t.left,n=t.top,r=t.width,t=t.height;this.clipboardEl.offset({left:e,top:n,width:r-5,height:t-5})}},{key:"showAutofill",value:function(t){var e=t.left,n=t.top,r=t.width,t=t.height;this.autofillEl.offset({width:r-3,height:t-3,left:e,top:n}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}]),Wt);function Wt(){var e=this,t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];zt(this,Wt),this.useHideInput=t,this.inputChange=function(){},this.cornerEl=w("div","".concat(Ct,"-selector-corner")),this.areaEl=w("div","".concat(Ct,"-selector-area")).child(this.cornerEl).hide(),this.clipboardEl=w("div","".concat(Ct,"-selector-clipboard")).hide(),this.autofillEl=w("div","".concat(Ct,"-selector-autofill")).hide(),this.el=w("div","".concat(Ct,"-selector")).css("z-index","".concat(Nt)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),t&&(this.hideInput=w("input","").on("compositionend",function(t){e.inputChange(t.target.value)}),this.el.child(this.hideInputDiv=w("div","hide-input").child(this.hideInput)),this.el.child(this.hideInputDiv=w("div","hide-input").child(this.hideInput))),Nt+=1}function Vt(t){var e=this.data,n=t.left,r=t.top,i=t.width,o=t.height,a=t.scroll,l=t.l,c=t.t,t=e.freezeTotalWidth(),e=e.freezeTotalHeight(),n=n-t;l<t&&(n-=a.x);r-=e;return c<e&&(r-=a.y),{left:n,top:r,width:i,height:o}}function qt(t){var e=this.data,n=t.left,r=t.width,i=t.height,o=t.l,a=t.t,t=t.scroll,e=e.freezeTotalWidth(),n=n-e;return o<e&&(n-=t.x),{left:n,top:a,width:r,height:i}}function Bt(t){var e=this.data,n=t.top,r=t.width,i=t.height,o=t.l,a=t.t,t=t.scroll,e=e.freezeTotalHeight(),n=n-e;return a<e&&(n-=t.y),{left:o,top:n,width:r,height:i}}function Lt(t){this.br.setAreaOffset(Vt.call(this,t))}function Ut(t){this.t.setAreaOffset(qt.call(this,t))}function Yt(t){this.l.setAreaOffset(Bt.call(this,t))}function $t(t){this.l.setClipboardOffset(Bt.call(this,t))}function Xt(t){this.br.setClipboardOffset(Vt.call(this,t))}function Zt(t){this.t.setClipboardOffset(qt.call(this,t))}function Kt(t){Lt.call(this,t),function(t){this.tl.setAreaOffset(t)}.call(this,t),Ut.call(this,t),Yt.call(this,t)}function Jt(t){Xt.call(this,t),function(t){this.tl.setClipboardOffset(t)}.call(this,t),Zt.call(this,t),$t.call(this,t)}var Gt=(Mt(Qt,[{key:"resetData",value:function(t){this.data=t,this.range=t.selector.range,this.resetAreaOffset()}},{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var t=this.data,e=this.tl,n=this.t,r=this.l,i=this.br,o=t.freezeTotalHeight(),t=t.freezeTotalWidth();0<o||0<t?(e.setOffset({width:t,height:o}),n.setOffset({left:t,height:o}),r.setOffset({top:o,width:t}),i.setOffset({left:t,top:o})):(e.hide(),n.hide(),r.hide(),i.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Kt.call(this,t),Jt.call(this,e),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Lt.call(this,t),Ut.call(this,t),Xt.call(this,e),Zt.call(this,e),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Lt.call(this,t),Yt.call(this,t),Xt.call(this,e),$t.call(this,e),this.resetOffset()}},{key:"set",value:function(t,e){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],r=this.data,i=r.calSelectedRangeByStart(t,e),o=i.sri,a=i.sci;n&&((t=t)<0&&(t=0),(e=e)<0&&(e=0),r.selector.setIndexes(t,e),this.indexes=[t,e]),this.moveIndexes=[o,a],this.range=i,this.resetAreaOffset(),this.el.show()}},{key:"setEnd",value:function(t,e){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],r=this.data,i=this.lastri,o=this.lastci;if(n){if(t===i&&e===o)return;this.lastri=t,this.lastci=e}this.range=r.calSelectedRangeByEnd(t,e),Kt.call(this,this.data.getSelectedRect())}},{key:"reset",value:function(){var t=this.data.selector.range,e=t.eri,t=t.eci;this.setEnd(e,t)}},{key:"showAutofill",value:function(t,e){if(-1!==t||-1!==e){var n=this.range,r=n.sri,i=n.sci,o=n.eri,a=n.eci,l=t,c=e,s=r-t,n=o-t,t=a-e;if(0<i-e)this.arange=new d(r,c,o,i-1);else if(0<s)this.arange=new d(l,i,r-1,a);else if(t<0)this.arange=new d(r,a+1,o,c);else{if(!(n<0))return void(this.arange=null);this.arange=new d(o+1,i,l,a)}null!==this.arange&&((n=this.data.getRect(this.arange)).width+=2,n.height+=2,o=this.br,i=this.l,l=this.t,a=this.tl,o.showAutofill(Vt.call(this,n)),i.showAutofill(Bt.call(this,n)),l.showAutofill(qt.call(this,n)),a.showAutofill(n))}}},{key:"hideAutofill",value:function(){var e=this;["br","l","t","tl"].forEach(function(t){e[t].hideAutofill()})}},{key:"showClipboard",value:function(){var e=this,t=this.data.getClipboardRect();Jt.call(this,t),["br","l","t","tl"].forEach(function(t){e[t].showClipboard()})}},{key:"hideClipboard",value:function(){var e=this;["br","l","t","tl"].forEach(function(t){e[t].hideClipboard()})}}]),Qt);function Qt(t){var e=this;zt(this,Qt),this.inputChange=function(){},this.data=t,this.br=new Ft(!0),this.t=new Ft,this.l=new Ft,this.tl=new Ft,this.br.inputChange=function(t){e.inputChange(t)},this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=w("div","".concat(Ct,"-selectors")).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,Nt+=1}function te(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ee=(te(ne.prototype,[{key:"setOffset",value:function(t){this.el.cssRemoveKeys("top","bottom").offset(t)}},{key:"hide",value:function(){var t=this.el;this.filterItems=[],this.itemIndex=-1,t.hide(),xt(this.el.parent())}},{key:"setItems",value:function(t){this.items=t}},{key:"search",value:function(e){var t,n,r=this,i=this.items;/^\s*$/.test(e)||(i=i.filter(function(t){return(t.key||t).startsWith(e.toUpperCase())})),i=i.map(function(t){var e=t.title;e?"function"==typeof e&&(e=e()):e=t;e=w("div","".concat(Ct,"-item")).child(e).on("click.stop",function(){r.itemClick(t),r.hide()});return t.label&&e.child(w("div","label").html(t.label)),e}),(this.filterItems=i).length<=0||((t=(n=this.el).html("")).children.apply(t,function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(i=i)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()).show(),Et(n.parent(),function(){r.hide()}))}},{key:"bindInputEvents",value:function(t){var e=this;t.on("keydown",function(t){return function(t){var e=t.keyCode;switch(t.ctrlKey&&t.stopPropagation(),e){case 37:t.stopPropagation();break;case 38:(function(t){t.preventDefault(),t.stopPropagation();t=this.filterItems;t.length<=0||(0<=this.itemIndex&&t[this.itemIndex].toggle(),--this.itemIndex,this.itemIndex<0&&(this.itemIndex=t.length-1),t[this.itemIndex].toggle())}).call(this,t);break;case 39:t.stopPropagation();break;case 40:(function(t){t.stopPropagation();t=this.filterItems;t.length<=0||(0<=this.itemIndex&&t[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>t.length-1&&(this.itemIndex=0),t[this.itemIndex].toggle())}).call(this,t);break;case 13:case 9:(function(t){t.preventDefault();var e=this.filterItems;e.length<=0||(t.stopPropagation(),this.itemIndex<0&&(this.itemIndex=0),e[this.itemIndex].el.click(),this.hide())}).call(this,t);break;default:t.stopPropagation()}}.call(e,t)})}}]),ne);function ne(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"200px";!function(t){if(!(t instanceof ne))throw new TypeError("Cannot call a class as a function")}(this),this.filterItems=[],this.items=t,this.el=w("div","".concat(Ct,"-suggest")).css("width",n).hide(),this.itemClick=e,this.itemIndex=-1}function re(t){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ie(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function oe(t){return(oe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ae(t,e){return(ae=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var le=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ae(t,e)}(ce,i),ie(ce.prototype,[{key:"setName",value:function(t){this.iconNameEl.className("".concat(Ct,"-icon-img ").concat(t))}}]),ce);function ce(t){var e,n;return function(t){if(!(t instanceof ce))throw new TypeError("Cannot call a class as a function")}(this),e=this,(n=!(n=oe(ce).call(this,"div","".concat(Ct,"-icon")))||"object"!==re(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e):n).iconNameEl=w("div","".concat(Ct,"-icon-img ").concat(t)),n.child(n.iconNameEl),n}function se(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ue(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fe(t,e){t.setMonth(t.getMonth()+e)}var he=(ue(pe.prototype,[{key:"setValue",value:function(t){this.value=t,this.cvalue=new Date(t),this.buildAll()}},{key:"prev",value:function(){fe(this.value,-1),this.buildAll()}},{key:"next",value:function(){fe(this.value,1),this.buildAll()}},{key:"buildAll",value:function(){this.buildHeaderLeft(),this.buildBody()}},{key:"buildHeaderLeft",value:function(){var t=this.value;this.headerLeftEl.html("".concat(G("calendar.months")[t.getMonth()]," ").concat(t.getFullYear()))}},{key:"buildBody",value:function(){var n=this,t=this.value,e=this.cvalue,r=this.bodyEl,e=function(t,e,n){for(var r=new Date(t,e,1,23,59,59),i=[[],[],[],[],[],[]],o=0;o<6;o+=1)for(var a=0;a<7;a+=1){var l=(c=r,l=7*o+a,s=void 0,(s=new Date(c)).setDate(l-c.getDay()+1),s),c=l.getMonth()!==e,s=l.getMonth()===n.getMonth()&&l.getDate()===n.getDate();i[o][a]={d:l,disabled:c,active:s}}return i}(t.getFullYear(),t.getMonth(),e).map(function(t){var e=t.map(function(t){var e="cell";return t.disabled&&(e+=" disabled"),t.active&&(e+=" active"),w("td","").child(w("div",e).on("click.stop",function(){n.selectChange(t.d)}).child(t.d.getDate().toString()))});return(t=w("tr","")).children.apply(t,se(e))});(r=r.html("")).children.apply(r,se(e))}}]),pe);function pe(t){var e=this;!function(t){if(!(t instanceof pe))throw new TypeError("Cannot call a class as a function")}(this),this.value=t,this.cvalue=new Date(t),this.headerLeftEl=w("div","calendar-header-left"),this.bodyEl=w("tbody",""),this.buildAll(),this.el=w("div","x-spreadsheet-calendar").children(w("div","calendar-header").children(this.headerLeftEl,w("div","calendar-header-right").children(w("a","calendar-prev").on("click.stop",function(){return e.prev()}).child(new le("chevron-left")),w("a","calendar-next").on("click.stop",function(){return e.next()}).child(new le("chevron-right")))),w("table","calendar-body").children(w("thead","").child((t=w("tr","")).children.apply(t,se(G("calendar.weeks").map(function(t){return w("th","cell").child(t)})))),this.bodyEl)),this.selectChange=function(){}}function de(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ye=(de(ve.prototype,[{key:"setValue",value:function(t){var e=this.calendar;return"string"==typeof t?/^\d{4}-\d{1,2}-\d{1,2}$/.test(t)&&e.setValue(new Date(t.replace(new RegExp("-","g"),"/"))):t instanceof Date&&e.setValue(t),this}},{key:"change",value:function(e){var n=this;this.calendar.selectChange=function(t){e(t),n.hide()}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}]),ve);function ve(){!function(t){if(!(t instanceof ve))throw new TypeError("Cannot call a class as a function")}(this),this.calendar=new he(new Date),this.el=w("div","".concat(Ct,"-datepicker")).child(this.calendar.el).hide()}function be(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ge(){var t,e,n,r,i,o=this.inputText;/^\s*$/.test(o)||(n=this.textlineEl,t=this.textEl,e=this.areaOffset,r=o.split("\n"),n=(Math.max.apply(Math,function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(i=r.map(function(t){return t.length}))||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}())+1)*(i=n.offset().width/o.length)+5,o=this.viewFn().width-e.left-i,i=r.length,n>e.width&&(o<(r=n)&&(r=o,i+=parseInt(n/o,10),i+=0<n%o?1:0),t.css("width","".concat(r,"px"))),(i*=this.rowHeight)>e.height&&t.css("height","".concat(i,"px")))}function me(t,e){var n=this.textEl,r=this.textlineEl;n.el.blur(),n.val(t),r.html(t),function(t){var e=this.textEl.el;setTimeout(function(){e.focus(),e.setSelectionRange(t,t)},0)}.call(this,e)}var we=(be(ke.prototype,[{key:"setFreezeLengths",value:function(t,e){this.freeze.w=t,this.freeze.h=e}},{key:"clear",value:function(){""!==this.inputText&&this.change("finished",this.inputText),this.cell=null,this.areaOffset=null,this.inputText="",this.el.hide(),this.textEl.val(""),this.textlineEl.html(""),function(){this.suggest.setItems(this.formulas)}.call(this),this.datepicker.hide()}},{key:"setOffset",value:function(t){var e,n,r,i,o,a,l=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"top",c=this.textEl,s=this.areaEl,u=this.suggest,f=this.freeze,h=this.el;t&&(e=(this.areaOffset=t).left,n=t.top,a=t.width,r=t.height,i=t.l,o=t.t,t={left:0,top:0},f.w>i&&f.h>o||(f.w<i&&f.h<o?(t.left=f.w,t.top=f.h):f.w>i?t.top=f.h:f.h>o&&(t.left=f.w)),h.offset(t),s.offset({left:e-t.left-.8,top:n-t.top-.8}),c.offset({width:a-9+.8,height:r-3+.8}),(a={left:0})[l]=r,u.setOffset(a),u.hide())}},{key:"setCell",value:function(t,e){var n=this.el,r=this.datepicker,i=this.suggest;n.show();n=(this.cell=t)&&t.text||"";this.setText(n),(this.validator=e)&&("date"===(t=e.type)&&(r.show(),/^\s*$/.test(n)||r.setValue(n)),"list"===t&&(i.setItems(e.values()),i.search("")))}},{key:"setText",value:function(t){this.inputText=t,me.call(this,t,t.length),ge.call(this)}}]),ke);function ke(t,e,n){var r=this;!function(t){if(!(t instanceof ke))throw new TypeError("Cannot call a class as a function")}(this),this.viewFn=e,this.rowHeight=n,this.formulas=t,this.suggest=new ee(t,function(t){(function(t){var e,n=this.inputText,r=this.validator,i=0;r&&"list"===r.type?(this.inputText=t,i=this.inputText.length):(e=n.lastIndexOf("="),r=n.substring(0,e+1),e=-1!==(e=n.substring(e+1)).indexOf(")")?e.substring(e.indexOf(")")):"",this.inputText="".concat(r+t.key,"("),i=this.inputText.length,this.inputText+=")".concat(e)),me.call(this,this.inputText,i)}).call(r,t)}),this.datepicker=new ye,this.datepicker.change(function(t){var e,n;r.setText((n=(e=t).getMonth()+1,t=e.getDate(),n<10&&(n="0".concat(n)),t<10&&(t="0".concat(t)),"".concat(e.getFullYear(),"-").concat(n,"-").concat(t))),r.clear()}),this.areaEl=w("div","".concat(Ct,"-editor-area")).children(this.textEl=w("textarea","").on("input",function(t){return function(t){var e,n=t.target.value,r=this.suggest,i=this.textlineEl,o=this.validator,a=this.cell;null!==a?"editable"in a&&!0===a.editable||void 0===a.editable?(this.inputText=n,o?"list"===o.type?r.search(n):r.hide():-1!==(e=n.lastIndexOf("="))?r.search(n.substring(e+1)):r.hide(),i.html(n),ge.call(this),this.change("input",n)):t.target.value=a.text:(this.inputText=n,o?"list"===o.type?r.search(n):r.hide():-1!==(o=n.lastIndexOf("="))?r.search(n.substring(o+1)):r.hide(),i.html(n),ge.call(this),this.change("input",n))}.call(r,t)}).on("paste.stop",function(){}).on("keydown",function(t){return function(t){var e=t.keyCode,n=t.altKey;13!==e&&9!==e&&t.stopPropagation(),13===e&&n&&(function(t,e){var n=t.target,r=n.value,t=n.selectionEnd,r="".concat(r.slice(0,t)).concat(e).concat(r.slice(t));n.value=r,n.setSelectionRange(t+1,t+1),this.inputText=r,this.textlineEl.html(r),ge.call(this)}.call(this,t,"\n"),t.stopPropagation()),13!==e||n||t.preventDefault()}.call(r,t)}),this.textlineEl=w("div","textline"),this.suggest.el,this.datepicker.el).on("mousemove.stop",function(){}).on("mousedown.stop",function(){}),this.el=w("div","".concat(Ct,"-editor")).child(this.areaEl).hide(),this.suggest.bindInputEvents(this.textEl),this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,this.inputText="",this.change=function(){}}function Oe(t){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Se(t){return(Se=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xe(t,e){return(xe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ee=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xe(t,e)}(je,i),je);function je(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";return function(t){if(!(t instanceof je))throw new TypeError("Cannot call a class as a function")}(this),e=this,(n=!(n=Se(je).call(this,"div","".concat(Ct,"-button ").concat(n)))||"object"!==Oe(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e):n).child(G("button.".concat(t))),n}function _e(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ce(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Te(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Pe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ae(t,e,n){return e&&Pe(t.prototype,e),n&&Pe(t,n),t}function Re(){return window.devicePixelRatio||1}function De(){return Re()-.5}function Ie(t){return parseInt(t*Re(),10)}function ze(t){t=Ie(t);return 0<t?t-.5:.5}var He=(Ae(Me,[{key:"setBorders",value:function(t){var e=t.top,n=t.bottom,r=t.left,t=t.right;e&&(this.borderTop=e),t&&(this.borderRight=t),n&&(this.borderBottom=n),r&&(this.borderLeft=r)}},{key:"innerWidth",value:function(){return this.width-2*this.padding-2}},{key:"innerHeight",value:function(){return this.height-2*this.padding-2}},{key:"textx",value:function(t){var e=this.width,n=this.padding,r=this.x;return"left"===t?r+=n:"center"===t?r+=e/2:"right"===t&&(r+=e-n),r}},{key:"texty",value:function(t,e){var n=this.height,r=this.padding,i=this.y;return"top"===t?i+=r:"middle"===t?i+=n/2-e/2:"bottom"===t&&(i+=n-r-e),i}},{key:"topxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t+this.width,e]]}},{key:"rightxys",value:function(){var t=this.x,e=this.y,n=this.width;return[[t+n,e],[t+n,e+this.height]]}},{key:"bottomxys",value:function(){var t=this.x,e=this.y,n=this.width,r=this.height;return[[t,e+r],[t+n,e+r]]}},{key:"leftxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t,e+this.height]]}}]),Me);function Me(t,e,n,r){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0;Te(this,Me),this.x=t,this.y=e,this.width=n,this.height=r,this.padding=i,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}function Ne(t,e,n,r,i,o,a){var l={x:0,y:0};"underline"===t?l.y="bottom"===i?0:"top"===i?-(o+2):-o/2:"strike"===t&&("bottom"===i?l.y=o/2:"top"===i&&(l.y=-(o/2+2))),"center"===r?l.x=a/2:"right"===r&&(l.x=a),this.line([e-l.x,n-l.y],[e-l.x+a,n-l.y])}var Fe=(Ae(qe,[{key:"resize",value:function(t,e){this.el.style.width="".concat(t,"px"),this.el.style.height="".concat(e,"px"),this.el.width=Ie(t),this.el.height=Ie(e)}},{key:"clear",value:function(){var t=this.el,e=t.width,t=t.height;return this.ctx.clearRect(0,0,e,t),this}},{key:"attr",value:function(t){return Object.assign(this.ctx,t),this}},{key:"save",value:function(){return this.ctx.save(),this.ctx.beginPath(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"translate",value:function(t,e){return this.ctx.translate(Ie(t),Ie(e)),this}},{key:"scale",value:function(t,e){return this.ctx.scale(t,e),this}},{key:"clearRect",value:function(t,e,n,r){return this.ctx.clearRect(t,e,n,r),this}},{key:"fillRect",value:function(t,e,n,r){return this.ctx.fillRect(Ie(t)-.5,Ie(e)-.5,Ie(n),Ie(r)),this}},{key:"fillText",value:function(t,e,n){return this.ctx.fillText(t,Ie(e),Ie(n)),this}},{key:"text",value:function(t,e){var n=this,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],o=this.ctx,a=r.align,l=r.valign,c=r.font,s=r.color,u=r.strike,f=r.underline,h=e.textx(a);o.save(),o.beginPath(),this.attr({textAlign:a,textBaseline:l,font:"".concat(c.italic?"italic":""," ").concat(c.bold?"bold":""," ").concat(Ie(c.size),"px ").concat(c.name),fillStyle:s,strokeStyle:s});var t="".concat(t).split("\n"),p=e.innerWidth(),d=[];t.forEach(function(t){var e=o.measureText(t).width;if(i&&e>Ie(p)){for(var n={w:0,len:0,start:0},r=0;r<t.length;r+=1)n.w>=Ie(p)&&(d.push(t.substr(n.start,n.len)),n={w:0,len:0,start:r}),n.len+=1,n.w+=o.measureText(t[r]).width+1;0<n.len&&d.push(t.substr(n.start,n.len))}else d.push(t)});var t=(d.length-1)*(c.size+2),y=e.texty(l,t);return d.forEach(function(t){var e=o.measureText(t).width;n.fillText(t,h,y),u&&Ne.call(n,"strike",h,y,a,l,c.size,e),f&&Ne.call(n,"underline",h,y,a,l,c.size,e),y+=c.size+2}),o.restore(),this}},{key:"border",value:function(t,e){var n=this.ctx;return n.lineWidth=De,n.strokeStyle=e,"medium"===t?n.lineWidth=Ie(2)-.5:"thick"===t?n.lineWidth=Ie(3):"dashed"===t?n.setLineDash([Ie(3),Ie(2)]):"dotted"===t?n.setLineDash([Ie(1),Ie(1)]):"double"===t&&n.setLineDash([Ie(2),0]),this}},{key:"line",value:function(){var t=this.ctx;if(1<arguments.length){t.beginPath();var e=Ce(arguments.length<=0?void 0:arguments[0],2),n=e[0],e=e[1];t.moveTo(ze(n),ze(e));for(var r=1;r<arguments.length;r+=1){var i=Ce(r<0||arguments.length<=r?void 0:arguments[r],2),o=i[0],i=i[1];t.lineTo(ze(o),ze(i))}t.stroke()}return this}},{key:"strokeBorders",value:function(t){var e=this.ctx;e.save();var n=t.borderTop,r=t.borderRight,i=t.borderBottom,o=t.borderLeft;n&&(this.border.apply(this,_e(n)),this.line.apply(this,_e(t.topxys()))),r&&(this.border.apply(this,_e(r)),this.line.apply(this,_e(t.rightxys()))),i&&(this.border.apply(this,_e(i)),this.line.apply(this,_e(t.bottomxys()))),o&&(this.border.apply(this,_e(o)),this.line.apply(this,_e(t.leftxys()))),e.restore()}},{key:"dropdown",value:function(t){var e=this.ctx,n=t.x,r=t.y,n=n+t.width-15,t=r+t.height-15;e.save(),e.beginPath(),e.moveTo(Ie(n),Ie(t)),e.lineTo(Ie(8+n),Ie(t)),e.lineTo(Ie(4+n),Ie(6+t)),e.closePath(),e.fillStyle="rgba(0, 0, 0, .45)",e.fill(),e.restore()}},{key:"error",value:function(t){var e=this.ctx,n=t.x,r=t.y,t=n+t.width-1;e.save(),e.beginPath(),e.moveTo(Ie(t-8),Ie(r-1)),e.lineTo(Ie(t),Ie(r-1)),e.lineTo(Ie(t),Ie(r+8)),e.closePath(),e.fillStyle="rgba(255, 0, 0, .65)",e.fill(),e.restore()}},{key:"frozen",value:function(t){var e=this.ctx,n=t.x,r=t.y,t=n+t.width-1;e.save(),e.beginPath(),e.moveTo(Ie(t-8),Ie(r-1)),e.lineTo(Ie(t),Ie(r-1)),e.lineTo(Ie(t),Ie(r+8)),e.closePath(),e.fillStyle="rgba(0, 255, 0, .85)",e.fill(),e.restore()}},{key:"rect",value:function(t,e){var n=this.ctx,r=t.x,i=t.y,o=t.width,a=t.height,t=t.bgcolor;n.save(),n.beginPath(),n.fillStyle=t||"#fff",n.rect(ze(r+1),ze(i+1),Ie(o-2),Ie(a-2)),n.clip(),n.fill(),e(),n.restore()}}]),qe),We=[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}],Ve=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];function qe(t,e,n){Te(this,qe),this.el=t,this.ctx=t.getContext("2d"),this.resize(e,n),this.ctx.scale(Re(),Re())}function Be(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Le(t,e,n,r){for(var i=[],o=0;o<t.length;o+=1){var a,l=t[o],c=l[0];if("+"===l){var s=i.pop();i.push(W("+",i.pop(),s))}else if("-"===l)1===i.length?(a=i.pop(),i.push(W("*",a,-1))):(a=i.pop(),i.push(W("-",i.pop(),a)));else if("*"===l)i.push(W("*",i.pop(),i.pop()));else if("/"===l){var u=i.pop();i.push(W("/",i.pop(),u))}else if("="===c||">"===c||"<"===c){var f=i.pop();Number.isNaN(f)||(f=Number(f));u=i.pop();Number.isNaN(u)||(u=Number(u));var h=!1;"="===c?h=u===f:">"===l?h=f<u:">="===l?h=f<=u:"<"===l?h=u<f:"<="===l&&(h=u<=f),i.push(h)}else if(Array.isArray(l)){for(var f=Be(l,2),h=f[0],p=f[1],d=[],y=0;y<p;y+=1)d.push(i.pop());i.push(e[h].render(d.reverse()))}else{if(r.includes(l))return 0;("a"<=c&&c<="z"||"A"<=c&&c<="Z")&&r.push(l),i.push(function(t,e){var n=Be(t,1)[0],r=t;if('"'===n)return t.substring(1);var i=1;if("-"===n&&(r=t.substring(1),i=-1),"0"<=r[0]&&r[0]<="9")return i*Number(r);r=Be(k(r),2);return i*e(r[0],r[1])}(l,n)),r.pop()}}return i[0]}var Ue={render:function n(t,r,i){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[];if("="!==t[0])return t;var e=function(t){for(var e=[],n=[],r=[],i=0,o="",a=1,l="",c=0;c<t.length;c+=1){var s=t.charAt(c);if(" "!==s){if("a"<=s&&s<="z")r.push(s.toUpperCase());else if("0"<=s&&s<="9"||"A"<=s&&s<="Z"||"."===s)r.push(s);else if('"'===s){for(c+=1;'"'!==t.charAt(c);)r.push(t.charAt(c)),c+=1;n.push('"'.concat(r.join(""))),r=[]}else if("-"===s&&/[+\-*\/,(]/.test(l))r.push(s);else{if("("!==s&&0<r.length&&n.push(r.join("")),")"===s){var u=e.pop();if(2===i)try{for(var f=Be(k(n.pop()),2),h=f[0],p=f[1],d=Be(k(n.pop()),2),f=d[0],y=d[1],v=0,b=f;b<=h;b+=1)for(var g=y;g<=p;g+=1)n.push(O(b,g)),v+=1;n.push([u,v])}catch(t){}else if(1===i||3===i)3===i&&n.push(o),n.push([u,a]),a=1;else for(;"("!==u&&(n.push(u),!(e.length<=0));)u=e.pop();i=0}else if("="===s||">"===s||"<"===s){var m=t.charAt(c+1),o=s;"="!==m&&"-"!==m||(o+=m,c+=1),i=3}else if(":"===s)i=2;else if(","===s)3===i&&n.push(o),a+=i=1;else if("("===s&&0<r.length)e.push(r.join(""));else{if(0<e.length&&("+"===s||"-"===s)){var w=e[e.length-1];if("("!==w&&n.push(e.pop()),"*"===w||"/"===w)for(;0<e.length&&"("!==(w=e[e.length-1]);)n.push(e.pop())}else 0<e.length&&("*"!==(m=e[e.length-1])&&"/"!==m||n.push(e.pop()));e.push(s)}r=[]}l=s}}for(0<r.length&&n.push(r.join(""));0<e.length;)n.push(e.pop());return n}(t.substring(1));return e.length<=0?t:Le(e,r,function(t,e){return n(i(t,e),r,i,o)},o)}};function Ye(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var $e=[{key:"SUM",title:Q("formula.sum"),render:function(t){return t.reduce(function(t,e){return W("+",t,e)},0)}},{key:"AVERAGE",title:Q("formula.average"),render:function(t){return t.reduce(function(t,e){return Number(t)+Number(e)},0)/t.length}},{key:"MAX",title:Q("formula.max"),render:function(t){return Math.max.apply(Math,Ye(t.map(function(t){return Number(t)})))}},{key:"MIN",title:Q("formula.min"),render:function(t){return Math.min.apply(Math,Ye(t.map(function(t){return Number(t)})))}},{key:"IF",title:Q("formula._if"),render:function(t){var e,n,t=(n=3,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()),e=t[0],n=t[1],t=t[2];return e?n:t}},{key:"AND",title:Q("formula.and"),render:function(t){return t.every(function(t){return t})}},{key:"OR",title:Q("formula.or"),render:function(t){return t.some(function(t){return t})}},{key:"CONCAT",title:Q("formula.concat"),render:function(t){return t.join("")}}],Xe=$e,Ze={};function Ke(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}$e.forEach(function(t){Ze[t.key]=t});function Je(t){if(/^(-?\d*.?\d*)$/.test(t)){var e=function(t){if(Array.isArray(t))return t}(n=Number(t).toFixed(2).toString().split("\\."))||Ke(n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}(),n=e[0],e=e.slice(1);return[n.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")].concat(function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(e=e)||Ke(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}())}var n;return t}var Ge=function(t){return t},Qe=[{key:"normal",title:Q("format.normal"),type:"string",render:Ge},{key:"text",title:Q("format.text"),type:"string",render:Ge},{key:"number",title:Q("format.number"),type:"number",label:"1,000.12",render:Je},{key:"percent",title:Q("format.percent"),type:"number",label:"10.12%",render:function(t){return"".concat(t,"%")}},{key:"rmb",title:Q("format.rmb"),type:"number",label:"10.00",render:function(t){return"".concat(Je(t))}},{key:"usd",title:Q("format.usd"),type:"number",label:"$10.00",render:function(t){return"$".concat(Je(t))}},{key:"eur",title:Q("format.eur"),type:"number",label:"10.00",render:function(t){return"".concat(Je(t))}},{key:"date",title:Q("format.date"),type:"date",label:"26/09/2008",render:Ge},{key:"time",title:Q("format.time"),type:"date",label:"15:59:00",render:Ge},{key:"datetime",title:Q("format.datetime"),type:"date",label:"26/09/2008 15:59:00",render:Ge},{key:"duration",title:Q("format.duration"),type:"date",label:"24:01:00",render:Ge}],tn={};function en(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Qe.forEach(function(t){tn[t.key]=t});var nn=5,rn={fillStyle:"#f4f5f8"},on={fillStyle:"#fff",lineWidth:De,strokeStyle:"#e6e6e6"};function an(t,e,n,r){var i=3<arguments.length&&void 0!==r?r:0,r=t.cellRect(e,n),t=r.left,e=r.top,n=r.width,r=r.height;return new He(t,e+i,n,r,nn)}function ln(n,r,i,o,t){var a,l,c,s,e=4<arguments.length&&void 0!==t?t:0,u=r.sortedRowMap,f=r.rows,t=r.cols;f.isHide(i)||t.isHide(o)||(t=i,u.has(i)&&(t=u.get(i)),null!==(a=r.getCell(t,o))&&(l=!1,"editable"in a&&!1===a.editable&&(l=!0),c=r.getCellStyleOrDefault(t,o),(s=an(r,i,o,e)).bgcolor=c.bgcolor,void 0!==c.border&&(s.setBorders(c.border),n.strokeBorders(s)),n.rect(s,function(){var t="",t=r.settings.evalPaused?a.text||"":Ue.render(a.text||"",Ze,function(t,e){return r.getCellTextOrDefault(e,t)});c.format&&(t=tn[c.format].render(t));var e=Object.assign({},c.font);e.size=function(t){for(var e=0;e<Ve.length;e+=1){var n=Ve[e];if(n.pt===t)return n.px}return t}(e.size),n.text(t,s,{align:c.align,valign:c.valign,font:e,color:c.color,strike:c.strike,underline:c.underline},c.textwrap),r.validations.getError(i,o)&&n.error(s),l&&n.frozen(s)})))}function cn(t,e,n,r,i){var o=this.draw,a=this.data;o.save(),o.translate(e,n).translate(r,i);var l=a.exceptRowSet,i=a.exceptRowTotalHeight(t.sri,t.eri);o.save(),o.translate(0,-i),t.each(function(t,e){ln(o,a,t,e)},function(t){return e=t,(t=l.has(e))&&(e=a.rows.getHeight(e),o.translate(0,-e)),!t;var e}),o.restore();var c=new Set;o.save(),o.translate(0,-i),a.eachMergesInView(t,function(t){var e=t.sri,n=t.sci,t=t.eri;l.has(e)?c.has(e)||(c.add(e),t=a.rows.sumHeight(e,t+1),o.translate(0,-t)):ln(o,a,e,n)}),o.restore(),function(t){var e,n=this.data,r=this.draw;!t||(e=n.autoFilter).active()&&(e=e.hrange(),t.intersects(e)&&e.each(function(t,e){e=an(n,t,e);r.dropdown(e)}))}.call(this,t),o.restore()}function sn(t,e,n,r){var i=this.draw;i.save(),i.attr({fillStyle:"rgba(75, 137, 255, 0.08)"}).fillRect(t,e,n,r),i.restore()}function un(t,e,i,o,n,r){var a=this,l=this.draw,c=this.data,s=e.h,u=e.w,f=r+o,h=n+i;l.save(),l.attr(rn),"all"!==t&&"left"!==t||l.fillRect(0,f,i,s),"all"!==t&&"top"!==t||l.fillRect(h,0,u,o);var n=c.selector.range,p=n.sri,d=n.sci,y=n.eri,v=n.eci;l.attr({textAlign:"center",textBaseline:"middle",font:"500 ".concat(Ie(12),"px Source Sans Pro"),fillStyle:"#585757",lineWidth:De(),strokeStyle:"#e6e6e6"}),"all"!==t&&"left"!==t||(c.rowEach(e.sri,e.eri,function(t,e,n){var r=f+e,e=t;l.line([0,r],[i,r]),p<=e&&e<y+1&&sn.call(a,0,r,i,n),l.fillText(e+1,i/2,r+n/2),0<t&&c.rows.isHide(t-1)&&(l.save(),l.attr({strokeStyle:"#c6c6c6"}),l.line([5,r+5],[i-5,r+5]),l.restore())}),l.line([0,s+f],[i,s+f]),l.line([i,f],[i,s+f])),"all"!==t&&"top"!==t||(c.colEach(e.sci,e.eci,function(t,e,n){var r=h+e,e=t;l.line([r,0],[r,o]),d<=e&&e<v+1&&sn.call(a,r,0,n,o),l.fillText(b(e),r+n/2,o/2),0<t&&c.cols.isHide(t-1)&&(l.save(),l.attr({strokeStyle:"#c6c6c6"}),l.line([r+5,5],[r+5,o-5]),l.restore())}),l.line([u+h,0],[u+h,o]),l.line([0,o],[u+h,o])),l.restore()}function fn(t,e,n,r,i){var o=t.sri,a=t.sci,l=t.eri,c=t.eci,s=t.w,u=t.h,f=this.draw,h=this.data,t=h.settings;f.save(),f.attr(on).translate(e+r,n+i),t.showGrid&&(h.rowEach(o,l,function(t,e,n){t!==o&&f.line([0,e],[s,e]),t===l&&f.line([0,e+n],[s,e+n])}),h.colEach(a,c,function(t,e,n){t!==a&&f.line([e,0],[e,u]),t===c&&f.line([e+n,0],[e+n,u])})),f.restore()}var hn=(en(pn.prototype,[{key:"resetData",value:function(t){this.data=t,this.render()}},{key:"render",value:function(){var t=this.data,e=t.rows,n=t.cols.indexWidth,r=e.height;this.draw.resize(t.viewWidth(),t.viewHeight()),this.clear();var i=t.viewRange(),o=t.freezeTotalWidth(),a=t.freezeTotalHeight(),l=t.scroll,c=l.x,s=l.y;fn.call(this,i,n,r,o,a),cn.call(this,i,n,r,-c,-s),un.call(this,"all",i,n,r,o,a),function(t,e){var n=this.draw;n.save(),n.attr({fillStyle:"#f4f5f8"}).fillRect(0,0,t,e),n.restore()}.call(this,n,r);var u,l=(u=t.freeze,e=2,function(t){if(Array.isArray(t))return t}(u)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(u,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()),u=l[0],e=l[1];(0<u||0<e)&&(0<u&&((l=i.clone()).sri=0,l.eri=u-1,l.h=a,fn.call(this,l,n,r,o,0),cn.call(this,l,n,r,-c,0),un.call(this,"top",l,n,r,o,0)),0<e&&((i=i.clone()).sci=0,i.eci=e-1,i.w=o,fn.call(this,i,n,r,0,a),un.call(this,"left",i,n,r,0,a),cn.call(this,i,n,r,0,-s)),t=t.freezeViewRange(),fn.call(this,t,n,r,0,0),un.call(this,"all",t,n,r,0,0),cn.call(this,t,n,r,0,0),function(t,e,n,r){var i=this.draw,o=this.data,a=o.viewWidth()-t,o=o.viewHeight()-e;i.save().translate(t,e).attr({strokeStyle:"rgba(75, 137, 255, .6)"}),i.line([0,r],[a,r]),i.line([n,0],[n,o]),i.restore()}.call(this,n,r,o,a))}},{key:"clear",value:function(){this.draw.clear()}}]),pn);function pn(t,e){!function(t){if(!(t instanceof pn))throw new TypeError("Cannot call a class as a function")}(this),this.el=t,this.draw=new Fe(t,e.viewWidth(),e.viewHeight()),this.data=e}function dn(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function yn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var vn=[["A3",11.69,16.54],["A4",8.27,11.69],["A5",5.83,8.27],["B4",9.84,13.9],["B5",6.93,9.84]],bn=["landscape","portrait"];function gn(t){return parseInt(96*t,10)}function mn(t){"cancel"===t?this.el.hide():this.toPrint()}var wn=(yn(kn.prototype,[{key:"resetData",value:function(t){this.data=t}},{key:"preview",value:function(){var c=this,s=this.data,t=this.paper,u=t.width,f=t.height,e=t.padding,t=u-2*e,h=f-2*e,p=s.contentRange(),n=parseInt(p.h/h,10)+1,d=t/p.w,y=e,v=e;1<d&&(y+=(t-p.w)/2);var b=0,g=0;this.contentEl.html(""),this.canvases=[];for(var m={sri:0,sci:0,eri:0,eci:0},r=0;r<n;r+=1)!function(){var t=0,e=0,n=w("div","".concat(Ct,"-canvas-card")),r=w("canvas","".concat(Ct,"-canvas"));c.canvases.push(r.el);var i=new Fe(r.el,u,f);for(i.save(),i.translate(y,v),d<1&&i.scale(d,d);b<=p.eri;b+=1){var o=s.rows.getHeight(b);if(!((t+=o)<h)){e=-(t-o);break}for(var a=0;a<=p.eci;a+=1)ln(i,s,b,a,g),m.eci=a}m.eri=b,i.restore(),i.save(),i.translate(y,v),d<1&&i.scale(d,d);var l=g;s.eachMergesInView(m,function(t){var e=t.sri,t=t.sci;ln(i,s,e,t,l)}),i.restore(),m.sri=m.eri,m.sci=m.eci,g+=e,c.contentEl.child(w("div","".concat(Ct,"-canvas-card-wraper")).child(n.child(r)))}();this.el.show()}},{key:"toPrint",value:function(){this.el.hide();var t=this.paper,e=w("iframe","").hide().el;window.document.body.appendChild(e);var n=e.contentWindow,r=n.document,e=document.createElement("style");e.innerHTML="\n      @page { size: ".concat(t.width,"px ").concat(t.height,"px; };\n      canvas {\n        page-break-before: auto;        \n        page-break-after: always;\n        image-rendering: pixelated;\n      };\n    "),r.head.appendChild(e),this.canvases.forEach(function(t){var e=t.cloneNode(!1);e.getContext("2d").drawImage(t,0,0),r.body.appendChild(e)}),n.print()}}]),kn);function kn(t){!function(t){if(!(t instanceof kn))throw new TypeError("Cannot call a class as a function")}(this),this.paper={w:gn(vn[0][1]),h:gn(vn[0][2]),padding:50,orientation:bn[0],get width(){return"landscape"===this.orientation?this.h:this.w},get height(){return"landscape"===this.orientation?this.w:this.h}},this.data=t,this.el=w("div","".concat(Ct,"-print")).children(w("div","".concat(Ct,"-print-bar")).children(w("div","-title").child("Print settings"),w("div","-right").children(w("div","".concat(Ct,"-buttons")).children(new Ee("cancel").on("click",mn.bind(this,"cancel")),new Ee("next","primary").on("click",mn.bind(this,"next"))))),w("div","".concat(Ct,"-print-content")).children(this.contentEl=w("div","-content"),w("div","-sider").child(w("form","").children(w("fieldset","").children(w("label","").child("".concat(G("print.size"))),(t=w("select","")).children.apply(t,dn(vn.map(function(t,e){return w("option","").attr("value",e).child("".concat(t[0]," ( ").concat(t[1],"''x").concat(t[2],"'' )"))}))).on("change",function(t){var e=this.paper,t=t.target.value,t=vn[t];e.w=gn(t[1]),e.h=gn(t[2]),this.preview()}.bind(this))),w("fieldset","").children(w("label","").child("".concat(G("print.orientation"))),(t=w("select","")).children.apply(t,dn(bn.map(function(t,e){return w("option","").attr("value",e).child("".concat(G("print.orientations")[e]))}))).on("change",function(t){var e=this.paper,t=t.target.value,t=bn[t];e.orientation=t,this.preview()}.bind(this))))))).hide()}function On(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Sn=[{key:"copy",title:Q("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:Q("contextmenu.cut"),label:"Ctrl+X"},{key:"divider"},{key:"insert-row",title:Q("contextmenu.insertRow")},{key:"insert-column",title:Q("contextmenu.insertColumn")},{key:"divider"},{key:"delete-row",title:Q("contextmenu.deleteRow")},{key:"delete-column",title:Q("contextmenu.deleteColumn")},{key:"delete-cell-text",title:Q("contextmenu.deleteCellText")},{key:"hide",title:Q("contextmenu.hide")},{key:"divider"},{key:"validation",title:Q("contextmenu.validation")},{key:"divider"}];var xn=(On(En.prototype,[{key:"setMode",value:function(t){var e=this.menuItems[12];"row-col"===t?e.show():e.hide()}},{key:"hide",value:function(){var t=this.el;t.hide(),xt(t)}},{key:"setPosition",value:function(t,e){var n,r,i,o,a;this.isHide||(r=(n=this.el).show().offset().width,o=(i=this.viewFn()).height/2,a=t,i.width-t<=r&&(a-=r),n.css("left","".concat(a,"px")),o<e?n.css("bottom","".concat(i.height-e,"px")).css("max-height","".concat(e,"px")).css("top","auto"):n.css("top","".concat(e,"px")).css("max-height","".concat(i.height-e,"px")).css("bottom","auto"),Et(n))}}]),En);function En(t){var e,n=1<arguments.length&&void 0!==arguments[1]&&arguments[1];!function(t){if(!(t instanceof En))throw new TypeError("Cannot call a class as a function")}(this),this.menuItems=function(){var e=this;return Sn.map(function(t){return function(t){var e=this;return"divider"===t.key?w("div","".concat(Ct,"-item divider")):w("div","".concat(Ct,"-item")).on("click",function(){e.itemClick(t.key),e.hide()}).children(t.title(),w("div","label").child(t.label||""))}.call(e,t)})}.call(this),this.el=(e=w("div","".concat(Ct,"-contextmenu"))).children.apply(e,function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(e=this.menuItems)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()).hide(),this.viewFn=t,this.itemClick=function(){},this.isHide=n,this.setMode("range")}function jn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var _n=(jn(Cn.prototype,[{key:"element",value:function(){var l=this,t=this.tip;return w("div","".concat(Ct,"-toolbar-btn")).on("mouseenter",function(t){var e,n,r,i,o,a;l.tip&&(e=l.tip,(n=t.target).classList.contains("active")||(r=(o=n.getBoundingClientRect()).left,i=o.top,t=o.width,o=o.height,a=w("div","".concat(Ct,"-tooltip")).html(e).show(),document.body.appendChild(a.el),e=a.box(),a.css("left","".concat(r+t/2-e.width/2,"px")).css("top","".concat(i+o+2,"px")),Ot(n,"mouseleave",function(){document.body.contains(a.el)&&document.body.removeChild(a.el)}),Ot(n,"click",function(){document.body.contains(a.el)&&document.body.removeChild(a.el)})))}).attr("data-tooltip",t)}},{key:"setState",value:function(){}}]),Cn);function Cn(t,e,n){!function(t){if(!(t instanceof Cn))throw new TypeError("Cannot call a class as a function")}(this),this.tip="",t&&(this.tip=G("toolbar.".concat(t.replace(/-[a-z]/g,function(t){return t[1].toUpperCase()})))),e&&(this.tip+=" (".concat(e,")")),this.tag=t,this.shortcut=e,this.value=n,this.el=this.element(),this.change=function(){}}function Tn(t){return(Tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function An(t,e,n){return(An="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Rn(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Rn(t){return(Rn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dn(t,e){return(Dn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var In=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dn(t,e)}(zn,_n),Pn(zn.prototype,[{key:"dropdown",value:function(){}},{key:"getValue",value:function(t){return t}},{key:"element",value:function(){var e=this,n=this.tag;return this.dd=this.dropdown(),this.dd.change=function(t){return e.change(n,e.getValue(t))},An(Rn(zn.prototype),"element",this).call(this).child(this.dd)}},{key:"setState",value:function(t){t&&(this.value=t,this.dd.setTitle(t))}}]),zn);function zn(){return function(t){if(!(t instanceof zn))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=Rn(zn).apply(this,arguments))||"object"!==Tn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var t,e}function Hn(t){return(Hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Nn(t){return(Nn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fn(t,e){return(Fn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wn=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fn(t,e)}(Vn,i),Mn(Vn.prototype,[{key:"setContentChildren",value:function(){var t;this.contentEl.html(""),0<arguments.length&&(t=this.contentEl).children.apply(t,arguments)}},{key:"setTitle",value:function(t){this.title.html(t),this.hide()}},{key:"show",value:function(){var t=this;this.contentEl.show(),this.parent().active(),Et(this.parent(),function(){t.hide()})}},{key:"hide",value:function(){this.parent().active(!1),this.contentEl.hide(),xt(this.parent())}}]),Vn);function Vn(t,e,n,r){var i,o;!function(t){if(!(t instanceof Vn))throw new TypeError("Cannot call a class as a function")}(this),o=this,r=Nn(Vn).call(this,"div","".concat(Ct,"-dropdown ").concat(r)),(i=!r||"object"!==Hn(r)&&"function"!=typeof r?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(o):r).title=t,i.change=function(){},i.headerClick=function(){},"string"==typeof t?i.title=w("div","".concat(Ct,"-dropdown-title")).child(t):n&&i.title.addClass("arrow-left"),i.contentEl=w("div","".concat(Ct,"-dropdown-content")).css("width",e).hide();for(var a=arguments.length,l=new Array(4<a?a-4:0),c=4;c<a;c++)l[c-4]=arguments[c];return i.setContentChildren.apply(i,l),i.headerEl=w("div","".concat(Ct,"-dropdown-header")),i.headerEl.on("click",function(){"block"!==i.contentEl.css("display")?i.show():i.hide()}).children(i.title,n?w("div","".concat(Ct,"-icon arrow-right")).child(w("div","".concat(Ct,"-icon-img arrow-down"))):""),i.children(i.headerEl,i.contentEl),i}function qn(t){return(qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ln(t){return(Ln=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Un(t,e){return(Un=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yn=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Un(t,e)}($n,Wn),Bn($n.prototype,[{key:"setTitle",value:function(t){this.title.setName("align-".concat(t)),this.hide()}}]),$n);function $n(t,e){var n;!function(t){if(!(t instanceof $n))throw new TypeError("Cannot call a class as a function")}(this);var r=new le("align-".concat(e)),i=t.map(function(t){return e="align-".concat(t),w("div","".concat(Ct,"-item")).child(new le(e)).on("click",function(){n.setTitle(t),n.change(t)});var e});return e=this,i=(t=Ln($n)).call.apply(t,[this,r,"auto",!0,"bottom-left"].concat(function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(i=i)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}())),n=!i||"object"!==qn(i)&&"function"!=typeof i?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e):i}function Xn(t){return(Xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Kn(t){return(Kn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jn(t,e){return(Jn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gn=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Jn(t,e)}(Qn,In),Zn(Qn.prototype,[{key:"dropdown",value:function(){var t=this.value;return new Yn(["left","center","right"],t)}}]),Qn);function Qn(t){return function(t){if(!(t instanceof Qn))throw new TypeError("Cannot call a class as a function")}(this),e=this,!(t=Kn(Qn).call(this,"align","",t))||"object"!==Xn(t)&&"function"!=typeof t?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e):t;var e}function tr(t){return(tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function er(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function nr(t){return(nr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rr(t,e){return(rr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ir=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),rr(t,e)}(or,In),er(or.prototype,[{key:"dropdown",value:function(){var t=this.value;return new Yn(["top","middle","bottom"],t)}}]),or);function or(t){return function(t){if(!(t instanceof or))throw new TypeError("Cannot call a class as a function")}(this),e=this,!(t=nr(or).call(this,"valign","",t))||"object"!==tr(t)&&"function"!=typeof t?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e):t;var e}function ar(t){return(ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function cr(t,e,n){return(cr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=sr(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function sr(t){return(sr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ur(t,e){return(ur=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fr=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ur(t,e)}(hr,_n),lr(hr.prototype,[{key:"element",value:function(){var t=this,e=this.tag;return cr(sr(hr.prototype),"element",this).call(this).child(new le(e)).on("click",function(){return t.click()})}},{key:"click",value:function(){this.change(this.tag,this.toggle())}},{key:"setState",value:function(t){this.el.active(t)}},{key:"toggle",value:function(){return this.el.toggle()}},{key:"active",value:function(){return this.el.hasClass("active")}}]),hr);function hr(){return function(t){if(!(t instanceof hr))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=sr(hr).apply(this,arguments))||"object"!==ar(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var t,e}function pr(t){return(pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function yr(t){return(yr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vr(t,e){return(vr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var br=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),vr(t,e)}(gr,fr),dr(gr.prototype,[{key:"setState",value:function(){}}]),gr);function gr(){return function(t){if(!(t instanceof gr))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=yr(gr).call(this,"autofilter"))||"object"!==pr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var t,e}function mr(t){return(mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wr(t){return(wr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kr(t,e){return(kr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Or=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),kr(t,e)}(Sr,fr),Sr);function Sr(){return function(t){if(!(t instanceof Sr))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=wr(Sr).call(this,"font-bold","Ctrl+B"))||"object"!==mr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var t,e}function xr(t){return(xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Er(t){return(Er=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jr(t,e){return(jr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _r=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),jr(t,e)}(Cr,fr),Cr);function Cr(){return function(t){if(!(t instanceof Cr))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=Er(Cr).call(this,"font-italic","Ctrl+I"))||"object"!==xr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var t,e}function Tr(t){return(Tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pr(t){return(Pr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ar(t,e){return(Ar=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Rr=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Ar(t,e)}(Dr,fr),Dr);function Dr(){return function(t){if(!(t instanceof Dr))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=Pr(Dr).call(this,"strike","Ctrl+U"))||"object"!==Tr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var t,e}function Ir(t){return(Ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zr(t){return(zr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hr(t,e){return(Hr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Mr=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Hr(t,e)}(Nr,fr),Nr);function Nr(){return function(t){if(!(t instanceof Nr))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=zr(Nr).call(this,"underline","Ctrl+U"))||"object"!==Ir(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var t,e}function Fr(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Wr=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],Vr=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],qr=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function Br(t){var e=this;return w("td","").child(w("div","".concat(Ct,"-color-palette-cell")).on("click.stop",function(){return e.change(t)}).css("background-color",t))}var Lr=function e(){var n=this;!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.el=w("div","".concat(Ct,"-color-palette")),this.change=function(){};var t=w("table","").children((t=w("tbody","")).children.apply(t,[(t=w("tr","".concat(Ct,"-theme-color-placeholders"))).children.apply(t,Fr(Wr.map(function(t){return Br.call(n,t)})))].concat(Fr(Vr.map(function(t){var e;return(e=w("tr","".concat(Ct,"-theme-colors"))).children.apply(e,Fr(t.map(function(t){return Br.call(n,t)})))})),[(t=w("tr","".concat(Ct,"-standard-colors"))).children.apply(t,Fr(qr.map(function(t){return Br.call(n,t)})))])));this.el.child(t)};function Ur(t){return(Ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $r(t){return($r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xr(t,e){return(Xr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zr=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Xr(t,e)}(Kr,Wn),Yr(Kr.prototype,[{key:"setTitle",value:function(t){this.title.css("border-color",t),this.hide()}}]),Kr);function Kr(t,e){var n;!function(t){if(!(t instanceof Kr))throw new TypeError("Cannot call a class as a function")}(this);var r=new le(t).css("height","16px").css("border-bottom","3px solid ".concat(e)),t=new Lr;return t.change=function(t){n.setTitle(t),n.change(t)},e=this,t=$r(Kr).call(this,r,"auto",!1,"bottom-left",t.el),n=!t||"object"!==Ur(t)&&"function"!=typeof t?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e):t}function Jr(t){return(Jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gr(t){return(Gr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qr(t,e){return(Qr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ti=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']],ei=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Qr(t,e)}(ni,Wn),ni);function ni(n){var t,r;!function(t){if(!(t instanceof ni))throw new TypeError("Cannot call a class as a function")}(this);var e,i=new le("line-type"),o=0,a=ti.map(function(t,e){return w("div","".concat(Ct,"-item state ").concat(n===t[0]?"checked":"")).on("click",function(){a[o].toggle("checked"),a[e].toggle("checked"),o=e,r.hide(),r.change(t)}).child(w("div","".concat(Ct,"-line-type")).html(t[1]))});return e=this,i=(t=Gr(ni)).call.apply(t,[this,i,"auto",!1,"bottom-left"].concat(function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(i=a)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}())),r=!i||"object"!==Jr(i)&&"function"!=typeof i?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e):i}function ri(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ii(){var t;return w("table","").child((t=w("tbody","")).children.apply(t,arguments))}function oi(r){var i=this;return w("td","").child(w("div","".concat(Ct,"-border-palette-cell")).child(new le("border-".concat(r))).on("click",function(){i.mode=r;var t=i.mode,e=i.style,n=i.color;i.change({mode:t,style:e,color:n})}))}var ai=function e(){var n=this;!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.color="#000",this.style="thin",this.mode="all",this.change=function(){},this.ddColor=new Zr("line-color",this.color),this.ddColor.change=function(t){n.color=t},this.ddType=new ei(this.style),this.ddType.change=function(t){var e,e=(e=1,(function(t){if(Array.isArray(t))return t}(t=t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}())[0]);n.style=e},this.el=w("div","".concat(Ct,"-border-palette"));var t=ii(w("tr","").children(w("td","".concat(Ct,"-border-palette-left")).child(ii((t=w("tr","")).children.apply(t,ri(["all","inside","horizontal","vertical","outside"].map(function(t){return oi.call(n,t)}))),(t=w("tr","")).children.apply(t,ri(["left","top","right","bottom","none"].map(function(t){return oi.call(n,t)}))))),w("td","".concat(Ct,"-border-palette-right")).children(w("div","".concat(Ct,"-toolbar-btn")).child(this.ddColor.el),w("div","".concat(Ct,"-toolbar-btn")).child(this.ddType.el))));this.el.child(t)};function li(t){return(li="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ci(t){return(ci=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function si(t,e){return(si=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ui=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),si(t,e)}(fi,Wn),fi);function fi(){var e;!function(t){if(!(t instanceof fi))throw new TypeError("Cannot call a class as a function")}(this);var t,n=new le("border-all"),r=new ai;return r.change=function(t){e.change(t),e.hide()},t=this,r=ci(fi).call(this,n,"auto",!1,"bottom-left",r.el),e=!r||"object"!==li(r)&&"function"!=typeof r?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function hi(t){return(hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function di(t){return(di=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yi(t,e){return(yi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vi=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),yi(t,e)}(bi,In),pi(bi.prototype,[{key:"dropdown",value:function(){return new ui}}]),bi);function bi(){return function(t){if(!(t instanceof bi))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=di(bi).call(this,"border"))||"object"!==hi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var t,e}function gi(t){return(gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wi(t,e,n){return(wi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ki(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function ki(t){return(ki=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oi(t,e){return(Oi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oi(t,e)})(Si,_n),mi(Si.prototype,[{key:"element",value:function(){var t=this;return wi(ki(Si.prototype),"element",this).call(this).child(new le(this.tag)).on("click",function(){return t.change(t.tag)})}},{key:"setState",value:function(t){this.el.disabled(t)}}]),Ge=Si;function Si(){return function(t){if(!(t instanceof Si))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=ki(Si).apply(this,arguments))||"object"!==gi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var t,e}function xi(t){return(xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ei(t){return(Ei=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ji(t,e){return(ji=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _i=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),ji(t,e)}(Ci,Ge),Ci);function Ci(){return function(t){if(!(t instanceof Ci))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=Ei(Ci).call(this,"clearformat"))||"object"!==xi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var t,e}function Ti(t){return(Ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ai(t){return(Ai=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ri(t,e){return(Ri=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Di=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Ri(t,e)}(Ii,fr),Pi(Ii.prototype,[{key:"setState",value:function(){}}]),Ii);function Ii(){return function(t){if(!(t instanceof Ii))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=Ai(Ii).call(this,"paintformat"))||"object"!==Ti(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var t,e}function zi(t){return(zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Mi(t){return(Mi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ni(t,e){return(Ni=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Fi=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Ni(t,e)}(Wi,In),Hi(Wi.prototype,[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new Zr(t,e)}}]),Wi);function Wi(t){return function(t){if(!(t instanceof Wi))throw new TypeError("Cannot call a class as a function")}(this),e=this,!(t=Mi(Wi).call(this,"color",void 0,t))||"object"!==zi(t)&&"function"!=typeof t?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e):t;var e}function Vi(t){return(Vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Bi(t){return(Bi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Li(t,e){return(Li=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ui=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Li(t,e)}(Yi,In),qi(Yi.prototype,[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new Zr(t,e)}}]),Yi);function Yi(t){return function(t){if(!(t instanceof Yi))throw new TypeError("Cannot call a class as a function")}(this),e=this,!(t=Bi(Yi).call(this,"bgcolor",void 0,t))||"object"!==Vi(t)&&"function"!=typeof t?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e):t;var e}function $i(t){return($i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xi(t){return(Xi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zi(t,e){return(Zi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ki=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Zi(t,e)}(Ji,Wn),Ji);function Ji(){var t,e;!function(t){if(!(t instanceof Ji))throw new TypeError("Cannot call a class as a function")}(this);var n,r=Ve.map(function(t){return w("div","".concat(Ct,"-item")).on("click",function(){e.setTitle("".concat(t.pt)),e.change(t)}).child("".concat(t.pt))});return n=this,r=(t=Xi(Ji)).call.apply(t,[this,"10","60px",!0,"bottom-left"].concat(function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(r=r)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}())),e=!r||"object"!==$i(r)&&"function"!=typeof r?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(n):r}function Gi(t){return(Gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function to(t){return(to=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function eo(t,e){return(eo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var no=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),eo(t,e)}(ro,In),Qi(ro.prototype,[{key:"getValue",value:function(t){return t.pt}},{key:"dropdown",value:function(){return new Ki}}]),ro);function ro(){return function(t){if(!(t instanceof ro))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=to(ro).call(this,"font-size"))||"object"!==Gi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var t,e}function io(t){return(io="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oo(t){return(oo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ao(t,e){return(ao=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var lo=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),ao(t,e)}(co,Wn),co);function co(){var t,e;!function(t){if(!(t instanceof co))throw new TypeError("Cannot call a class as a function")}(this);var n,r=We.map(function(t){return w("div","".concat(Ct,"-item")).on("click",function(){e.setTitle(t.title),e.change(t)}).child(t.title)});return n=this,r=(t=oo(co)).call.apply(t,[this,We[0].title,"160px",!0,"bottom-left"].concat(function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(r=r)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}())),e=!r||"object"!==io(r)&&"function"!=typeof r?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(n):r}function so(t){return(so="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fo(t){return(fo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ho(t,e){return(ho=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var po=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),ho(t,e)}(yo,In),uo(yo.prototype,[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new lo}}]),yo);function yo(){return function(t){if(!(t instanceof yo))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=fo(yo).call(this,"font-name"))||"object"!==so(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var t,e}function vo(t){return(vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function go(t){return(go=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mo(t,e){return(mo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var wo=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),mo(t,e)}(ko,Wn),bo(ko.prototype,[{key:"setTitle",value:function(t){for(var e=0;e<Qe.length;e+=1)Qe[e].key===t&&this.title.html(Qe[e].title());this.hide()}}]),ko);function ko(){var t,n;!function(t){if(!(t instanceof ko))throw new TypeError("Cannot call a class as a function")}(this);var e,r=Qe.slice(0);return r.splice(2,0,{key:"divider"}),r.splice(8,0,{key:"divider"}),r=r.map(function(t){var e=w("div","".concat(Ct,"-item"));return"divider"===t.key?e.addClass("divider"):(e.child(t.title()).on("click",function(){n.setTitle(t.title()),n.change(t)}),t.label&&e.child(w("div","label").html(t.label))),e}),e=this,r=(t=go(ko)).call.apply(t,[this,"Normal","220px",!0,"bottom-left"].concat(function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(r=r)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}())),n=!r||"object"!==vo(r)&&"function"!=typeof r?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e):r}function Oo(t){return(Oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function So(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xo(t){return(xo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Eo(t,e){return(Eo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var jo=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Eo(t,e)}(_o,In),So(_o.prototype,[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new wo}}]),_o);function _o(){return function(t){if(!(t instanceof _o))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=xo(_o).call(this,"format"))||"object"!==Oo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var t,e}function Co(t){return(Co="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function To(t){return(To=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Po(t,e){return(Po=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ao=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Po(t,e)}(Ro,Wn),Ro);function Ro(){var t,e;!function(t){if(!(t instanceof Ro))throw new TypeError("Cannot call a class as a function")}(this);var n,r=$e.map(function(t){return w("div","".concat(Ct,"-item")).on("click",function(){e.hide(),e.change(t)}).child(t.key)});return n=this,r=(t=To(Ro)).call.apply(t,[this,new le("formula"),"180px",!0,"bottom-left"].concat(function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(r=r)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}())),e=!r||"object"!==Co(r)&&"function"!=typeof r?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(n):r}function Do(t){return(Do="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Io(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zo(t){return(zo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ho(t,e){return(Ho=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Mo=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Ho(t,e)}(No,In),Io(No.prototype,[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new Ao}}]),No);function No(){return function(t){if(!(t instanceof No))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=zo(No).call(this,"formula"))||"object"!==Do(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var t,e}function Fo(t){return(Fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wo(t){return(Wo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vo(t,e){return(Vo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qo=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Vo(t,e)}(Bo,fr),Bo);function Bo(){return function(t){if(!(t instanceof Bo))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=Wo(Bo).call(this,"freeze"))||"object"!==Fo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var t,e}function Lo(t){return(Lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Uo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yo(t){return(Yo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $o(t,e){return($o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xo=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),$o(t,e)}(Zo,fr),Uo(Zo.prototype,[{key:"setState",value:function(t,e){this.el.active(t).disabled(e)}}]),Zo);function Zo(){return function(t){if(!(t instanceof Zo))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=Yo(Zo).call(this,"merge"))||"object"!==Lo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var t,e}function Ko(t){return(Ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jo(t){return(Jo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Go(t,e){return(Go=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qo=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Go(t,e)}(ta,Ge),ta);function ta(){return function(t){if(!(t instanceof ta))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=Jo(ta).call(this,"redo","Ctrl+Y"))||"object"!==Ko(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var t,e}function ea(t){return(ea="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function na(t){return(na=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ra(t,e){return(ra=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ia=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),ra(t,e)}(oa,Ge),oa);function oa(){return function(t){if(!(t instanceof oa))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=na(oa).call(this,"undo","Ctrl+Z"))||"object"!==ea(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var t,e}function aa(t){return(aa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function la(t){return(la=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ca(t,e){return(ca=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var sa=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),ca(t,e)}(ua,Ge),ua);function ua(){return function(t){if(!(t instanceof ua))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=la(ua).call(this,"print","Ctrl+P"))||"object"!==aa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var t,e}function fa(t){return(fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ha(t){return(ha=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pa(t,e){return(pa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var da=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),pa(t,e)}(ya,fr),ya);function ya(){return function(t){if(!(t instanceof ya))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=ha(ya).call(this,"textwrap"))||"object"!==fa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var t,e}function va(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ba(t){return(ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ga(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ma(t,e){return!e||"object"!==ba(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wa(t){return(wa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ka(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oa(t,e)}function Oa(t,e){return(Oa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Sa=(ka(ja,Wn),ja),xa=(ka(Ea,In),va(Ea.prototype,[{key:"dropdown",value:function(){return new Sa}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}]),Ea);function Ea(){var t;return ga(this,Ea),(t=ma(this,wa(Ea).call(this,"more"))).el.hide(),t}function ja(){ga(this,ja);var t=new le("ellipsis"),e=w("div","".concat(Ct,"-toolbar-more"));return(t=ma(this,wa(ja).call(this,t,"auto",!1,"bottom-right",e))).moreBtns=e,t.contentEl.css("max-width","420px"),t}function _a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ca(){return w("div","".concat(Ct,"-toolbar-divider"))}function Ta(){var t=this.el,e=this.btns,n=this.moreEl,r=this.btns2,i=n.dd,o=i.moreBtns,i=i.contentEl;t.css("width","".concat(this.widthFn(),"px"));var a=t.box(),l=160,c=12,s=[],u=[];r.forEach(function(t,e){var n,t=(n=2,function(t){if(Array.isArray(t))return t}(t=t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()),n=t[0],t=t[1];l+=t,e===r.length-1||l<a.width?s.push(n):(c+=t,u.push(n))}),(e=e.html("")).children.apply(e,s),(o=o.html("")).children.apply(o,u),i.css("width","".concat(c,"px")),0<u.length?n.show():n.hide()}function Pa(t){var e=this,n=new _n;n.el.on("click",function(){t.onClick&&t.onClick(e.data.getData(),e.data)}),n.tip=t.tip||"";var r,i=t.el;return t.icon&&(i=w("img").attr("src",t.icon)),i&&((r=w("div","".concat(Ct,"-icon"))).child(i),n.el.child(r)),n}var Aa=(_a(Ra.prototype,[{key:"paintformatActive",value:function(){return this.paintformatEl.active()}},{key:"paintformatToggle",value:function(){this.paintformatEl.toggle()}},{key:"trigger",value:function(t){this["".concat(t,"El")].click()}},{key:"resetData",value:function(t){this.data=t,this.reset()}},{key:"reset",value:function(){var t,e,n,r;this.isHide||(e=(t=this.data).getSelectedCellStyle(),this.undoEl.setState(!t.canUndo()),this.redoEl.setState(!t.canRedo()),this.mergeEl.setState(t.canUnmerge(),!t.selector.multiple()),this.autofilterEl.setState(!t.canAutofilter()),n=e.font,r=e.format,this.formatEl.setState(r),this.fontEl.setState(n.name),this.fontSizeEl.setState(n.size),this.boldEl.setState(n.bold),this.italicEl.setState(n.italic),this.underlineEl.setState(e.underline),this.strikeEl.setState(e.strike),this.textColorEl.setState(e.color),this.fillColorEl.setState(e.bgcolor),this.alignEl.setState(e.align),this.valignEl.setState(e.valign),this.textwrapEl.setState(e.textwrap),this.freezeEl.setState(t.freezeIsActive()))}}]),Ra);function Ra(t,e){var n=this,r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];!function(t){if(!(t instanceof Ra))throw new TypeError("Cannot call a class as a function")}(this),this.data=t,this.change=function(){},this.widthFn=e,this.isHide=r;e=t.defaultStyle();this.items=[[this.undoEl=new ia,this.redoEl=new Qo,new sa,this.paintformatEl=new Di,this.clearformatEl=new _i],Ca(),[this.formatEl=new jo],Ca(),[this.fontEl=new po,this.fontSizeEl=new no],Ca(),[this.boldEl=new Or,this.italicEl=new _r,this.underlineEl=new Mr,this.strikeEl=new Rr,this.textColorEl=new Fi(e.color)],Ca(),[this.fillColorEl=new Ui(e.bgcolor),this.borderEl=new vi,this.mergeEl=new Xo],Ca(),[this.alignEl=new Gn(e.align),this.valignEl=new ir(e.valign),this.textwrapEl=new da],Ca(),[this.freezeEl=new qo,this.autofilterEl=new br,this.formulaEl=new Mo]];e=t.settings.extendToolbar,t=void 0===e?{}:e;t.left&&0<t.left.length&&(this.items.unshift(Ca()),e=t.left.map(Pa.bind(this)),this.items.unshift(e)),t.right&&0<t.right.length&&(this.items.push(Ca()),t=t.right.map(Pa.bind(this)),this.items.push(t)),this.items.push([this.moreEl=new xa]),this.el=w("div","".concat(Ct,"-toolbar")),this.btns=w("div","".concat(Ct,"-toolbar-btns")),this.items.forEach(function(t){Array.isArray(t)?t.forEach(function(t){n.btns.child(t.el),t.change=function(){n.change.apply(n,arguments)}}):n.btns.child(t.el)}),this.el.child(this.btns),r?this.el.hide():(this.reset(),setTimeout(function(){(function(){var i=this;this.btns2=[],this.items.forEach(function(t){var e,n,r;Array.isArray(t)?t.forEach(function(t){var e=t.el,n=e.box(),r=e.computedStyle(),t=r.marginLeft,r=r.marginRight;i.btns2.push([e,n.width+parseInt(t,10)+parseInt(r,10)])}):(e=t.box(),n=(r=t.computedStyle()).marginLeft,r=r.marginRight,i.btns2.push([t,e.width+parseInt(n,10)+parseInt(r,10)]))})}).call(n),Ta.call(n)},0),Ot(window,"resize",function(){Ta.call(n)}))}function Da(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Da(Ia.prototype,[{key:"show",value:function(){var e=this;this.dimmer=w("div","".concat(Ct,"-dimmer active")),document.body.appendChild(this.dimmer.el);var t=this.el.show().box(),n=t.width,r=t.height,i=document.documentElement,t=i.clientHeight,i=i.clientWidth;this.el.offset({left:(i-n)/2,top:(t-r)/3}),window.xkeydownEsc=function(t){27===t.keyCode&&e.hide()},Ot(window,"keydown",window.xkeydownEsc)}},{key:"hide",value:function(){this.el.hide(),document.body.removeChild(this.dimmer.el),St(window,"keydown",window.xkeydownEsc),delete window.xkeydownEsc}}]),In=Ia;function Ia(t,e){var n=this,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"600px";!function(t){if(!(t instanceof Ia))throw new TypeError("Cannot call a class as a function")}(this),this.title=t,this.el=w("div","".concat(Ct,"-modal")).css("width",r).children(w("div","".concat(Ct,"-modal-header")).children(new le("close").on("click.stop",function(){return n.hide()}),this.title),(r=w("div","".concat(Ct,"-modal-content"))).children.apply(r,function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(e=e)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}())).hide()}function za(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ha=(za(Ma.prototype,[{key:"focus",value:function(){var t=this;setTimeout(function(){t.input.el.focus()},10)}},{key:"hint",value:function(t){this.input.attr("placeholder",t)}},{key:"val",value:function(t){return this.input.val(t)}}]),Ma);function Ma(t,e){var n=this;!function(t){if(!(t instanceof Ma))throw new TypeError("Cannot call a class as a function")}(this),this.vchange=function(){},this.el=w("div","".concat(Ct,"-form-input")),this.input=w("input","").css("width",t).on("input",function(t){return n.vchange(t)}).attr("placeholder",e),this.el.child(this.input)}function Na(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Fa=(Na(Wa.prototype,[{key:"show",value:function(){this.suggest.search("")}},{key:"itemClick",value:function(t){this.key=t,this.itemEl.html(this.getTitle(t))}},{key:"val",value:function(t){return void 0!==t?(this.key=t,this.itemEl.html(this.getTitle(t)),this):this.key}}]),Wa);function Wa(t,e,n){var r=this,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:function(t){return t},o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:function(){};!function(t){if(!(t instanceof Wa))throw new TypeError("Cannot call a class as a function")}(this),this.key=t,this.getTitle=i,this.vchange=function(){},this.el=w("div","".concat(Ct,"-form-select")),this.suggest=new ee(e.map(function(t){return{key:t,title:r.getTitle(t)}}),function(t){r.itemClick(t.key),o(t.key),r.vchange(t.key)},n,this.el),this.el.children(this.itemEl=w("div","input-text").html(this.getTitle(t)),this.suggest.el).on("click",function(){return r.show()})}function Va(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var qa={number:/(^\d+$)|(^\d+(\.\d{0,4})?$)/,date:/^\d{4}-\d{1,2}-\d{1,2}$/},Ba=(Va(La.prototype,[{key:"isShow",value:function(){return"none"!==this.el.css("display")}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"val",value:function(t){return this.input.val(t)}},{key:"hint",value:function(t){this.input.hint(t)}},{key:"validate",value:function(){var t=this.input,e=this.rule,n=this.tip,r=this.el,t=t.val();return e.required&&/^\s*$/.test(t)?(n.html(G("validation.required")),r.addClass("error"),!1):!e.type&&!e.pattern||(e.pattern||qa[e.type]).test(t)?(r.removeClass("error"),!0):(n.html(G("validation.notMatch")),r.addClass("error"),!1)}}]),La);function La(t,e,n,r){var i=this;!function(t){if(!(t instanceof La))throw new TypeError("Cannot call a class as a function")}(this),this.label="",this.rule=e,n&&(this.label=w("label","label").css("width","".concat(r,"px")).html(n)),this.tip=w("div","tip").child("tip").hide(),this.input=t,this.input.vchange=function(){return i.validate()},this.el=w("div","".concat(Ct,"-form-field")).children(this.label,t.el,this.tip)}function Ua(t){return(Ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ya(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $a(t){return($a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xa(t,e){return(Xa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Za=100,Ka=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Xa(t,e)}(Ja,In),Ya(Ja.prototype,[{key:"showVf",value:function(t){var e="date"===t?"2018-11-12":"10",t=this.vf;t.input.hint(e),t.show()}},{key:"criteriaSelected",value:function(t){var e=this.of,n=this.minvf,r=this.maxvf,i=this.vf,o=this.svf;"date"===t||"number"===t?(e.show(),n.rule.type=t,"date"===(r.rule.type=t)?(n.hint("2018-11-12"),r.hint("2019-11-12")):(n.hint("10"),r.hint("100")),n.show(),r.show(),i.hide(),o.hide()):("list"===t?o.show():o.hide(),i.hide(),e.hide(),n.hide(),r.hide())}},{key:"criteriaOperatorSelected",value:function(t){var e,n,r;t&&(e=this.minvf,n=this.maxvf,r=this.vf,"be"===t||"nbe"===t?(e.show(),n.show(),r.hide()):(t=this.cf.val(),"date"===(r.rule.type=t)?r.hint("2018-11-12"):r.hint("10"),r.show(),e.hide(),n.hide()))}},{key:"btnClick",value:function(t){if("cancel"===t)this.hide();else if("remove"===t)this.change("remove"),this.hide();else if("save"===t){for(var e=["mf","rf","cf","of","svf","vf","minvf","maxvf"],n=0;n<e.length;n+=1){var r=this[e[n]];if(r.isShow()&&!r.validate())return}var i=this.mf.val(),o=this.rf.val(),a=this.cf.val(),l=this.of.val(),t=this.svf.val();"number"!==a&&"date"!==a||(t="be"===l||"nbe"===l?[this.minvf.val(),this.maxvf.val()]:this.vf.val()),this.change("save",i,o,{type:a,operator:l,required:!1,value:t}),this.hide()}}},{key:"setValue",value:function(t){var e,n,r,i,o,a,l,c,s,u,f,h;t&&(e=this.mf,n=this.rf,r=this.cf,i=this.of,o=this.svf,a=this.vf,l=this.minvf,c=this.maxvf,s=t.mode,u=t.ref,f=(h=t.validator||{type:"list"}).type,t=h.operator,h=h.value,e.val(s||"cell"),n.val(u),r.val(f),i.val(t),Array.isArray(h)?(l.val(h[0]),c.val(h[1])):(o.val(h||""),a.val(h||"")),this.criteriaSelected(f),this.criteriaOperatorSelected(t)),this.show()}}]),Ja);function Ja(){var e;!function(t){if(!(t instanceof Ja))throw new TypeError("Cannot call a class as a function")}(this);var t,n,r=new Ba(new Fa("cell",["cell"],"100%",function(t){return G("dataValidation.modeType.".concat(t))}),{required:!0},"".concat(G("dataValidation.range"),":"),Za),i=new Ba(new Ha("120px","E3 or E3:F12"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/}),o=new Ba(new Fa("list",["list","number","date","phone","email"],"100%",function(t){return G("dataValidation.type.".concat(t))},function(t){return e.criteriaSelected(t)}),{required:!0},"".concat(G("dataValidation.criteria"),":"),Za),a=new Ba(new Fa("be",["be","nbe","eq","neq","lt","lte","gt","gte"],"160px",function(t){return G("dataValidation.operator.".concat(t))},function(t){return e.criteriaOperatorSelected(t)}),{required:!0}).hide(),l=new Ba(new Ha("70px","10"),{required:!0}).hide(),c=new Ba(new Ha("70px","100"),{required:!0,type:"number"}).hide(),s=new Ba(new Ha("120px","a,b,c"),{required:!0}),u=new Ba(new Ha("70px","10"),{required:!0,type:"number"}).hide();return t=this,(e=!(n=$a(Ja).call(this,G("contextmenu.validation"),[w("div","".concat(Ct,"-form-fields")).children(r.el,i.el),w("div","".concat(Ct,"-form-fields")).children(o.el,a.el,l.el,c.el,u.el,s.el),w("div","".concat(Ct,"-buttons")).children(new Ee("cancel").on("click",function(){return e.btnClick("cancel")}),new Ee("remove").on("click",function(){return e.btnClick("remove")}),new Ee("save","primary").on("click",function(){return e.btnClick("save")}))]))||"object"!==Ua(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n).mf=r,e.rf=i,e.cf=o,e.of=a,e.minvf=l,e.maxvf=c,e.vf=u,e.svf=s,e.change=function(){},e}function Ga(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qa(t){return w("div","".concat(Ct,"-item ").concat(t))}function tl(t){var e=this;return Qa("state").child(G("sort.".concat(t))).on("click.stop",function(){return e.itemClick(t)})}function el(){var t=this.filterhEl,e=this.filterValues,n=this.values;t.html("".concat(e.length," / ").concat(n.length)),t.checked(e.length===n.length)}var nl=(Ga(rl.prototype,[{key:"btnClick",value:function(t){var e,n;"ok"===t&&(e=this.ci,n=this.sort,t=this.filterValues,this.ok&&this.ok(e,n,"in",t)),this.hide()}},{key:"itemClick",value:function(t){this.sort=t;var e=this.sortAscEl,n=this.sortDescEl;e.checked("asc"===t),n.checked("desc"===t)}},{key:"filterClick",value:function(t,e){var n=this.filterbEl,r=this.filterValues,i=this.values,n=n.children();"all"===e?n.length===r.length?(this.filterValues=[],n.forEach(function(t){return w(t).checked(!1)})):(this.filterValues=Array.from(i),n.forEach(function(t){return w(t).checked(!0)})):w(n[t]).toggle("checked")?r.push(e):r.splice(r.findIndex(function(t){return t===e}),1),el.call(this)}},{key:"set",value:function(t,e,n,r){this.ci=t;var i=this.sortAscEl,t=this.sortDescEl;null!==r?(this.sort=r.order,i.checked(r.asc()),t.checked(r.desc())):(this.sortDesc=null,i.checked(!1),t.checked(!1)),this.values=Object.keys(e),this.filterValues=n?Array.from(n.value):Object.keys(e),function(i){var o=this,a=this.filterbEl,l=this.filterValues;a.html(""),Object.keys(i).forEach(function(t,e){var n=i[t],r=l.includes(t)?"checked":"";a.child(w("div","".concat(Ct,"-item state ").concat(r)).on("click.stop",function(){return o.filterClick(e,t)}).children(""===t?G("filter.empty"):t,w("div","label").html("(".concat(n,")"))))})}.call(this,e,n),el.call(this)}},{key:"setOffset",value:function(t){var e=this;this.el.offset(t).show();var n=1;Et(this.el,function(){n<=0&&e.hide(),--n})}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide(),xt(this.el)}}]),rl);function rl(){var t=this;!function(t){if(!(t instanceof rl))throw new TypeError("Cannot call a class as a function")}(this),this.filterbEl=w("div","".concat(Ct,"-body")),this.filterhEl=w("div","".concat(Ct,"-header state")).on("click.stop",function(){return t.filterClick(0,"all")}),this.el=w("div","".concat(Ct,"-sort-filter")).children(this.sortAscEl=tl.call(this,"asc"),this.sortDescEl=tl.call(this,"desc"),Qa("divider"),w("div","".concat(Ct,"-filter")).children(this.filterhEl,this.filterbEl),w("div","".concat(Ct,"-buttons")).children(new Ee("cancel").on("click",function(){return t.btnClick("cancel")}),new Ee("ok","primary").on("click",function(){return t.btnClick("ok")}))).hide(),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]}function il(t,e){var n=w("div","".concat(Ct,"-toast")),r=w("div","".concat(Ct,"-dimmer active"));n.children(w("div","".concat(Ct,"-toast-header")).children(new le("close").on("click.stop",function(){return document.body.removeChild(n.el),void document.body.removeChild(r.el)}),t),w("div","".concat(Ct,"-toast-content")).html(e)),document.body.appendChild(n.el),document.body.appendChild(r.el);var i=n.box(),o=i.width,t=i.height,e=document.documentElement,i=e.clientHeight,e=e.clientWidth;n.offset({left:(e-o)/2,top:(i-t)/3})}function ol(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function al(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ll(){return 1}function cl(t,e,n){var r,i,o,a,l=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],c=4<arguments.length&&void 0!==arguments[4]&&arguments[4];-1===e&&-1===n||(r=this.table,i=this.selector,o=this.toolbar,a=this.data,this.contextMenu.setMode(-1===e||-1===n?"row-col":"range"),a=a.getCell(e,n),t?(i.setEnd(e,n,c),this.trigger("cells-selected",a,i.range)):(i.set(e,n,l),this.trigger("cell-selected",a,e,n)),o.reset(),r.render())}function sl(t,e){var n=this.selector,r=this.data,i=r.rows,o=r.cols,a=al(n.indexes,2),l=a[0],c=a[1],s=n.range,r=s.eri,a=s.eci;t&&(l=(s=al(n.moveIndexes,2))[0],c=s[1]),"left"===e?0<c&&--c:"right"===e?(a!==c&&(c=a),c<o.len-1&&(c+=1)):"up"===e?0<l&&--l:"down"===e?(r!==l&&(l=r),l<i.len-1&&(l+=1)):"row-first"===e?c=0:"row-last"===e?c=o.len-1:"col-first"===e?l=0:"col-last"===e&&(l=i.len-1),t&&(n.moveIndexes=[l,c]),cl.call(this,t,l,c),function(){var t=this.data,e=this.verticalScrollbar,n=this.horizontalScrollbar,r=t.getSelectedRect(),i=r.l,o=r.t,a=r.left,l=r.top,c=r.width,s=r.height,r=this.getTableOffset();Math.abs(a)+c>r.width?n.move({left:i+c-r.width}):a<(a=t.freezeTotalWidth())&&n.move({left:i-1-a}),Math.abs(l)+s>r.height?e.move({top:o+s-r.height-1}):l<(t=t.freezeTotalHeight())&&e.move({top:o-1-t})}.call(this)}function ul(){var t=this.data,e=this.verticalScrollbar,n=this.getTableOffset().height,r=t.exceptRowTotalHeight(0,-1);e.set(n,t.rows.totalHeight()-r)}function fl(){var t=this.data,e=this.horizontalScrollbar,n=this.getTableOffset().width;t&&e.set(n,t.cols.totalWidth())}function hl(){var t=this.tableEl,e=this.overlayerEl,n=this.overlayerCEl,r=this.table,i=this.toolbar,o=this.selector,a=this.el,l=this.getTableOffset(),c=this.getRect();t.attr(c),e.offset(c),n.offset(l),a.css("width","".concat(c.width,"px")),ul.call(this),fl.call(this),function(){var t=this.selector,e=this.data,n=this.editor,r=al(e.freeze,2),i=r[0],r=r[1];(0<i||0<r)&&(r=e.freezeTotalWidth(),e=e.freezeTotalHeight(),n.setFreezeLengths(r,e)),t.resetAreaOffset()}.call(this),r.render(),i.reset(),o.reset()}function pl(){var t=this.data,e=this.selector;t.clearClipboard(),e.hideClipboard()}function dl(){var t=this.data,e=this.selector;t.copy(),t.copyToSystemClipboard(),e.showClipboard()}function yl(){var t=this.data,e=this.selector;t.cut(),e.showClipboard()}function vl(t,e){var n=this.data;"read"!==n.settings.mode&&(n.paste(t,function(t){return il("Tip",t)})?hl.call(this):e&&(e=e.clipboardData.getData("text/plain"),this.data.pasteFromText(e),hl.call(this)))}function bl(t,e){this.data.unhideRowsOrCols(t,e),hl.call(this)}function gl(t){var n=this,r=this.selector,i=this.data,e=this.table,o=this.sortFilter,a=t.offsetX,l=t.offsetY,c=t.target.className==="".concat(Ct,"-selector-corner"),s=i.getCellRectByXY(a,l),u=s.left,f=s.top,h=s.width,p=s.height,d=s.ri,y=s.ci,s=i.autoFilter;if(s.includes(d,y)&&u+h-20<a&&f+p-20<l){l=s.items(y,function(t,e){return i.rows.getCell(t,e)});return o.hide(),o.set(y,l,s.getFilter(y),s.getSort(y)),void o.setOffset({left:u,top:f+p+2})}t.shiftKey||(c?r.showAutofill(d,y):cl.call(this,!1,d,y),jt(window,function(t){var e=i.getCellRectByXY(t.offsetX,t.offsetY);d=e.ri,y=e.ci,c?r.showAutofill(d,y):1!==t.buttons||t.shiftKey||cl.call(n,!0,d,y,!0,!0)},function(){c&&r.arange&&"read"!==i.settings.mode&&i.autofill(r.arange,"all",function(t){return il("Tip",t)})&&e.render(),r.hideAutofill(),function(){var t=this.toolbar;t.paintformatActive()&&(vl.call(this,"format"),pl.call(this),t.paintformatToggle())}.call(n)})),c||1!==t.buttons||t.shiftKey&&cl.call(this,!0,d,y)}function ml(){var t=this.editor,e=this.data.getSelectedRect(),n=this.getTableOffset(),r="top";e.top>n.height/2&&(r="bottom"),t.setOffset(e,r)}function wl(){var t=this.editor,e=this.data;"read"!==e.settings.mode&&(ml.call(this),t.setCell(e.getSelectedCell(),e.getSelectedValidator()),pl.call(this))}function kl(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"finished",r=this.data,i=this.table;"read"!==r.settings.mode&&(r.setSelectedCellText(t,n),r=(e=r.selector).ri,e=e.ci,"finished"===n?i.render():this.trigger("cell-edited",t,r,e))}function Ol(t){var e=this.data;"read"!==e.settings.mode&&("insert-row"===t?e.insert("row"):"delete-row"===t?e.delete("row"):"insert-column"===t?e.insert("column"):"delete-column"===t?e.delete("column"):"delete-cell"===t?e.deleteCell():"delete-cell-format"===t?e.deleteCell("format"):"delete-cell-text"===t?e.deleteCell("text"):"cell-printable"===t?e.setSelectedCellAttr("printable",!0):"cell-non-printable"===t?e.setSelectedCellAttr("printable",!1):"cell-editable"===t?e.setSelectedCellAttr("editable",!0):"cell-non-editable"===t&&e.setSelectedCellAttr("editable",!1),pl.call(this),hl.call(this))}function Sl(){var t,o,r,a,l,c=this,e=this.selector,n=this.overlayerEl,i=this.rowResizer,s=this.colResizer,u=this.verticalScrollbar,f=this.horizontalScrollbar,h=this.editor,p=this.contextMenu,d=this.toolbar,y=this.modalValidation,v=this.sortFilter;n.on("mousemove",function(t){(function(t){if(0===t.buttons&&t.target.className!=="".concat(Ct,"-resizer-hover")){var e=t.offsetX,n=t.offsetY,r=this.rowResizer,i=this.colResizer,o=this.tableEl,a=this.data,l=a.rows,c=a.cols;if(e>c.indexWidth&&n>l.height)return r.hide(),void i.hide();o=o.box(),t=a.getCellRectByXY(t.offsetX,t.offsetY);0<=t.ri&&-1===t.ci?(t.width=c.indexWidth,r.show(t,{width:o.width}),l.isHide(t.ri-1)?r.showUnhide(t.ri):r.hideUnhide()):r.hide(),-1===t.ri&&0<=t.ci?(t.height=l.height,i.show(t,{height:o.height}),c.isHide(t.ci-1)?i.showUnhide(t.ci):i.hideUnhide()):i.hide()}}).call(c,t)}).on("mousedown",function(t){h.clear(),p.hide(),2===t.buttons?(c.data.xyInSelectedRect(t.offsetX,t.offsetY)||gl.call(c,t),p.setPosition(t.offsetX,t.offsetY),t.stopPropagation()):2===t.detail?wl.call(c):gl.call(c,t)}).on("mousewheel.stop",function(t){(function(t){function r(t,e){for(var n=t,r=0;r=e(n),n+=1,r<=0;);return r}function e(t){var e,n;0<t?(e=l.scroll.ri+1)<u.len&&(n=r(e,function(t){return u.getHeight(t)}),o.move({top:c+n-1})):0<=(e=l.scroll.ri-1)&&(n=r(e,function(t){return u.getHeight(t)}),o.move({top:0==e?0:c-n}))}var n,i,o=this.verticalScrollbar,a=this.horizontalScrollbar,l=this.data,c=o.scroll().top,s=a.scroll().left,u=l.rows,f=l.cols,h=t.deltaY,p=t.deltaX,d=Math.abs(h),y=Math.abs(p),v=Math.max(d,y);/Firefox/i.test(window.navigator.userAgent)&&ll(e(t.detail)),v===y&&ll(0<p?(n=l.scroll.ci+1)<f.len&&(i=r(n,function(t){return f.getWidth(t)}),a.move({left:s+i-1})):0<=(n=l.scroll.ci-1)&&(i=r(n,function(t){return f.getWidth(t)}),a.move({left:0==n?0:s-i}))),v===d&&ll(e(h))}).call(c,t)}).on("mouseout",function(t){var e=t.offsetX;t.offsetY<=0&&s.hide(),e<=0&&i.hide()}),e.inputChange=function(t){kl.call(c,t,"input"),wl.call(c)},t=n.el,o=(e={move:function(t,e){(function(t,e){var n=this.verticalScrollbar,r=this.horizontalScrollbar,i=n.scroll().top,o=r.scroll().left;"left"===t||"right"===t?r.move({left:o-e}):"up"!==t&&"down"!==t||n.move({top:i-e})}).call(c,t,e)}}).move,r=e.end,l=a=0,Ot(t,"touchstart",function(t){var e=t.touches[0],t=e.pageX,e=e.pageY;a=t,l=e}),Ot(t,"touchmove",function(t){var e,n,r,i;o&&(e=(i=t.changedTouches[0]).pageX,n=i.pageY,r=e-a,i=n-l,(10<Math.abs(r)||10<Math.abs(i))&&(_t(r,i,t,o),a=e,l=n),t.preventDefault())}),Ot(t,"touchend",function(t){var e,n;r&&(e=(n=t.changedTouches[0]).pageX,n=n.pageY,_t(e-a,n-l,t,r))}),d.change=function(t,e){return function(t,e){var n,r,i=this.data;"undo"===t?this.undo():"redo"===t?this.redo():"print"===t?this.print.preview():"paintformat"===t?(!0===e?dl:pl).call(this):"clearformat"===t?Ol.call(this,"delete-cell-format"):"link"===t||"chart"===t||("autofilter"===t?function(){this.data.autofilter(),hl.call(this)}.call(this):"freeze"===t?e?(n=(r=i.selector).ri,r=r.ci,this.freeze(n,r)):this.freeze(0,0):(i.setSelectedCellAttr(t,e),"formula"!==t||i.selector.multiple()||wl.call(this),hl.call(this)))}.call(c,t,e)},v.ok=function(t,e,n,r){return function(t,e,n,r){this.data.setAutoFilter(t,e,n,r),hl.call(this)}.call(c,t,e,n,r)},i.finishedFn=function(t,e){(function(t,e){var n=t.ri,r=this.table,t=this.selector;this.data.rows.setHeight(n,e),r.render(),t.resetAreaOffset(),ul.call(this),ml.call(this)}).call(c,t,e)},s.finishedFn=function(t,e){(function(t,e){var n=t.ci,r=this.table,t=this.selector;this.data.cols.setWidth(n,e),r.render(),t.resetAreaOffset(),fl.call(this),ml.call(this)}).call(c,t,e)},i.unhideFn=function(t){bl.call(c,"row",t)},s.unhideFn=function(t){bl.call(c,"col",t)},u.moveFn=function(t,e){(function(t){var e=this,n=this.data,r=this.table,i=this.selector;n.scrolly(t,function(){i.resetBRLAreaOffset(),ml.call(e),r.render()})}).call(c,t,e)},f.moveFn=function(t,e){(function(t){var e=this,n=this.data,r=this.table,i=this.selector;n.scrollx(t,function(){i.resetBRTAreaOffset(),ml.call(e),r.render()})}).call(c,t,e)},h.change=function(t,e){kl.call(c,e,t)},y.change=function(t){if("save"===t){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];(t=c.data).addValidation.apply(t,n)}else c.data.removeValidation()},p.itemClick=function(t){"validation"===t?y.setValue(c.data.getSelectedValidation()):"copy"===t?dl.call(c):"cut"===t?yl.call(c):"paste"===t?vl.call(c,"all"):"paste-value"===t?vl.call(c,"text"):"paste-format"===t?vl.call(c,"format"):"hide"===t?function(){this.data.hideRowsOrCols(),hl.call(this)}.call(c):Ol.call(c,t)},Ot(window,"resize",function(){c.reload()}),Ot(window,"click",function(t){c.focusing=n.contains(t.target)}),Ot(window,"paste",function(t){c.focusing&&(vl.call(c,"all",t),t.preventDefault())}),Ot(window,"keydown",function(t){if(c.focusing){var e=t.keyCode||t.which,n=t.key,r=t.ctrlKey,i=t.shiftKey,o=t.metaKey;if(r||o)switch(e){case 90:c.undo(),t.preventDefault();break;case 89:c.redo(),t.preventDefault();break;case 67:dl.call(c),t.preventDefault();break;case 88:yl.call(c),t.preventDefault();break;case 85:d.trigger("underline"),t.preventDefault();break;case 86:break;case 37:sl.call(c,i,"row-first"),t.preventDefault();break;case 38:sl.call(c,i,"col-first"),t.preventDefault();break;case 39:sl.call(c,i,"row-last"),t.preventDefault();break;case 40:sl.call(c,i,"col-last"),t.preventDefault();break;case 32:cl.call(c,!1,-1,c.data.selector.ci,!1),t.preventDefault();break;case 66:d.trigger("bold");break;case 73:d.trigger("italic")}else{switch(e){case 32:i&&cl.call(c,!1,c.data.selector.ri,-1,!1);break;case 27:p.hide(),pl.call(c);break;case 37:sl.call(c,i,"left"),t.preventDefault();break;case 38:sl.call(c,i,"up"),t.preventDefault();break;case 39:sl.call(c,i,"right"),t.preventDefault();break;case 40:sl.call(c,i,"down"),t.preventDefault();break;case 9:h.clear(),sl.call(c,!1,i?"left":"right"),t.preventDefault();break;case 13:h.clear(),sl.call(c,!1,i?"up":"down"),t.preventDefault();break;case 8:Ol.call(c,"delete-cell-text"),t.preventDefault()}"Delete"===n?(Ol.call(c,"delete-cell-text"),t.preventDefault()):65<=e&&e<=90||48<=e&&e<=57||96<=e&&e<=105||"="===t.key?(kl.call(c,t.key,"input"),wl.call(c)):113===e&&wl.call(c)}}})}var xl=(ol(El.prototype,[{key:"on",value:function(t,e){return this.eventMap.on(t,e),this}},{key:"trigger",value:function(t){for(var e=this.eventMap,n=arguments.length,r=new Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.fire(t,r)}},{key:"resetData",value:function(t){this.editor.clear(),this.data=t,ul.call(this),fl.call(this),this.toolbar.resetData(t),this.print.resetData(t),this.selector.resetData(t),this.table.resetData(t)}},{key:"loadData",value:function(t){return this.data.setData(t),hl.call(this),this}},{key:"freeze",value:function(t,e){return this.data.setFreeze(t,e),hl.call(this),this}},{key:"undo",value:function(){this.data.undo(),hl.call(this)}},{key:"redo",value:function(){this.data.redo(),hl.call(this)}},{key:"reload",value:function(){return hl.call(this),this}},{key:"getRect",value:function(){var t=this.data;return{width:t.viewWidth(),height:t.viewHeight()}}},{key:"getTableOffset",value:function(){var t=this.data,e=t.rows,n=t.cols,r=this.getRect(),t=r.width,r=r.height;return{width:t-n.indexWidth,height:r-e.height,left:n.indexWidth,top:e.height}}}]),El);function El(t,e){var c,n=this;function r(t,e){var n;c.has(t)?(n=c.get(t),Array.isArray(n)&&n.push(e)):c.set(t,[].concat(e))}function a(t,e){!c.has(t)||(e=(t=c.get(t)).indexOf(e))&&0<=e&&t.splice(e,1)}!function(t){if(!(t instanceof El))throw new TypeError("Cannot call a class as a function")}(this),this.eventMap=(c=new Map,{getAllListeners:function(){return c},on:r,once:function(i,o){r(i,function t(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];o.call.apply(o,[null].concat(n)),a(i,t)})},fire:function(t,e){if(c.has(t)){var n=c.get(t),r=!0,i=!1,o=void 0;try{for(var a=n[Symbol.iterator]();!(r=(l=a.next()).done);r=!0){var l=l.value;l.call.apply(l,[null].concat(function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(l=e)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(l)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()))}}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}}},removeListener:a,removeAllListeners:function(){c.clear()}});var i=e.settings,o=i.view,l=i.showToolbar,i=i.showContextmenu;this.el=w("div","".concat(Ct,"-sheet")),this.toolbar=new Aa(e,o.width,!l),this.print=new wn(e),t.children(this.toolbar.el,this.el,this.print.el),this.data=e,this.tableEl=w("canvas","".concat(Ct,"-table")),this.rowResizer=new Pt(!1,e.rows.height),this.colResizer=new Pt(!0,e.cols.minWidth),this.verticalScrollbar=new Dt(!0),this.horizontalScrollbar=new Dt(!1),this.editor=new we(Xe,function(){return n.getTableOffset()},e.rows.height),this.modalValidation=new Ka,this.contextMenu=new xn(function(){return n.getRect()},!i),this.selector=new Gt(e),this.overlayerCEl=w("div","".concat(Ct,"-overlayer-content")).children(this.editor.el,this.selector.el),this.overlayerEl=w("div","".concat(Ct,"-overlayer")).child(this.overlayerCEl),this.sortFilter=new nl,this.el.children(this.tableEl,this.overlayerEl.el,this.rowResizer.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.modalValidation.el,this.sortFilter.el),this.table=new hn(this.tableEl.el,e),Sl.call(this),hl.call(this),cl.call(this,!1,0,0)}function jl(t){return(jl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _l(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Cl(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Pl(t,e,n){return e&&Tl(t.prototype,e),n&&Tl(t,n),t}function Al(t){return(Al=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Rl(t,e){return(Rl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Dl=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Rl(t,e)}(zl,Wn),Pl(zl,[{key:"reset",value:function(t){var n=this,t=t.map(function(t,e){return w("div","".concat(Ct,"-item")).css("width","150px").css("font-weight","normal").on("click",function(){n.contentClick(e),n.hide()}).child(t)});this.setContentChildren.apply(this,_l(t))}},{key:"setTitle",value:function(){}}]),zl),Il=[{key:"delete",title:Q("contextmenu.deleteSheet")}];function zl(t){Cl(this,zl);var e,n=new le("ellipsis");return e=this,(n=!(n=Al(zl).call(this,n,"auto",!1,"top-left"))||"object"!==jl(n)&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e):n).contentClick=t,n}var Hl=(Pl(Fl,[{key:"hide",value:function(){var t=this.el;t.hide(),xt(t)}},{key:"setOffset",value:function(t){var e=this.el;e.offset(t),e.show(),Et(e)}}]),Fl),Ml=(Pl(Nl,[{key:"addItem",value:function(t,e){var r=this;this.dataNames.push(t);var i=w("li",e?"active":"").child(t);i.on("click",function(){r.clickSwap2(i)}).on("contextmenu",function(t){var e=t.target,t=e.offsetLeft,e=e.offsetHeight;r.contextMenu.setOffset({left:t,bottom:e+1}),r.deleteEl=i}).on("dblclick",function(){var n=i.html(),t=new Ha("auto","");t.val(n),t.input.on("blur",function(t){var e=t.target.value,t=r.dataNames.findIndex(function(t){return t===n});r.renameItem(t,e)}),i.html("").child(t.el),t.focus()}),e&&this.clickSwap(i),this.items.push(i),this.menuEl.child(i),this.moreEl.reset(this.dataNames)}},{key:"renameItem",value:function(t,e){this.dataNames.splice(t,1,e),this.moreEl.reset(this.dataNames),this.items[t].html("").child(e),this.updateFunc(t,e)}},{key:"clear",value:function(){var e=this;this.items.forEach(function(t){e.menuEl.removeChild(t.el)}),this.items=[],this.dataNames=[],this.moreEl.reset(this.dataNames)}},{key:"deleteItem",value:function(){var t,e=this.activeEl,n=this.deleteEl;if(1<this.items.length){var r=this.items.findIndex(function(t){return t===n});if(this.items.splice(r,1),this.dataNames.splice(r,1),this.menuEl.removeChild(n.el),this.moreEl.reset(this.dataNames),e!==n)return[r,-1];e=(t=this.items,e=1,(function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}())[0]);return this.activeEl=e,this.activeEl.toggle(),[r,0]}return[-1]}},{key:"clickSwap2",value:function(e){var t=this.items.findIndex(function(t){return t===e});this.clickSwap(e),this.activeEl.toggle(),this.swapFunc(t)}},{key:"clickSwap",value:function(t){null!==this.activeEl&&this.activeEl.toggle(),this.activeEl=t}}]),Nl);function Nl(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:function(){};Cl(this,Nl),this.swapFunc=n,this.updateFunc=i,this.dataNames=[],this.activeEl=null,this.deleteEl=null,this.items=[],this.moreEl=new Dl(function(t){e.clickSwap2(e.items[t])}),this.contextMenu=new Hl,this.contextMenu.itemClick=r,this.el=w("div","".concat(Ct,"-bottombar")).children(this.contextMenu.el,this.menuEl=w("ul","".concat(Ct,"-menu")).child(w("li","").children(new le("add").on("click",function(){t()}),w("span","").child(this.moreEl))))}function Fl(){var t;Cl(this,Fl),this.el=(t=w("div","".concat(Ct,"-contextmenu")).css("width","160px")).children.apply(t,_l(function(){var e=this;return Il.map(function(t){return function(t){var e=this;return w("div","".concat(Ct,"-item")).child(t.title()).on("click",function(){e.itemClick(t.key),e.hide()})}.call(e,t)})}.call(this))).hide(),this.itemClick=function(){}}function Wl(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function Vl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n(1),n.d(e,"spreadsheet",function(){return Bl});var ql=(Wn=[{key:"locale",value:function(t,e){tt(t,e)}}],Vl((n=Ll).prototype,[{key:"addSheet",value:function(t){var i=this,e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=t||"sheet".concat(this.sheetIndex),t=new wt(n,this.options);return t.change=function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];(t=i.sheet).trigger.apply(t,["change"].concat(n))},this.datas.push(t),null!==this.bottombar&&this.bottombar.addItem(n,e),this.sheetIndex+=1,t}},{key:"deleteSheet",value:function(){var t,e;null!==this.bottombar&&(t=this.bottombar.deleteItem(),e=2,e=(t=function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}())[0],t=t[1],0<=e&&(this.datas.splice(e,1),0<=t&&this.sheet.resetData(this.datas[t])))}},{key:"loadData",value:function(t){var e=Array.isArray(t)?t:[t];if(null!==this.bottombar&&this.bottombar.clear(),this.datas=[],0<e.length)for(var n=0;n<e.length;n+=1){var r=e[n],i=this.addSheet(r.name,0===n);i.setData(r),0===n&&this.sheet.resetData(i)}return this}},{key:"getData",value:function(){return this.datas.map(function(t){return t.getData()})}},{key:"cellText",value:function(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;return this.datas[r].setCellText(t,e,n,"finished"),this}},{key:"cell",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return this.datas[n].getCell(t,e)}},{key:"cellStyle",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return this.datas[n].getCellStyle(t,e)}},{key:"reRender",value:function(){return this.sheet.table.render(),this}},{key:"on",value:function(t,e){return this.sheet.on(t,e),this}},{key:"validate",value:function(){return this.data.validations.errors.size<=0}},{key:"change",value:function(t){return this.sheet.on("change",t),this}}]),Vl(n,Wn),Ll),Bl=function(t){return new ql(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{})};function Ll(t){var n=this,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};!function(t){if(!(t instanceof Ll))throw new TypeError("Cannot call a class as a function")}(this);var r=t;this.options=function(r){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Wl(i,!0).forEach(function(t){var e,n;e=r,t=i[n=t],n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):Wl(i).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(i,t))})}return r}({showBottomBar:!0},e),this.sheetIndex=1,this.datas=[],"string"==typeof t&&(r=document.querySelector(t)),this.bottombar=this.options.showBottomBar?new Ml(function(){var t=n.addSheet();n.sheet.resetData(t)},function(t){t=n.datas[t];n.sheet.resetData(t)},function(){n.deleteSheet()},function(t,e){n.datas[t].name=e}):null,this.data=this.addSheet();t=w("div","".concat(Ct)).on("contextmenu",function(t){return t.preventDefault()});r.appendChild(t.el),this.sheet=new xl(t,this.data),null!==this.bottombar&&t.child(this.bottombar.el)}window&&(window.x_spreadsheet=Bl,window.x_spreadsheet.locale=function(t,e){return tt(t,e)}),e.default=ql}]);