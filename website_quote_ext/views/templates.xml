<odoo>
    <data>
        <template id="assets_frontend" inherit_id="website.assets_frontend" name="Shop">
            <xpath expr="." position="inside">
                <script type="text/javascript" src="/website_quote_ext/static/src/js/website_sale.js"></script>
            </xpath>
        </template>

        <template id="so_modify_content" inherit_id="website_quote.so_quotation" name="Modify Content">
            <xpath expr="//t/t/body/div[1]/div[1]/div[2]/div[8]/a[1]" position="after">
                <a class="btn btn-info" t-att-href="'/my/orders/edit/%s' % (quotation.id)" data-toggle="modal">
                    <i class="fa fa-check"></i>
                    Update Quantity
                </a>
            </xpath>
            <xpath expr="//t/t/body/div[1]/div[1]/div[2]/div[5]" position="replace">
                <div class="modal" id="modalaccept" role="dialog" aria-hidden="true">
                    <div class="modal-dialog">
                        <form id="accept" method="POST"
                              t-attf-action="/quote/#{quotation.id}/#{quotation.access_token}/accept"
                              class="modal-content">
                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                    &amp;times;
                                </button>
                                <h4 class="modal-title">Accept Order</h4>
                            </div>
                            <t t-if="quotation.partner_id.allow_purchase">
                                <div class="modal-body">
                                   Purchase Order #:
                                   <input type="text"
                                                   name="client_order_ref"
                                                   t-att-value="client_order_ref"/>
                                </div>
                             </t>
                            <div class="modal-body">
                                <p>
                                    Give your feedback, this will help us improve our services.
                                </p>
                                <textarea rows="4" name="accept_message" placeholder="Your feedback....."
                                          class="form-control"/>
                            </div>
                            <div class="modal-footer">
                                <button type="submit" t-object="order" class="btn btn-primary">Accept</button>
                                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                            </div>
                        </form>
                    </div>
                </div>
            </xpath>
            <xpath expr="//t/t/body/div[1]/div[1]/div[2]/div[6]" position="replace">
                <div class="modal" id="modaldecline" role="dialog" aria-hidden="true">
                    <div class="modal-dialog">
                        <form id="accept" method="POST"
                              t-attf-action="/quote/#{quotation.id}/#{quotation.access_token}/decline"
                              class="modal-content">
                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                    &amp;times;
                                </button>
                                <h4 class="modal-title">Reject</h4>
                            </div>
                            <div class="modal-body">
                                <p>
                                    Tell us why you are refusing this quotation, this will help us improve our
                                    services.
                                </p>
                                <textarea rows="4" name="decline_message" placeholder="Your feedback....."
                                          class="form-control"/>
                            </div>
                            <div class="modal-footer">
                                <button type="submit" t-object="order" class="btn btn-primary">Reject</button>
                                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </xpath>

        </template>

        <template id="cart_lines" name="Shopping Cart Lines">
            <!--<div t-if="not website_sale_order or not website_sale_order.website_order_line" class="js_cart_lines well well-lg">
              Your cart is empty!
            </div>-->
            <section id="quote" class="engine">
                <t t-foreach="quotation.order_lines_layouted()" t-as="page">
                    <table class="table table-striped table-condensed js_cart_lines" id="cart_products">
                        <thead>
                            <tr>
                                <th class="td-img">Product</th>
                                <th></th>
                                <th class="text-center td-qty">Quantity</th>
                                <th class="text-center td-price">Available Quantity</th>
                                <th class="text-center td-price">Unit Price</th>
                                <th class="text-center td-price">Total Price</th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-foreach="page" t-as="layout_category">
                                <t t-foreach="layout_category['lines']" t-as="line">
                                    <tr>
                                        <td colspan="2" t-if="not line.product_id.product_tmpl_id" class='td-img'></td>
                                        <td align="center" t-if="line.product_id.product_tmpl_id" class='td-img'>
                                            <span t-field="line.product_id.image_small"
                                                  t-options="{'widget': 'image', 'class': 'img-rounded'}"/>
                                        </td>
                                        <td t-if="line.product_id.product_tmpl_id" class='td-product_name'>
                                            <div>
                                                <a t-attf-href="/shop/product/#{ slug(line.product_id.product_tmpl_id) }">
                                                    <strong t-esc="line.product_id.with_context(display_default_code=False).display_name"/>
                                                </a>
                                            </div>
                                            <div class="text-muted hidden-xs small">
                                                <t t-foreach="line.name.splitlines()[1:]" t-as="name_line">
                                                    <span>
                                                        <t t-esc="name_line"/>
                                                    </span>
                                                    <br/>
                                                </t>
                                            </div>
                                            <a href='#' class='js_delete_product hidden-xs no-decoration'>
                                                <small>
                                                    <i class='fa fa-trash-o'></i>
                                                    Remove
                                                </small>
                                            </a>
                                        </td>
                                        <td class="text-center td-qty">
                                            <div class="css_quantity input-group oe_website_spinner">
                                                <a t-attf-href="#"
                                                   class="mb8 input-group-addon js_add_cart_json hidden-xs">
                                                    <i class="fa fa-minus"></i>
                                                </a>
                                                <input type="text" class="js_quantity form-control quantity"
                                                       t-att-data-quote-id="quotation.id" t-att-data-line-id="line.id"
                                                       t-att-data-product-id="line.product_id.id"
                                                       t-att-value="line.product_uom_qty"/>
                                                <a t-attf-href="#"
                                                   class="mb8 input-group-addon float_left js_add_cart_json hidden-xs">
                                                    <i class="fa fa-plus"></i>
                                                </a>
                                            </div>
                                        </td>
                                        <td class="text-center td-quantity" name="quantity">
                                            <!--  <div onload="startfun()"/>-->
                                            <!--<t t-call="website.fun()"/>-->
                                        </td>
                                        <td class="text-center td-price" name="price">
                                            <div t-field="line.price_unit"
                                                 t-options='{"widget": "monetary", "display_currency": quotation.pricelist_id.currency_id}'
                                                 t-att-style="line.discount and 'text-decoration: line-through' or None"
                                                 t-att-class="(line.discount and 'text-danger' or '') + ' text-right'"/>
                                        </td>
                                        <td class="text-right" groups="sale.group_show_price_subtotal">
                                            <div t-field="line.price_total" t-att-data-product-id="line.product_id.id">
                                                <t t-esc="(line.product_uom_qty*line.price_unit)"
                                                   t-options='{"widget": "monetary", "display_currency": quotation.pricelist_id.currency_id}'/>
                                            </div>
                                            <!--  <span  t-att-data-line-id="line.id" t-esc="line.product_uom_qty*line.price_unit"
                                                    t-options='{"widget": "monetary", "display_currency": quotation.pricelist_id.currency_id}'/>-->
                                        </td>
                                    </tr>
                                </t>
                            </t>
                            <tr>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td class="text-right">
                                    <strong>Total:</strong>
                                </td>
                                <td class="text-right">
                                    <strong data-id="total_amount" t-field="quotation.amount_total"
                                            t-options='{"widget": "monetary","display_currency": quotation.pricelist_id.currency_id}'/>
                                </td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </t>
            </section>
        </template>

        <template id="engine_pricing" name="Price">
            <section id="quote" class="engine">
                <h1 class="page-header">Prioritization Pricing</h1>
                <t t-foreach="quotation.order_lines_layouted()" t-as="page">
                    <table class="table wq-table">
                        <thead>
                            <tr>
                                <th>Products</th>
                                <th>Quantity</th>
                                <th>
                                    <span t-if="any([line.tax_id for line in quotation.order_line])">Taxes</span>
                                </th>
                                <th>
                                    <span t-if="True in [line.discount > 0 for line in quotation.order_line]">Discount
                                    </span>
                                </th>
                                <th class="text-right">Unit Price</th>
                                <th class="text-right" groups="sale.group_show_price_subtotal">Amount</th>
                                <th class="text-right price_tax_included" groups="sale.group_show_price_total">Total
                                    Price
                                </th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-foreach="page" t-as="layout_category">
                                <t t-if="layout_category_size > 1 or page_size > 1" groups="sale.group_sale_layout">
                                    <tr class="active">
                                        <td colspan="7" style="font-weight: bold; border-bottom: 1px solid black;">&amp;bull;
                                            <t t-esc="layout_category['name']"/>
                                        </td>
                                    </tr>
                                </t>
                                <!-- Lines associated -->
                                <t t-foreach="layout_category['lines']" t-as="line">
                                    <tr>
                                        <td>
                                            <span t-field="line.name"/>
                                        </td>
                                        <td class="text-center td-qty">
                                            <div class="css_quantity input-group oe_website_spinner">
                                                <a t-attf-href="#"
                                                   class="mb8 input-group-addon js_add_cart_json hidden-xs">
                                                    <i class="fa fa-minus"></i>
                                                </a>
                                                <input type="text" class="js_quantity form-control quantity"
                                                       t-att-data-quote-id="quotation.id" t-att-data-line-id="line.id"
                                                       t-att-data-product-id="line.product_id.id"
                                                       t-att-value="line.product_uom_qty"/>
                                                <a t-attf-href="#"
                                                   class="mb8 input-group-addon float_left js_add_cart_json hidden-xs">
                                                    <i class="fa fa-plus"></i>
                                                </a>
                                            </div>
                                        </td>
                                        <td>
                                            <div t-foreach="line.tax_id" t-as="tax">
                                                <t t-esc="tax.name"/>
                                            </div>
                                        </td>
                                        <td>
                                            <strong t-if="line.discount" class="text-info">
                                                <t t-esc="((line.discount % 1) and '%s' or '%d') % line.discount"/>%
                                                discount
                                            </strong>
                                        </td>
                                        <!--<td class="text-center td-price" name="price">
                                              <t t-if="(compute_currency(line.product_id.lst_price) - line.price_reduce ) &gt; 0.01">
                                                  <del t-attf-class="#{'text-danger mr8'}" style="white-space: nowrap;" t-esc="compute_currency(line.product_id.website_public_price)" t-options="{'widget': 'monetary', 'display_currency': website.get_current_pricelist().currency_id, 'from_currency': website.currency_id}" />
                                              </t>
                                              &lt;!&ndash;<span t-field="line.price_reduce_taxexcl" style="white-space: nowrap;" t-options="{'widget': 'monetary', 'from_currency': website_sale_order.pricelist_id.currency_id, 'display_currency': website.currency_id}" groups="sale.group_show_price_subtotal" />
                                              <span t-field="line.price_reduce_taxinc" style="white-space: nowrap;" t-options="{'widget': 'monetary', 'from_currency': website_sale_order.pricelist_id.currency_id, 'display_currency': website.currency_id}" groups="sale.group_show_price_total" />&ndash;&gt;
                                        </td>-->
                                        <td class="text-right">
                                            <div t-field="line.price_unit"
                                                 t-options='{"widget": "monetary", "display_currency": quotation.pricelist_id.currency_id}'
                                                 t-att-style="line.discount and 'text-decoration: line-through' or None"
                                                 t-att-class="(line.discount and 'text-danger' or '') + ' text-right'"/>
                                            <div t-if="line.discount">
                                                <t t-esc="(1-line.discount / 100.0) * line.price_unit"
                                                   t-options='{"widget": "monetary", "display_currency": quotation.pricelist_id.currency_id}'/>
                                            </div>
                                        </td>
                                        <td class="text-right" groups="sale.group_show_price_subtotal">
                                            <div t-field="line.price_total" t-att-data-product-id="line.product_id.id">
                                                <t t-esc="(line.product_uom_qty*line.price_unit)"
                                                   t-options='{"widget": "monetary", "display_currency": quotation.pricelist_id.currency_id}'/>
                                            </div>
                                            <!--  <span  t-att-data-line-id="line.id" t-esc="line.product_uom_qty*line.price_unit"
                                                    t-options='{"widget": "monetary", "display_currency": quotation.pricelist_id.currency_id}'/>-->
                                        </td>
                                        <!--<td class="text-right price_total" groups="sale.group_show_price_total">-->
                                        <!--<span t-field="line.price_total" t-esc="compute_currency(line.product_uom_qty,line.price_unit)"-->
                                        <!--t-options='{"widget": "monetary", "display_currency": quotation.pricelist_id.currency_id}'/>-->
                                        <!--</td>-->
                                        <td class="text-center">
                                            <a t-attf-href="./update_line/#{ line.id }/?order_id=#{ quotation.id }&amp;unlink=True&amp;token=#{ quotation.access_token }"
                                               class="mb8 js_update_line_json hidden-print" t-if="line.option_line_id">
                                                <span class="fa fa-trash-o"></span>
                                            </a>
                                        </td>
                                    </tr>
                                </t>

                                <t t-if="(layout_category_size > 1  or page_size > 1) and layout_category['subtotal']"
                                   groups="sale.group_sale_layout">
                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td class="text-right" style="padding-bottom: 32px">
                                            <strong>Subtotal:</strong>
                                        </td>
                                        <td class="text-right" style="padding-bottom: 32px">
                                            <t t-set="subtotal"
                                               t-value="sum(line.price_subtotal for line in layout_category['lines'])"/>
                                            <strong data-id="total_amount" t-esc="subtotal"
                                                    t-options="{'widget': 'monetary', 'display_currency': quotation.pricelist_id.currency_id}"/>
                                        </td>
                                        <td></td>
                                    </tr>
                                </t>
                            </t>
                            <t t-if="page_index == page_size - 1">
                                <t t-if="any([line.tax_id for line in quotation.order_line])">
                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td class="text-right">
                                            <strong>Subtotal:</strong>
                                        </td>
                                        <td class="text-right">
                                            <strong data-id="total_amount" t-field="quotation.amount_untaxed"
                                                    t-options='{"widget": "monetary","display_currency": quotation.pricelist_id.currency_id}'/>
                                        </td>
                                        <td></td>
                                    </tr>

                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td class="text-right">Taxes:</td>
                                        <td class="text-right">
                                            <span data-id="total_amount" t-field="quotation.amount_tax"
                                                  t-options='{"widget": "monetary","display_currency": quotation.pricelist_id.currency_id}'/>
                                        </td>
                                        <td></td>
                                    </tr>
                                </t>
                                <tr>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td class="text-right">
                                        <strong>Total:</strong>
                                    </td>
                                    <td class="text-right">
                                        <strong data-id="total_amount" t-field="quotation.amount_total"
                                                t-options='{"widget": "monetary","display_currency": quotation.pricelist_id.currency_id}'/>
                                    </td>
                                    <td></td>
                                </tr>
                            </t>
                        </tbody>
                    </table>

                    <t t-if="page_index &lt; page_size - 1" groups="sale.group_sale_layout">
                        <p style="page-break-before:always;"></p>
                    </t>

                </t>
            </section>
            <section id="terms" class="container" t-if="quotation.note">
                <h2 class="page-header">Terms &amp; Conditions</h2>
                <p t-field="quotation.note"/>
            </section>
        </template>

        <template id="portal_order_page_ex" name="Sales Order">
            <t t-call="portal.portal_layout">
                <t t-set="sales_order"
                   t-value="order"/> <!-- rename to ensure breadcrumb compatibility (differentiate with purchase orders) -->
                <t t-set="invoices" t-value="[i for i in order.invoice_ids if i.state not in ['draft', 'cancel']]"/>
                <t t-set="invoices_amount" t-value="sum(i.amount_total for i in invoices)"/>
                <div id="optional_placeholder"></div>
                <div class="container">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <div class="row">
                                <div class="col-md-6 col-xs-9 col-sm-9">
                                    <h4>
                                        <t t-call='portal.record_pager'/>
                                        <t t-if="order.state in ('sent', 'cancel')">Quotation</t>
                                        <t t-else="">Order</t>
                                        <span t-esc="order.name"/>
                                        <t t-if="order.state == 'cancel'">
                                            <span class="label label-default">
                                                <i class="fa fa-fw fa-remove"/>
                                                Cancelled
                                            </span>
                                        </t>
                                        <t t-if="order.state == 'done'">
                                            <span class="label label-success">
                                                <i class="fa fa-fw fa-check"/>
                                                Done
                                            </span>
                                        </t>
                                    </h4>
                                </div>
                                <div class="col-md-6 col-sm-3 col-xs-3 hidden-print" id="o_portal_order_actions">
                                    <t t-if="order.state == 'sent' and portal_confirmation == 'sign'"
                                       name="portal_confirmation_sign">
                                        <a class="btn btn-primary ml8 pull-right" href="#portal_sign">
                                            <i class="fa fa-arrow-circle-right"/>
                                            Accept
                                        </a>
                                    </t>
                                    <t t-if="order.state == 'sale' and portal_confirmation == 'sign'">
                                        <a class="btn btn-success ml8 pull-right" disabled="disabled"
                                           t-attf-title="Order signed on #{order.confirmation_date} by #{order.partner_id.name}">
                                            <i class="fa fa-check-circle"/>
                                            Signed
                                        </a>
                                    </t>
                                     <t t-if="order.amount_total != 0">
                                    <a target="_blank" t-att-href="'/my/orders/pdf/%s?%s' % (order.id, keep_query())"
                                       class="ml8 pull-right mt4 mr8" title="Download">
                                        <i class="fa fa-download fa-2x" aria-hidden="true"/>
                                    </a>
                                     </t>
                                </div>
                            </div>
                        </div>
                        <div class="panel-body engine">
                            <t t-if="error or warning" t-call="sale.portal_order_error"/>
                            <t t-if="success and (not error and not warning)" t-call="sale.portal_order_success"/>
                            <div class="mb8">
                                <strong>Date:</strong>
                                <span t-field="order.create_date" t-options='{"widget": "date"}'/>
                            </div>
                            <div class="mb8" t-if="order.validity_date">
                                <strong>Expiration Date:</strong>
                                <span t-field="order.validity_date" t-options='{"widget": "date"}'/>
                            </div>
                            <div class='row'>
                                <div class="col-md-6">
                                    <div>
                                        <strong>Invoicing Address</strong>
                                    </div>
                                    <div>
                                        <address t-field="order.partner_invoice_id"
                                                 t-options='{"widget": "contact", "fields": ["address", "name"], "no_marker": True}'/>
                                    </div>
                                    <t t-if="invoices">
                                        <div>
                                            <strong>Invoices</strong>
                                        </div>
                                        <div>
                                            <t t-foreach="invoices" t-as="i">
                                                <t t-set="report_url"
                                                   t-value="'/my/invoices/pdf/%s?%s' % (i.id, 'access_token=%s' % i.access_token if access_token else '')"/>
                                                <div>
                                                    <a t-att-href="report_url">
                                                        <span class="fa fa-download"/>
                                                    </a>
                                                    <a t-att-href="report_url">
                                                        <span t-esc="i.number"/>
                                                    </a>
                                                    <span class="text-muted" t-field="i.date_invoice"/>
                                                    <t t-if="i.state == 'paid'">
                                                        <span class="label label-success orders_label_text_align">
                                                            <i class="fa fa-fw fa-check"/>
                                                            Paid
                                                        </span>
                                                    </t>
                                                    <t t-if="i.state != 'paid'">
                                                        <span class="label label-info orders_label_text_align">
                                                            <i class="fa fa-fw fa-clock-o"/>
                                                            Waiting
                                                        </span>
                                                    </t>
                                                </div>
                                            </t>
                                        </div>
                                    </t>
                                </div>
                                <div id="shipping_address" class="col-md-6"
                                     groups="sale.group_delivery_invoice_address">
                                    <div>
                                        <strong>Shipping Address</strong>
                                    </div>
                                    <div>
                                        <address t-field="order.partner_shipping_id"
                                                 t-options='{"widget": "contact", "fields": ["address", "name"], "no_marker": True}'/>
                                    </div>
                                </div>
                            </div>
                            <hr/>
                            <div class="row">
                                <div class="col-md-6">
                                    <strong>Product</strong>
                                </div>
                                <div class="hidden-sm hidden-xs col-md-2 text-right">
                                    <strong>Unit Price</strong>
                                </div>
                                <div class="hidden-sm hidden-xs col-md-2 text-center">
                                    <strong>Quantity</strong>
                                </div>
                                <!--  <div class="hidden-sm hidden-xs col-md-2 text-center">
                                    <strong>Available Quantity</strong>
                                  </div>-->
                                <div class="hidden-sm hidden-xs col-md-2 text-right">
                                    <strong>Subtotal</strong>
                                </div>

                            </div>
                            <t t-foreach="order.order_line" t-as="ol">
                                <t t-if="ol.product_uom_qty != 0">
                                <div class="row orders_vertical_align">
                                    <div class="visible-lg col-lg-1 text-center">
                                        <span t-field="ol.product_image"
                                              t-options="{'widget': 'image', 'class': 'img-rounded', 'style':'width: 48px;height:48px'}"/>
                                    </div>
                                    <div id='product_name' class="col-lg-4 col-sm-6 col-xs-3">
                                        <span t-esc="ol.product_id.name"/>
                                    </div>
                                    <div class="col-xs-3 text-right">
                                        <span t-field="ol.price_unit"
                                              t-options='{"widget": "monetary", "display_currency": order.pricelist_id.currency_id}'/>
                                    </div>
                                    <t t-if="ol._name == 'sale.order.line'">
                                        <div class="col-xs-2 text-right">
                                            <t t-if="order.state == 'sent'">
                                                <div class="css_quantity input-group oe_website_spinner">
                                                    <a t-attf-href="#"
                                                       class="mb8 input-group-addon js_add_cart_json hidden-xs">
                                                        <i class="fa fa-minus"></i>
                                                    </a>
                                                    <input type="text" class="js_quantity form-control quantity"
                                                           t-att-data-quote-id="ol.order_id.id"
                                                           t-att-data-line-id="ol.id"
                                                           t-att-data-product-id="ol.product_id.id"
                                                           t-att-value="ol.product_uom_qty"/>
                                                    <a t-attf-href="#"
                                                       class="mb8 input-group-addon float_left js_add_cart_json hidden-xs">
                                                        <i class="fa fa-plus"></i>
                                                    </a>
                                                </div>
                                            </t>
                                            <t t-if="order.state != 'sent'">
                                                <span t-esc="ol.product_uom_qty"/>
                                            </t>
                                        </div>
                                    </t>
                                    <div class="col-sm-2 col-xs-4 text-right">
                                        <span t-field="ol.price_subtotal"
                                              t-options='{"widget": "monetary", "display_currency": order.pricelist_id.currency_id}'/>
                                        <input type="hidden" class="js_quantity form-control quantity"
                                                           t-att-data-quote-id="ol.order_id.id"
                                                           t-att-data-line-id="ol.id"
                                                           t-att-data-product-id="ol.product_id.id"
                                                           t-att-value="ol.product_uom_qty"/>
                                        <span>  </span>
                                        <a href='#' class='js_delete_product hidden-xs no-decoration'> <small>  <i class='fa fa-trash-o'></i></small></a>
                                    </div>
                                </div>
                                </t>
                            </t>

                            <hr/>

                            <div class="row">
                                <div class="col-md-6">
                                    <div>
                                        <div>
                                            <strong>Contact</strong>
                                        </div>
                                        <div t-field="order.user_id.partner_id"
                                             t-options='{"widget": "contact", "fields": ["email", "phone"]}'/>
                                        <br/>
                                    </div>
                                    <div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="row mb4">
                                        <div class="col-md-9 col-xs-8 text-right">
                                            <strong>Subtotal</strong>
                                        </div>
                                        <div class="col-md-3 col-xs-4 text-right">
                                            <strong>
                                                <span t-field="order.amount_untaxed"
                                                      t-options='{"widget": "monetary", "display_currency": order.pricelist_id.currency_id}'/>
                                            </strong>
                                        </div>
                                    </div>
                                    <div class="row mb4">
                                        <t t-set="tax_groups" t-value="order._get_tax_amount_by_group()"/>
                                        <t t-foreach="tax_groups" t-as="amount_by_group">
                                            <t t-if="len(tax_groups) == 1 and order.amount_untaxed == amount_by_group[2]">
                                                <div class="col-md-9 col-xs-8 text-right">
                                                    <span t-esc="amount_by_group[0]"/>
                                                </div>
                                                <div class="col-md-3 col-xs-4 text-right">
                                                    <span t-esc="amount_by_group[1]"
                                                          t-options='{"widget": "monetary", "display_currency": order.pricelist_id.currency_id}'/>
                                                </div>
                                            </t>
                                            <t t-else="">
                                                <div class="col-md-9 col-xs-8 text-right">
                                                    <span t-esc="amount_by_group[0]"/>
                                                    <span>&amp;nbsp;<span>on</span>&amp;nbsp;
                                                        <t t-esc="amount_by_group[2]"
                                                           t-options='{"widget": "monetary", "display_currency": order.pricelist_id.currency_id}'/>
                                                    </span>
                                                </div>
                                                <div class="col-md-3 col-xs-4 text-right">
                                                    <span t-esc="amount_by_group[1]"
                                                          t-options='{"widget": "monetary", "display_currency": order.pricelist_id.currency_id}'/>
                                                </div>
                                            </t>
                                        </t>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-9 col-xs-8 text-right">
                                            <strong>Total</strong>
                                        </div>
                                        <div class="col-md-3 col-xs-4 text-right">
                                            <strong>
                                                <span t-field="order.amount_total"
                                                      t-options='{"widget": "monetary", "display_currency": order.pricelist_id.currency_id}'/>
                                            </strong>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="text-center hidden-print mt16 mb16" id="portal_sign">
                             <t t-if="order.amount_total != 0">
                            <a class="btn btn-success" data-toggle="modal" data-target="#accept">
                                <i class="fa fa-check"></i>
                                Accept
                            </a>
                             </t>
                            <a class="btn btn-danger" data-toggle="modal" data-target="#decline">
                                <i class="fa fa-times"></i>
                                Reject
                            </a>
                            <!--<div class="row" t-if="order.state == 'sent' and portal_confirmation == 'sign'" id="portal_sign">-->
                            <!--<div class="col-md-offset-3 col-md-6">-->
                            <!--<h4>Accept &amp; Sign</h4>-->
                            <!--<t t-call="portal.portal_signature">-->
                            <!--<t t-set="object" t-value="order"/>-->
                            <!--<t t-set="partner_name" t-value="order.partner_id.name"/>-->
                            <!--<t t-set="callUrl" t-value="'/my/quotes/accept'"/>-->
                            <!--<t t-set="signLabel" t-value="'Accept Order'"/>-->
                            <!--<t t-set="accessToken" t-value="order.access_token"/>-->
                            <!--</t>-->
                            <!--</div>-->
                            <!--</div>-->
                        </div>
                        <div class="modal" id="accept" role="dialog" aria-hidden="true">
                            <div class="modal-dialog">
                                <form id="accept" method="POST"
                                      t-attf-action="/quote/#{order.id}/#{order.access_token}/accept"
                                      class="modal-content">
                                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>

                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                            &amp;times;
                                        </button>
                                        <h4 class="modal-title">Accept Order</h4>
                                    </div>
                                     <t t-if="order.partner_id.allow_purchase">
                                            <div class="modal-body">
                                               Purchase Order #:
                                               <input type="text" class="form-control"
                                                               name="client_order_ref"
                                                               t-att-value="client_order_ref"/>
                                            </div>
                                      </t>
                                    <div class="modal-body">
                                        <p>
                                            Give your feedback, this will help us improve our services.
                                        </p>
                                        <textarea rows="4" name="accept_message" placeholder="Your feedback....."
                                                  class="form-control"/>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="submit" t-object="order" class="btn btn-primary">Accept</button>
                                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <div class="modal" id="decline" role="dialog" aria-hidden="true">
                            <div class="modal-dialog">
                                <form id="accept" method="POST"
                                      t-attf-action="/quote/#{order.id}/#{order.access_token}/decline"
                                      class="modal-content">
                                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                            &amp;times;
                                        </button>
                                        <h4 class="modal-title">Reject</h4>
                                    </div>
                                    <div class="modal-body">
                                        <p>
                                            Tell us why you are refusing this quotation, this will help us improve our
                                            services.
                                        </p>
                                        <textarea rows="4" name="decline_message" placeholder="Your feedback....."
                                                  class="form-control"/>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="submit" t-object="order" class="btn btn-primary">Reject</button>
                                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="oe_structure mb32"/>
            </t>
        </template>

        <template id="portal_my_home_vendor_offer" name="Portal My Home : vendor offer entry"
                  inherit_id="portal.portal_my_home" priority="25">
            <xpath expr="//ul[hasclass('o_portal_docs')]" position="inside">
                <li t-if="vendor_count" class="list-group-item">
                    <span class="badge" t-esc="vendor_count"/>
                    <a href="/my/vendor">Vendor Offer</a>
                </li>
            </xpath>
        </template>

        <template id="portal_my_vendor_offers" name="Portal: My Vendor Offers">
            <t t-call="portal.portal_layout">
                <h3>Vendor Offers
                    <t t-call="portal.portal_searchbar"/>
                </h3>
                <div t-if="orders" class="panel panel-default">
                    <div class="table-responsive">
                        <table class="table table-hover o_portal_my_doc_table">
                            <thead>
                                <tr class="active">
                                    <th>Vendor Offerd #</th>
                                    <th>Order Date</th>
                                    <th></th>
                                    <th>Total</th>
                                </tr>
                            </thead>
                            <t t-foreach="orders" t-as="order">
                                <tr>
                                    <td>
                                        <a t-attf-href="/my/vendor/#{order.id}?#{keep_query()}">
                                            <t t-esc="order.name"/>
                                        </a>
                                    </td>
                                    <td>
                                        <span t-field="order.date_order"/>
                                    </td>
                                    <td>
                                        <t t-if="order.state == 'cancel'">
                                            <span class="label label-default">
                                                <i class="fa fa-fw fa-remove"/>
                                                Cancelled
                                            </span>
                                        </t>
                                    </td>
                                    <td>
                                        <span t-field="order.amount_total"
                                              t-options='{"widget": "monetary", "display_currency": order.currency_id}'/>
                                    </td>
                                </tr>
                            </t>
                        </table>
                    </div>
                    <div t-if="pager" class="o_portal_pager text-center">
                        <t t-call="portal.pager"/>
                    </div>
                </div>
            </t>
        </template>

        <template id="portal_my_vendor_offer" name="Portal: My Vendor Offer">
            <t t-call="portal.portal_layout">
                <t t-set="vendor_offer" t-value="order"/>
                <div id="optional_placeholder"></div>
                <div class="container">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <div class="row">
                                <div class="col-md-12">
                                    <h4>
                                        <t t-call='portal.record_pager'/>
                                        Vendor Offer
                                        <span t-esc="order.name"/>
                                    </h4>
                                </div>
                            </div>
                        </div>
                        <div class="panel-body">
                            <div class="mb8">
                                <strong>Date:</strong>
                                <span t-field="order.date_order" t-options='{"widget": "date"}'/>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <strong>Product</strong>
                                </div>
                                <div class="col-md-2 text-right">
                                    <strong>Unit Price</strong>
                                </div>
                                <div class="col-md-2 text-right">
                                    <strong>Quantity</strong>
                                </div>
                                <div class="col-md-2 text-right">
                                    <strong>Subtotal</strong>
                                </div>
                            </div>
                            <t t-foreach="order.order_line" t-as="ol">
                                <div class="row purchases_vertical_align">
                                    <div class="col-md-1 text-center">
                                        <img t-att-src="'/web/image/purchase.order.line/%s/product_image/48x48' % ol.id"/>
                                    </div>
                                    <div id='product_name' class="col-md-5">
                                        <span t-esc="ol.product_id.name"/>
                                    </div>
                                    <div class="col-md-2 text-right">
                                        <span t-field="ol.price_unit"
                                              t-options='{"widget": "monetary", "display_currency": order.currency_id}'/>
                                    </div>
                                    <div class="col-md-2 text-right">
                                        <span t-esc="ol.product_qty"/>
                                    </div>
                                    <div class="col-md-2 text-right">
                                        <span t-field="ol.price_subtotal"
                                              t-options='{"widget": "monetary", "display_currency": order.currency_id}'/>
                                    </div>
                                </div>
                            </t>

                            <hr/>

                            <div class="row">
                                <div class="col-md-12 text-right">
                                    <div class="row">
                                        <div class="col-md-10 text-right">
                                            Untaxed Amount:
                                        </div>
                                        <div class="col-md-2 text-right">
                                            <span t-field="order.amount_untaxed"
                                                  t-options='{"widget": "monetary", "display_currency": order.currency_id}'/>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-10 text-right">
                                            Taxes:
                                        </div>
                                        <div class="col-md-2 text-right">
                                            <span t-field="order.amount_tax"
                                                  t-options='{"widget": "monetary", "display_currency": order.currency_id}'/>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-10 text-right">
                                            <strong>Total:</strong>
                                        </div>
                                        <div class="col-md-2 text-right">
                                            <strong>
                                                <span t-field="order.amount_total"
                                                      t-options='{"widget": "monetary", "display_currency": order.currency_id}'/>
                                            </strong>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div t-if="order.state != 'cancel'" class="text-center hidden-print mt16 mb16"
                         id="quotation_toolbar">
                        <a class="btn btn-success" data-target="#modalaccept" data-toggle="modal">
                            <i class="fa fa-check"></i>
                            Accept
                        </a>
                        <a class="btn btn-danger" data-target="#modaldecline" data-toggle="modal">
                            <i class="fa fa-times"></i>
                            Reject
                        </a>
                    </div>
                    <div class="modal fade" id="modalaccept" role="dialog" aria-hidden="true">
                        <div class="modal-dialog">
                            <form id="accept" method="POST" t-att-data-order-id="order.id"
                                  class="js_accept_json modal-content js_website_submit_form">
                                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&amp;times;</button>
                                    <h4 class="modal-title">Validate Order</h4>
                                </div>
                                <div class="modal-body" id="sign-dialog">
                                    <!--<p>
                                        <span>I agree that by signing this proposal, I
                                        accept it on the behalf of </span><b t-field="order.partner_id.commercial_partner_id"/><span>, for an amount of </span>
                                        <b data-id="total_amount" t-field="order.amount_total"
                                            t-options='{"widget": "monetary", "display_currency": order.pricelist_id.currency_id}'/>
                                        <span>with payment terms: </span><b t-field="order.payment_term_id"/>.
                                    </p>-->
                                    <t t-call="portal.portal_signature">
                                        <t t-set="object" t-value="order"/>
                                        <t t-set="partner_name" t-value="order.partner_id.name"/>
                                        <t t-set="callUrl" t-value="'/vendor_offer/accept/'"/>
                                        <t t-set="order_id" t-value="order.id"/>
                                    </t>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="modal fade" id="modaldecline" role="dialog" aria-hidden="true">
                        <div class="modal-dialog">
                            <form id="reject" method="POST" t-att-data-order-id="order.id"
                                  class="js_reject_json modal-content js_website_submit_form">
                                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&amp;times;</button>
                                    <h4 class="modal-title">Reject Order</h4>
                                </div>
                                <div class="modal-body" id="sign-dialog">
                                    <!--<p>
                                        <span>I agree that by signing this proposal, I
                                        accept it on the behalf of </span><b t-field="order.partner_id.commercial_partner_id"/><span>, for an amount of </span>
                                        <b data-id="total_amount" t-field="order.amount_total"
                                            t-options='{"widget": "monetary", "display_currency": order.pricelist_id.currency_id}'/>
                                        <span>with payment terms: </span><b t-field="order.payment_term_id"/>.
                                    </p>-->
                                    <t t-call="portal.portal_signature">
                                        <t t-set="object" t-value="order"/>
                                        <t t-set="partner_name" t-value="order.partner_id.name"/>
                                        <t t-set="callUrl" t-value="'/vendor_offer/reject/'"/>
                                        <t t-set="order_id" t-value="order.id"/>
                                    </t>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </t>
        </template>

        <template id="portal_my_home_menu_vendor" name="Portal layout : vendor menu entries"
                  inherit_id="portal.portal_layout" priority="20">
            <xpath expr="//ol[hasclass('o_portal_submenu')]" position="inside">
                <li t-if="vendor_offer and vendor_offer.state in ('ven_sent', 'cancel')">
                    <a t-if="vendor_offer" t-attf-href="/my/vendor?{{ keep_query() }}">Vendor Offer</a>
                    <t t-else="">Vendor Offer</t>
                </li>
            </xpath>
        </template>
    </data>
</odoo>