<odoo>
    <data>
        <template id="assets_frontend" inherit_id="website.assets_frontend" name="Shop">
            <xpath expr="." position="inside">
                <script type="text/javascript" src="/website_quote_ext/static/src/js/website_sale.js"></script>
            </xpath>
        </template>

        <template id="so_quotation_content_inherit" inherit_id="sale.sale_order_portal_content" name="Quotation Content">
            <xpath expr="//div[@id='informations']/div[2]" position="before">
                <div class="mb-3">
                    <strong>Customer:</strong> <span t-field="sale_order.partner_id"/>
                </div>
            </xpath>


            <xpath expr="//div[@id='introduction']" position="replace">
                 <div id="introduction" t-attf-class="pb-2 pt-3 #{'card-header bg-white' if report_type == 'html' else ''}">
                     <h2 class="my-0">
                         <span t-field="sale_order.type_name"></span>
                         <em t-esc="sale_order.name"/>
                         <span class="txt-cen">
                             <t t-if="sale_order.state == 'sent'">
                                 <small>
                                     Quotation Sent
                                 </small>
                             </t>
                             <t t-if="sale_order.state == 'cancel'">
                                 <span style="font-size:1rem;vertical-align: top;" class="label label-default">
                                     <i class="fa fa-fw fa-remove"/>
                                     Cancelled
                                 </span>
                             </t>
                             <t t-if="sale_order.state == 'done'">
                                 <span style="font-size:1rem;vertical-align: top;" class="label label-success">
                                     <i class="fa fa-fw fa-check"/>
                                     Done
                                 </span>
                             </t>
                         </span>
                     </h2>
                </div>
            </xpath>

            <xpath expr="//div[2]/div" position="inside">
                <label t-if="sale_order.partner_id.gl_account.name" class="col-sm-4 col-xs-4 text-right">GL Account:</label>
                <div class="col-sm-8 col-xs-8">
                    <div t-if="sale_order.partner_id.gl_account.name" t-field="sale_order.partner_id.gl_account.name"/>
                </div>
            </xpath>
        </template>

        <template id="so_modify_content" inherit_id="sale.sale_order_portal_template" name="Modify Content">
            <xpath expr="//div[hasclass('justify-content-center')]" position="replace">
                 <div class="text-right hidden-print mt16 mb16" id="quotation_toolbar" t-if="sale_order.state in ('draft', 'sent', 'waiting_date')">
                          <a class="btn btn-danger" data-toggle="modal" data-target="#modaldecline">
                              Reject
                          </a>
                          <a class="btn btn-success" data-toggle="modal" data-target="#modalaccept">
                              Accept
                          </a>

                          <a class="text-right btn btn-info" t-att-href="'/my/orders/edit/%s' % (sale_order.id)">
                                   <b><u>Update Quantity</u></b>
                          </a>
                 </div>
            </xpath>

            <xpath expr="//div[@id='modalaccept']" position="replace">
                <div role="dialog" class="modal fade" id="modalaccept">
                    <div class="modal-dialog">
			            <form id="accept" method="POST" t-attf-action="/my/orders/#{sale_order.id}/accepts?access_token=#{sale_order.access_token}" class="modal-content">
                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>

                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                    &amp;times;
                                </button>
                                <h4 class="modal-title">Accept Order</h4>
                            </div>
                             <t t-if="sale_order.partner_id.allow_purchase">
                                    <div class="modal-body">
                                       Purchase Order #:
                                       <input type="text" class="form-control"
                                                       name="client_order_ref"
                                                       t-att-value="client_order_ref"/>
                                    </div>
                              </t>
                            <div class="modal-body">
                                <p>
                                   Your Order will be shipped Ground unless otherwise stated. If expedited shipping is needed, Please indicate below:
                                    (First Overnight by 8:30AM / Priority Overnight by 10:30AM /2nd day AM by 10:30 AM /2nd Day /3rd Day)
                                </p>
                                <textarea rows="4" name="accept_message" placeholder="Your feedback....."
                                          class="form-control"/>
                            </div>
                            <div class="modal-footer">
                                <button type="submit" t-object="order" class="btn btn-primary">Accept</button>
                                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                            </div>
                        </form>
                    </div>
                </div>


                <div t-if="sale_order.state == 'sale'" class="alert alert-success alert-dismissable d-print-none" role="alert">
                        <button type="button" class="close" data-dismiss="alert" aria-label="close">&amp;times;</button>
                        <strong>     This order has been validated. Thanks for your trust
                            and do not hesitate to</strong> <a role="button" href="#discussion"><i class="fa fa-comment"/> Contact us</a><strong> for any question.</strong>
                </div>

            </xpath>
            <xpath expr="//div[@id='modaldecline']" position="replace">
                <div role="dialog" class="modal fade" id="modaldecline">
                    <div class="modal-dialog">
                        <form id="decline" method="POST" t-attf-action="/my/orders/#{sale_order.id}/declines?access_token=#{sale_order.access_token}" class="modal-content">
                        <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                    &amp;times;
                                </button>
                                <h4 class="modal-title">Reject</h4>
                            </div>
                            <div class="modal-body">
                                <p>
                                    Tell us why you are refusing this quotation, this will help us improve our
                                    services.
                                </p>
                                <textarea rows="4" name="decline_message" placeholder="Your feedback....."
                                          class="form-control"/>
                            </div>
                            <div class="modal-footer">
                                <button type="submit" t-object="order" class="btn btn-primary btn btn-danger">Reject</button>
                                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </xpath>
            <xpath expr="//li[hasclass('navspy')]" position="replace" />
        </template>

        <template id="cart_lines" name="Shopping Cart Lines">
            <section id="quote" class="engine">
                    <table class="table table-striped table-condensed js_cart_lines" id="cart_products">
                        <thead>
                            <tr>
                                <th class="td-img">Product</th>
                                <th></th>
                                <th class="text-center td-qty">Quantity</th>
                                <th class="text-center td-price">Available Quantity</th>
                                <th class="text-center td-price">Unit Price</th>
                                <th class="text-center td-price">Total Price</th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-foreach="page" t-as="layout_category">
                                <t t-foreach="layout_category['lines']" t-as="line">
                                    <tr>
                                        <td colspan="2" t-if="not line.product_id.product_tmpl_id" class='td-img'></td>
                                        <td align="center" t-if="line.product_id.product_tmpl_id" class='td-img'>
                                            <span t-field="line.product_id.image_small"
                                                  t-options="{'widget': 'image', 'class': 'img-rounded'}"/>
                                        </td>
                                        <td t-if="line.product_id.product_tmpl_id" class='td-product_name'>
                                            <div>
                                                <a t-attf-href="/shop/product/#{ slug(line.product_id.product_tmpl_id) }">
                                                    <strong t-esc="line.product_id.with_context(display_default_code=False).display_name"/>
                                                </a>
                                            </div>
                                            <div class="text-muted hidden-xs small">
                                                <t t-foreach="line.name.splitlines()[1:]" t-as="name_line">
                                                    <span>
                                                        <t t-esc="name_line"/>
                                                    </span>
                                                    <br/>
                                                </t>
                                            </div>
                                            <a href='#' class='js_delete_product hidden-xs no-decoration'>
                                                <large>
                                                    <i class='fa fa-trash-o'></i>
                                                    Remove
                                                </large>
                                            </a>
                                        </td>
                                        <td class="text-center td-qty">
                                            <div class="css_quantity input-group oe_website_spinner">
                                                <a t-attf-href="#"
                                                   class="mb8 input-group-addon js_add_cart_json hidden-xs">
                                                    <i class="fa fa-minus"></i>
                                                </a>
                                                <input type="text" class="js_quantity form-control quantity"
                                                       t-att-data-quote-id="quotation.id" t-att-data-line-id="line.id"
                                                       t-att-data-product-id="line.product_id.id"
                                                       t-att-value="line.product_uom_qty"/>
                                                <a t-attf-href="#"
                                                   class="mb8 input-group-addon float_left js_add_cart_json hidden-xs">
                                                    <i class="fa fa-plus"></i>
                                                </a>
                                            </div>
                                        </td>
                                        <td class="text-center td-quantity" name="quantity">
                                        </td>
                                        <td class="text-center td-price" name="price">
                                            <div t-field="line.price_unit"
                                                 t-options='{"widget": "monetary", "display_currency": quotation.pricelist_id.currency_id}'
                                                 t-att-style="line.discount and 'text-decoration: line-through' or None"
                                                 t-att-class="(line.discount and 'text-danger' or '') + ' text-right'"/>
                                        </td>
                                        <td class="text-right" groups="sale.group_show_price_subtotal">
                                            <div t-field="line.price_total" t-att-data-product-id="line.product_id.id">
                                                <t t-esc="(line.product_uom_qty*line.price_unit)"
                                                   t-options='{"widget": "monetary", "display_currency": quotation.pricelist_id.currency_id}'/>
                                            </div>
                                        </td>
                                    </tr>
                                </t>
                            </t>
                            <tr>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td class="text-right">
                                    <strong>Total:</strong>
                                </td>
                                <td class="text-right">
                                    <strong data-id="total_amount" t-field="quotation.amount_total"
                                            t-options='{"widget": "monetary","display_currency": quotation.pricelist_id.currency_id}'/>
                                </td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
            </section>
        </template>

        <template id="pricing_inherit" inherit_id="sale.sale_order_portal_content" name="prioritization price">
          <xpath expr="//section[@id='details']" position="replace">
             <section id="details" style="page-break-inside: auto; position:relative;" class="mt32">

                     <style type="text/css">
                        .update-qty{position: absolute;top: 0;right: 0;}
                        .click-here{position: relative; top: 9px;}
                        .btn-update{
                        margin-left: 10px;}

                        @media (min-width: 768px) and (max-width: 1024px) {

                        h1
                        {
                        font-size:28px;

                        }
                        .update-qty {
                        position: absolute;
                        top: -10px;
                        right: 0;
                        }
                        .btn-update{
                        margin-left: 10px;}
                        }

                        @media(max-width: 767px) {
                        .click-here {
                        position: absolute;
                        top: 0px;
                        right: 140px;
                        }
                        .action-btn{margin: 10px 50px auto;}
                        .txt-cen{text-align:center;}
                        h1
                        {
                        font-size:30px;
                        line-height: 1.5;
                        }
                        .update-qty{position: relative !important;top: 0;right: 0;}
                        address{    word-break: break-all;}
                        .btn-update{    float: right;
                        margin-top: -15px;}
                        }
                        @media(max-width: 375px) {
                        h1
                        {
                        font-size:24px;
                        line-height: 1.5;
                        }
                        }

                    </style>
                    <div>
                        <h1 class="page-header" style="padding-top: 0px">Pricing</h1>
                        <h5 class="update-qty" t-if="sale_order.state in ['sent']"><b>Click here to update quantity </b><a class="btn btn-info btn-update" t-att-href="'/my/orders/edit/%s' % (sale_order.id)">
                            <b><u>Update Quantity</u></b>
                            </a>
                        </h5>
                    </div>



                <t t-set="display_discount" t-value="True in [line.discount > 0 for line in sale_order.order_line]"/>

                  <div class="table-responsive">

                <table class="table table-sm" id="sales_order_table">
                    <thead class="bg-100">
                        <tr>
                            <!-- TODO: remove in master -->
                            <t t-set="colspan" t-value="6"/>
                            <th class="text-left">Products</th>
                             <th><span t-if="any([line.req_no for line in sale_order.order_line])">Requisition No</span></th>
                            <th class="text-right">Quantity</th>
                            <th t-attf-class="text-right {{ 'd-none d-sm-table-cell' if report_type == 'html' else '' }}">Unit Price</th>
                            <th t-if="display_discount" t-attf-class="text-right {{ 'd-none d-sm-table-cell' if report_type == 'html' else '' }}">
                                <span>Discount</span>
                                <!-- TODO: remove in master -->
                                <t t-set="colspan" t-value="colspan+1"/>
                            </th>
                            <th t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">Taxes</th>
                            <th class="text-right" >
                                <span groups="account.group_show_line_subtotals_tax_excluded">Amount</span>
                                <span groups="account.group_show_line_subtotals_tax_included">Total Price</span>
                            </th>
                        </tr>
                    </thead>
                    <tbody class="sale_tbody">

                        <t t-set="current_subtotal" t-value="0"/>

                        <t t-foreach="sale_order.order_line" t-as="line">

                            <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>
                            <t t-set="current_subtotal" t-value="current_subtotal + line.price_total" groups="account.group_show_line_subtotals_tax_included"/>

                            <tr t-att-class="'bg-200 font-weight-bold o_line_section' if line.display_type == 'line_section' else 'font-italic o_line_note' if line.display_type == 'line_note' else ''">
                                <t t-if="not line.display_type">
                                    <td id="product_name"><span t-field="line.name"/> </td>
                                  <td>
                                      <span t-if="line.req_no" t-field="line.req_no"/>
                                  </td>
                                    <td class="text-right">
                                        <div id="quote_qty">
                                            <span t-field="line.product_uom_qty"/>
                                            <span t-field="line.product_uom" groups="uom.group_uom"/>
                                        </div>
                                    </td>
                                    <td t-attf-class="text-right {{ 'd-none d-sm-table-cell' if report_type == 'html' else '' }}">
                                        <div
                                            t-if="line.discount &gt;= 0"
                                            t-field="line.price_unit"
                                            t-att-style="line.discount and 'text-decoration: line-through' or None"
                                            t-att-class="(line.discount and 'text-danger' or '') + ' text-right'"
                                        />
                                        <div t-if="line.discount">
                                            <t t-esc="(1-line.discount / 100.0) * line.price_unit" t-options='{"widget": "float", "decimal_precision": "Product Price"}'/>
                                        </div>
                                    </td>
                                    <td t-if="display_discount" t-attf-class="text-right {{ 'd-none d-sm-table-cell' if report_type == 'html' else '' }}">
                                        <strong t-if="line.discount &gt; 0" class="text-info">
                                            <t t-esc="((line.discount % 1) and '%s' or '%d') % line.discount"/>% discount
                                        </strong>
                                    </td>
                                    <td t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                                        <span t-esc="', '.join(map(lambda x: (x.description or x.name), line.tax_id))"/>
                                    </td>
                                    <td class="text-right">
                                        <span class="oe_order_line_price_subtotal" t-field="line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>
                                        <span class="oe_order_line_price_total" t-field="line.price_total" groups="account.group_show_line_subtotals_tax_included"/>
                                    </td>
                                </t>
                                <t t-if="line.display_type == 'line_section'">
                                    <td colspan="99">
                                        <span t-field="line.name"/>
                                    </td>
                                    <t t-set="current_section" t-value="line"/>
                                    <t t-set="current_subtotal" t-value="0"/>
                                </t>
                                <t t-if="line.display_type == 'line_note'">
                                    <td colspan="99">
                                        <span t-field="line.name"/>
                                    </td>
                                </t>
                            </tr>

                            <t t-if="current_section and (line_last or sale_order.order_line[line_index+1].display_type == 'line_section')">
                                <tr class="is-subtotal text-right">
                                    <td colspan="99">
                                        <strong class="mr16">Subtotal</strong>
                                        <span
                                            t-esc="current_subtotal"
                                            t-options='{"widget": "monetary", "display_currency": sale_order.pricelist_id.currency_id}'
                                        />
                                    </td>
                                </tr>
                            </t>
                        </t>
                    </tbody>
                </table>
                  </div>

                <div id="total" class="row" name="total" style="page-break-inside: avoid;">
                    <div t-attf-class="#{'col-4' if report_type != 'html' else 'col-sm-7 col-md-5'} ml-auto">
                        <table class="table table-sm">
                            <tr class="border-black" style="border-bottom:1px solid #dddddd;">
                                <td><strong>Subtotal</strong></td>
                                <td class="text-right">
                                    <span
                                        data-id="total_untaxed"
                                        t-field="sale_order.amount_untaxed"
                                        t-options='{"widget": "monetary","display_currency": sale_order.pricelist_id.currency_id}'
                                    />
                                </td>
                            </tr>
                            <t t-foreach="sale_order.amount_by_group" t-as="amount_by_group">
                                <tr style="border-bottom:1px solid #dddddd;">
                                    <t t-if="amount_by_group[3] == 1 and sale_order.amount_untaxed == amount_by_group[2]">
                                        <td>
                                            <span t-esc="amount_by_group[0]"/>
                                            <span>&amp;nbsp;<span>on</span>&amp;nbsp;<t t-esc="amount_by_group[2]" t-options='{"widget": "monetary", "display_currency": sale_order.pricelist_id.currency_id}'/></span>
                                        </td>
                                        <td class="text-right">
                                            <span t-esc="amount_by_group[1]"
                                                t-options='{"widget": "monetary", "display_currency": sale_order.pricelist_id.currency_id}'/>
                                        </td>
                                    </t>
                                    <t t-else ="">
                                        <td>
                                            <span t-esc="amount_by_group[0]"/>
                                        </td>
                                        <td class="text-right">
                                            <span t-esc="amount_by_group[1]"
                                                t-options='{"widget": "monetary", "display_currency": sale_order.pricelist_id.currency_id}'/>
                                        </td>
                                    </t>
                                </tr>
                            </t>
                            <tr class="border-black">
                                <td><strong>Total</strong></td>
                                <td class="text-right">
                                    <span data-id="total_amount" t-field="sale_order.amount_total" t-options='{"widget": "monetary", "display_currency": sale_order.pricelist_id.currency_id}'/>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </section>
          </xpath>
        </template>

        <template id="engine_pricing" name="Price">
            <section id="quote" class="engine">
                <h1 class="page-header">Prioritization Pricing</h1>
<!--                <t t-foreach="quotation.order_lines_layouted()" t-as="page">-->
                    <table class="table wq-table">
                        <thead>
                            <tr>
                                <!--<th class="text-center td-qty">Req no</th>-->
                                <th>Products</th>
                                <th>Quantity</th>
                                <th>
                                    <span t-if="any([line.tax_id for line in quotation.order_line])">Taxes</span>
                                </th>
                                <th>
                                    <span t-if="True in [line.discount > 0 for line in quotation.order_line]">Discount
                                    </span>
                                </th>
                                <th class="text-right">Unit Price</th>
                                <th class="text-right" groups="sale.group_show_price_subtotal">Amount</th>
                                <th class="text-right price_tax_included" groups="sale.group_show_price_total">Total
                                    Price
                                </th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-foreach="page" t-as="layout_category">

                                <t t-if="layout_category_size > 1 or page_size > 1" groups="sale.group_sale_layout">
                                    <tr class="active">
                                        <td colspan="7" style="font-weight: bold; border-bottom: 1px solid black;">&amp;bull;
                                            <t t-esc="layout_category['name']"/>
                                        </td>
                                    </tr>
                                </t>
                                <!-- Lines associated -->
                                <t t-foreach="layout_category['lines']" t-as="line">
                                    <tr>
                                        <!-- <td class="text-center" name="Req no">
                                            <div t-field="line.req_no"/>
                                        </td>-->
                                        <td>
                                            <span t-field="line.name"/>
                                        </td>
                                        <td class="text-center td-qty">
                                            <div class="css_quantity input-group oe_website_spinner">
                                                <a t-attf-href="#"
                                                   class="mb8 input-group-addon js_add_cart_json hidden-xs">
                                                    <i class="fa fa-minus"></i>
                                                </a>
                                                <input type="text" class="js_quantity form-control quantity"
                                                       t-att-data-quote-id="quotation.id" t-att-data-line-id="line.id"
                                                       t-att-data-product-id="line.product_id.id"
                                                       t-att-value="line.product_uom_qty"/>
                                                <a t-attf-href="#"
                                                   class="mb8 input-group-addon float_left js_add_cart_json hidden-xs">
                                                    <i class="fa fa-plus"></i>
                                                </a>
                                            </div>
                                        </td>
                                        <td>
                                            <div t-foreach="line.tax_id" t-as="tax">
                                                <t t-esc="tax.name"/>
                                            </div>
                                        </td>
                                        <td>
                                            <strong t-if="line.discount" class="text-info">
                                                <t t-esc="((line.discount % 1) and '%s' or '%d') % line.discount"/>%
                                                discount
                                            </strong>
                                        </td>

                                        <td class="text-right">
                                            <div t-field="line.price_unit"
                                                 t-options='{"widget": "monetary", "display_currency": quotation.pricelist_id.currency_id}'
                                                 t-att-style="line.discount and 'text-decoration: line-through' or None"
                                                 t-att-class="(line.discount and 'text-danger' or '') + ' text-right'"/>
                                            <div t-if="line.discount">
                                                <t t-esc="(1-line.discount / 100.0) * line.price_unit"
                                                   t-options='{"widget": "monetary", "display_currency": quotation.pricelist_id.currency_id}'/>
                                            </div>
                                        </td>
                                        <td class="text-right" groups="sale.group_show_price_subtotal">
                                            <div t-field="line.price_total" t-att-data-product-id="line.product_id.id">
                                                <t t-esc="(line.product_uom_qty*line.price_unit)"
                                                   t-options='{"widget": "monetary", "display_currency": quotation.pricelist_id.currency_id}'/>
                                            </div>
                                         </td>

                                        <td class="text-center">
                                            <a t-attf-href="./update_line/#{ line.id }/?order_id=#{ quotation.id }&amp;unlink=True&amp;token=#{ quotation.access_token }"
                                               class="mb8 js_update_line_json hidden-print" t-if="line.option_line_id">
                                                <large><span class="fa fa-trash-o"></span></large>
                                            </a>
                                        </td>
                                    </tr>
                                </t>

                                <t t-if="(layout_category_size > 1  or page_size > 1) and layout_category['subtotal']"
                                   groups="sale.group_sale_layout">
                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td class="text-right" style="padding-bottom: 32px">
                                            <strong>Subtotal:</strong>
                                        </td>
                                        <td class="text-right" style="padding-bottom: 32px">
                                            <t t-set="subtotal"
                                               t-value="sum(line.price_subtotal for line in layout_category['lines'])"/>
                                            <strong data-id="total_amount" t-esc="subtotal"
                                                    t-options="{'widget': 'monetary', 'display_currency': quotation.pricelist_id.currency_id}"/>
                                        </td>
                                        <td></td>
                                    </tr>
                                </t>
                            </t>
                            <t t-if="page_index and page_index == page_size - 1">
                                <t t-if="any([line.tax_id for line in quotation.order_line])">
                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td class="text-right">
                                            <strong>Subtotal:</strong>
                                        </td>
                                        <td class="text-right">
                                            <strong data-id="total_amount" t-field="quotation.amount_untaxed"
                                                    t-options='{"widget": "monetary","display_currency": quotation.pricelist_id.currency_id}'/>
                                        </td>
                                        <td></td>
                                    </tr>

                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td class="text-right">Taxes:</td>
                                        <td class="text-right">
                                            <span data-id="total_amount" t-field="quotation.amount_tax"
                                                  t-options='{"widget": "monetary","display_currency": quotation.pricelist_id.currency_id}'/>
                                        </td>
                                        <td></td>
                                    </tr>
                                </t>
                                <tr>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td class="text-right">
                                        <strong>Total:</strong>
                                    </td>
                                    <td class="text-right">
                                        <strong data-id="total_amount" t-field="quotation.amount_total"
                                                t-options='{"widget": "monetary","display_currency": quotation.pricelist_id.currency_id}'/>
                                    </td>
                                    <td></td>
                                </tr>
                            </t>
                        </tbody>
                    </table>

                    <t t-if="page_index &lt; page_size - 1" groups="sale.group_sale_layout">
                        <p style="page-break-before:always;"></p>
                    </t>

<!--                </t>-->
            </section>
            <section id="terms" class="container" t-if="quotation.note">
                <h2 class="page-header">Terms &amp; Conditions</h2>
                <p t-field="quotation.note"/>
            </section>
        </template>

        <template id="portal_order_page_ex" name="Sales Order">
            <t t-call="portal.portal_layout">
                <t t-set="invoices" t-value="[i for i in sale_order.invoice_ids if i.state not in ['draft', 'cancel']]"/>
                <t t-set="invoices_amount" t-value="sum(i.amount_total for i in invoices)"/>
                <div id="optional_placeholder"></div>
                <div class="container">
                    <style type="text/css">
                        input.quantity {
                        padding: 14px 8px;
                        width: 53px !important;
                        display: inline;
                        margin-bottom: 1em;
                        }
                        @media (min-width: 768px) and (max-width: 1024px) {}
                        @media(max-width: 767px){.action-btn{    margin: 10px auto;
                        display: block;
                       }input.quantity {
                        width: 50px !important;}
                        @media(max-width: 375px){.action-btn {    margin: 10px auto;
                        display: block;
                        text-align: center; }}

                    </style>
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <div class="row">



                                 <div class="col-md-6 col-xs-12 col-sm-6">





                                    <div id="introduction">
                     <h2 class="my-0">
                         <span t-field="sale_order.type_name"></span>
                         <em t-esc="sale_order.name"/>
                         <span class="txt-cen">
                             <t t-if="sale_order.state == 'cancel'">
                                 <span style="font-size:1rem;vertical-align: top;" class="label label-default">
                                     <i class="fa fa-fw fa-remove"/>
                                     Cancelled
                                 </span>
                             </t>
                             <t t-if="sale_order.state == 'done'">
                                 <span style="font-size:1rem;vertical-align: top;" class="label label-success">
                                     <i class="fa fa-fw fa-check"/>
                                     Done
                                 </span>
                             </t>
                         </span>
                     </h2>
                </div>
                                </div>






                               <div class="text-right col-md-6 col-sm-6 col-xs-12 hidden-print" id="o_portal_order_actions">
                                 <div class="action-btn">

                                    <t t-if="sale_order.amount_total != 0">
                                      <t t-set="report_url" t-value="sale_order.get_portal_url(report_type='pdf', download=True)"/>
                                      <a t-att-href="report_url">
                                        <i class="fa fa-download mr-1" role="img" aria-label="Download" title="Download"/> Download
                                      </a>
                                    </t>

                                    <a class="btn btn-danger ml8 " data-toggle="modal" data-target="#decline">
                                        Reject
                                    </a>
                                    <t t-if="sale_order.amount_total != 0">
                                        <a class="btn btn-success ml8 " data-toggle="modal" data-target="#accept">
                                            Accept
                                        </a>
                                    </t>
                                 </div>
                               </div>
                            </div>
                        </div>
                        <div class="panel-body engine">
                            <t t-if="error or warning" t-call="sale.portal_order_error"/>
                            <t t-if="success and (not error and not warning)" t-call="sale.portal_order_success"/>
                            <div class="mb8">
                                <strong>Date:</strong>
                                <span t-field="sale_order.create_date" t-options='{"widget": "date"}'/>
                            </div>
                            <div class="mb8" t-if="sale_order.validity_date">
                                <strong>Expiration Date:</strong>
                                <span t-field="sale_order.validity_date" t-options='{"widget": "date"}'/>
                            </div>

                            <div class='row'>
                                <div class="col-md-6">
                                    <div>
                                        <strong>Invoicing Address</strong>
                                    </div>
                                    <div>
                                        <address t-field="sale_order.partner_invoice_id"
                                                 t-options='{"widget": "contact", "fields": ["address", "name"], "no_marker": True}'/>
                                    </div>
                                    <t t-if="invoices">
                                        <div>
                                            <strong>Invoices</strong>
                                        </div>
                                        <div>
                                            <t t-foreach="invoices" t-as="i">
                                                <t t-set="report_url"
                                                   t-value="'/my/invoices/pdf/%s?%s' % (i.id, 'access_token=%s' % i.access_token if access_token else '')"/>
                                                <div>
                                                    <a t-att-href="report_url">
                                                        <span class="fa fa-download"/>
                                                    </a>
                                                    <a t-att-href="report_url">
                                                        <span t-esc="i.number"/>
                                                    </a>
                                                    <span class="text-muted" t-field="i.date_invoice"/>
                                                    <t t-if="i.state == 'paid'">
                                                        <span class="label label-success orders_label_text_align">
                                                            <i class="fa fa-fw fa-check"/>
                                                            Paid
                                                        </span>
                                                    </t>
                                                    <t t-if="i.state != 'paid'">
                                                        <span class="label label-info orders_label_text_align">
                                                            <i class="fa fa-fw fa-clock-o"/>
                                                            Waiting
                                                        </span>
                                                    </t>
                                                </div>
                                            </t>
                                        </div>
                                    </t>
                                </div>
                                <div id="shipping_address" class="col-md-6"
                                     groups="sale.group_delivery_invoice_address">
                                    <div>
                                        <strong>Shipping Address</strong>
                                    </div>
                                    <div>
                                        <address t-field="sale_order.partner_shipping_id"
                                                 t-options='{"widget": "contact", "fields": ["address", "name"], "no_marker": True}'/>
                                    </div>
                                </div>
                            </div>

                          <div class="row">
                                <div class="col-md-12 table-responsive">
                                <table class="table">
                                    <tr>
                                                <td style="width:10%"></td>
                                                <td style="width:50%"><strong>Product</strong> </td>
                                                 <td style="width:15%"><strong>Unit Price</strong> </td>
                                                 <td style="width:10%"><strong>Quantity</strong></td>
                                                 <td style="width:15%"><strong>Subtotal</strong></td>


                                    </tr>
                                 <t t-foreach="sale_order.order_line" t-as="ol">
                                 <tr>

                                        <t t-if="ol.product_uom_qty != 0">
                                        <td>
                                        <span t-field="ol.product_image"
                                              t-options="{'widget': 'image', 'class': 'img-rounded', 'style':'width: 48px;height:48px'}"/>
                                              </td><td>
                                        <span t-esc="ol.product_id.name"/>
                                        </td><td>
                                        <span t-field="ol.price_unit"
                                              t-options='{"widget": "monetary", "display_currency": sale_order.pricelist_id.currency_id}'/>
                                              </td>
                                    <t t-if="ol._name == 'sale.order.line'">
                                            <t t-if="sale_order.state == 'sent'">
                                            <td>
                                                    <div class="css_quantity input-group oe_website_spinner">
                                                    <a title="Decrease Quality" t-attf-href="#"
                                                       class="mb8 input-group-addon js_add_cart_json ">
                                                        <i class="fa fa-minus"></i>
                                                    </a>
                                                    <input type="text" class="js_quantity form-control quantity"
                                                           t-att-data-quote-id="ol.order_id.id"
                                                           t-att-data-line-id="ol.id"
                                                           t-att-data-product-id="ol.product_id.id"
                                                           t-att-value="ol.product_uom_qty" readonly="True" style="
                                                             background-color: white;"/>
                                                    <lable style="cursor: not-allowed;"
                                                       class="mb8 input-group-addon float_left js_add_cart_json">
                                                        <i class="fa fa-plus" style="readonly:true;color: #cacaca;"></i>
                                                    </lable>
                                                </div>
                                                    </td>
                                            </t>
                                            <t t-if="sale_order.state != 'sent'">
                                            <td>
                                                <span t-esc="ol.product_uom_qty"/>
                                                </td>
                                            </t>
                                    </t>
                                    <td>
                                        <span t-field="ol.price_subtotal"
                                              t-options='{"widget": "monetary", "display_currency": sale_order.pricelist_id.currency_id}'/>
                                        <input type="hidden" class="change js_quantity form-control quantity"
                                                           t-att-data-quote-id="ol.order_id.id"
                                                           t-att-data-line-id="ol.id"
                                                           t-att-data-product-id="ol.product_id.id"
                                                           t-att-value="ol.product_uom_qty"/>
                                        <span>  </span>
                                        <a href='#' title="Remove" class='js_delete_product no-decoration'> <large>  <i class='fa fa-trash-o' style="margin-left: 5px;font-size: 16px;"></i></large></a>
                                    </td>
                                </t>
                                 </tr>
                            </t>

                      </table>
                          </div>
                        </div>
                            <hr/>

                            <div class="row">
                                <div class="col-md-6">
                                    <div>
                                        <div>
                                            <strong>Contact</strong>
                                        </div>
                                        <div t-field="sale_order.user_id.partner_id"
                                             t-options='{"widget": "contact", "fields": ["email", "phone"]}'/>
                                        <br/>
                                    </div>
                                    <div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="row mb4">
                                        <div class="col-md-9 col-xs-8 text-right">
                                            <strong>Subtotal</strong>
                                        </div>
                                        <div class="col-md-3 col-xs-4 text-right">
                                            <strong>
                                                <span t-field="sale_order.amount_untaxed"
                                                      t-options='{"widget": "monetary", "display_currency": sale_order.pricelist_id.currency_id}'/>
                                            </strong>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-9 col-xs-8 text-right">
                                            <strong>Total</strong>
                                        </div>
                                        <div class="col-md-3 col-xs-4 text-right">
                                            <strong>
                                                <span t-field="sale_order.amount_total"
                                                      t-options='{"widget": "monetary", "display_currency": sale_order.pricelist_id.currency_id}'/>
                                            </strong>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel-heading  text-right hidden-print mt16 mb16" id="portal_sign" style="margin-bottom: 0px !important">
                            <a class="btn btn-info" data-toggle="modal"  onclick="history.back()" data-target="#discussion">
                                <i class="fa fa-comments-o"></i>
                                Feedback
                            </a>
                            <a class="btn btn-danger" data-toggle="modal" data-target="#decline">
                                Reject
                            </a>
                             <t t-if="sale_order.amount_total != 0">
                            <a class="btn btn-success" data-toggle="modal" data-target="#accept">
                                Accept
                            </a>
                             </t>
                        </div>
                        <div class="modal" id="accept" role="dialog" aria-hidden="true">
                            <div class="modal-dialog">
			                    <form id="accept" method="POST" t-attf-action="/my/orders/#{sale_order.id}/accepts?access_token=#{sale_order.access_token}" class="modal-content">
                                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>

                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                            &amp;times;
                                        </button>
                                        <h4 class="modal-title">Accept Order</h4>
                                    </div>
                                     <t t-if="sale_order.partner_id.allow_purchase">
                                            <div class="modal-body">
                                               Purchase Order #:
                                               <input type="text" class="form-control"
                                                               name="client_order_ref"
                                                               t-att-value="client_order_ref"/>
                                            </div>
                                      </t>
                                    <div class="modal-body">
                                        <p>
                                           Your Order will be shipped Ground unless otherwise stated. If expedited shipping is needed, Please indicate below:
                                            (First Overnight by 8:30AM / Priority Overnight by 10:30AM /2nd day AM by 10:30 AM /2nd Day /3rd Day)
                                        </p>
                                        <textarea rows="4" name="accept_message" placeholder="Your feedback....."
                                                  class="form-control"/>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="submit" t-object="order" class="btn btn-primary">Accept</button>
                                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <div class="modal" id="decline" role="dialog" aria-hidden="true">
                            <div class="modal-dialog">
                                <form id="decline" method="POST" t-attf-action="/my/orders/#{sale_order.id}/declines?access_token=#{sale_order.access_token}" class="modal-content">
                                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                            &amp;times;
                                        </button>
                                        <h4 class="modal-title">Reject</h4>
                                    </div>
                                    <div class="modal-body">
                                        <p>
                                            Tell us why you are refusing this quotation, this will help us improve our
                                            services.
                                        </p>
                                        <textarea rows="4" name="decline_message" placeholder="Your feedback....."
                                                  class="form-control"/>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="submit" t-object="order" class="btn btn-primary btn btn-danger">Reject</button>
                                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="oe_structure mb32"/>
            </t>
        </template>

        <template id="portal_my_home_vendor_offer" name="Portal My Home : vendor offer entry"
                  inherit_id="portal.portal_my_home" priority="25">
            <xpath expr="//div[hasclass('o_portal_docs')]" position="inside">
                <li t-if="vendor_count" class="list-group-item">
                    <span class="badge" t-esc="vendor_count"/>
                    <a href="/my/vendor">Vendor Offer</a>
                </li>
            </xpath>
        </template>

        <template id="portal_my_vendor_offers" name="Portal: My Vendor Offers">
            <t t-call="portal.portal_layout">
                <h3>Vendor Offers
                    <t t-call="portal.portal_searchbar"/>
                </h3>
                <div t-if="orders" class="panel panel-default">
                    <div class="table-responsive">
                        <table class="table table-hover o_portal_my_doc_table">
                            <thead>
                                <tr class="active">
                                    <th>Vendor Offerd #</th>
                                    <th>Order Date</th>
                                    <th></th>
                                    <th>Total</th>
                                </tr>
                            </thead>
                            <t t-foreach="orders" t-as="order">
                                <tr>
                                    <td>
                                        <a t-attf-href="/my/vendor/#{order.id}?#{keep_query()}">
                                            <t t-esc="order.name"/>
                                        </a>
                                    </td>
                                    <td>
                                        <span t-field="order.date_order" t-options='{"widget": "date"}'/>
                                    </td>
                                    <td>
                                        <t t-if="order.state == 'cancel'">
                                            <span class="label label-default">
                                                <i class="fa fa-fw fa-remove"/>
                                                Cancelled
                                            </span>
                                        </t>
                                    </td>
                                    <td>
                                        <span t-field="order.amount_total"
                                              t-options='{"widget": "monetary", "display_currency": order.currency_id}'/>
                                    </td>
                                </tr>
                            </t>
                        </table>
                    </div>
                    <div t-if="pager" class="o_portal_pager text-center">
                        <t t-call="portal.pager"/>
                    </div>
                </div>
            </t>
        </template>

        <template id="portal_my_vendor_offer" name="Portal: My Vendor Offer">
            <t t-call="portal.portal_layout">
                <t t-set="vendor_offer" t-value="order"/>
                <div id="optional_placeholder"></div>
                <div class="container">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <div class="row">
                                <div class="col-md-12">
                                    <h4>
                                        <t t-call='portal.record_pager'/>
                                        Vendor Offer
                                        <span t-esc="order.name"/>
                                    </h4>
                                </div>
                            </div>
                        </div>
                        <div class="panel-body">
                            <div class="mb8">
                                <strong>Date:</strong>
                                <span t-field="order.date_order" t-options='{"widget": "date"}'/>
                            </div>
                            <div class="row">
                                <div class="col-md-5">
                                    <strong>Product</strong>
                                </div>
                                 <div class="col-md-1">
                                    <strong>SKU</strong>
                                </div>
                                <div class="col-md-2 text-right">
                                    <strong>Offer Price</strong>
                                </div>
                                <div class="col-md-2 text-right">
                                    <strong>Quantity</strong>
                                </div>
                                <div class="col-md-2 text-right">
                                    <strong>Subtotal</strong>
                                </div>
                            </div>
                            <t t-foreach="order.order_line" t-as="ol">
                                <div class="row purchases_vertical_align">
                                    <div class="col-md-1 text-center">
                                        <img t-att-src="'/web/image/purchase.order.line/%s/product_image/48x48' % ol.id"/>
                                    </div>
                                    <div id='product_name' class="col-md-4">
                                        <span t-esc="ol.product_id.name"/>
                                    </div>
                                    <div class="col-md-1">
                                        <span t-esc="ol.sku_code"/>
                                    </div>
                                    <div class="col-md-2 text-right">
                                        <span t-field="ol.product_offer_price"
                                              t-options='{"widget": "monetary", "display_currency": order.currency_id}'/>
                                    </div>
                                    <div class="col-md-2 text-right">
                                        <span t-esc="ol.product_qty"/>
                                    </div>
                                    <div class="col-md-2 text-right">
                                        <span t-field="ol.price_subtotal"
                                              t-options='{"widget": "monetary", "display_currency": order.currency_id}'/>
                                    </div>
                                </div>
                            </t>

                            <hr/>

                            <div class="row">
                                <div class="col-md-12 text-right">
                                    <div class="row">
                                        <div class="col-md-10 text-right">
                                            Untaxed Amount:
                                        </div>
                                        <div class="col-md-2 text-right">
                                            <span t-field="order.amount_untaxed"
                                                  t-options='{"widget": "monetary", "display_currency": order.currency_id}'/>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-10 text-right">
                                            Taxes:
                                        </div>
                                        <div class="col-md-2 text-right">
                                            <span t-field="order.amount_tax"
                                                  t-options='{"widget": "monetary", "display_currency": order.currency_id}'/>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-10 text-right">
                                            <strong>Total:</strong>
                                        </div>
                                        <div class="col-md-2 text-right">
                                            <strong>
                                                <span t-field="order.amount_total"
                                                      t-options='{"widget": "monetary", "display_currency": order.currency_id}'/>
                                            </strong>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div t-if="order.state != 'cancel'" class="text-center hidden-print mt16 mb16"
                         id="quotation_toolbar">
                        <a class="btn btn-success" data-target="#modalaccept" data-toggle="modal">
                            <i class="fa fa-check"></i>
                            Accept
                        </a>
                        <a class="btn btn-danger" data-target="#modaldecline" data-toggle="modal">

                            Reject
                        </a>
                    </div>
                    <div class="modal fade" id="modalaccept" role="dialog" aria-hidden="true">
                        <div class="modal-dialog">
                            <form id="accept" method="POST" t-att-data-order-id="order.id"
                                  class="js_accept_json modal-content js_website_submit_form">
                                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&amp;times;</button>
                                    <h4 class="modal-title">Validate Order</h4>
                                </div>
                                <div class="modal-body" id="sign-dialog">

                                    <t t-call="portal.portal_signature">
                                        <t t-set="object" t-value="order"/>
                                        <t t-set="partner_name" t-value="order.partner_id.name"/>
                                        <t t-set="callUrl" t-value="'/vendor_offer/accept/'"/>
                                        <t t-set="order_id" t-value="order.id"/>
                                    </t>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="modal fade" id="modaldecline" role="dialog" aria-hidden="true">
                        <div class="modal-dialog">
                            <form id="reject" method="POST" t-att-data-order-id="order.id"
                                  class="js_reject_json modal-content js_website_submit_form">
                                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&amp;times;</button>
                                    <h4 class="modal-title">Reject Order</h4>
                                </div>
                                <div class="modal-body" id="sign-dialog">

                                    <t t-call="portal.portal_signature">
                                        <t t-set="object" t-value="order"/>
                                        <t t-set="partner_name" t-value="order.partner_id.name"/>
                                        <t t-set="callUrl" t-value="'/vendor_offer/reject/'"/>
                                        <t t-set="order_id" t-value="order.id"/>
                                    </t>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </t>
        </template>

        <template id="portal_my_home_menu_vendor" name="Portal layout : vendor menu entries"
                  inherit_id="portal.portal_layout" priority="20">
            <xpath expr="//div[hasclass('o_portal_my_details')]" position="inside">
                <li t-if="vendor_offer and vendor_offer.state in ('ven_sent', 'cancel')">
                    <a t-if="vendor_offer" t-attf-href="/my/vendor?{{ keep_query() }}">Vendor Offer</a>
                    <t t-else="">Vendor Offer</t>
                </li>
            </xpath>
        </template>
    </data>
</odoo>